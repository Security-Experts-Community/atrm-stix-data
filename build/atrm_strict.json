{
    "type": "bundle",
    "id": "bundle--084f094d-298a-49fc-807d-dd69d2618521",
    "objects": [
        {
            "type": "x-mitre-collection",
            "spec_version": "2.1",
            "id": "x-mitre-collection--bf1027b3-fe3a-4eac-bdd5-a1c48c4cb89e",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.919623Z",
            "modified": "2024-03-25T08:50:27.919623Z",
            "name": "Azure Threat Research Matrix",
            "description": "The purpose of the Azure Threat Research Matrix (ATRM) is to educate readers on the potential of Azure-based tactics, techniques, and procedures (TTPs). It is not to teach how to weaponize or specifically abuse them. For this reason, some specific commands will be obfuscated or parts will be omitted to prevent abuse.",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_contents": [
                {
                    "object_ref": "x-mitre-tactic--72987607-3031-4e46-8352-255208c061c7",
                    "object_modified": "2022-07-29T18:07:09.000Z"
                },
                {
                    "object_ref": "x-mitre-tactic--5664197e-8e77-4145-b848-9dd68227eca1",
                    "object_modified": "2024-02-04T23:05:59.000Z"
                },
                {
                    "object_ref": "x-mitre-tactic--2b04afaa-b289-49aa-9a83-44978deb984c",
                    "object_modified": "2022-07-29T18:07:09.000Z"
                },
                {
                    "object_ref": "x-mitre-tactic--f2cee537-023e-433c-83b3-54128e17dc0e",
                    "object_modified": "2024-02-04T23:05:59.000Z"
                },
                {
                    "object_ref": "x-mitre-tactic--6caedcbe-eb96-4ba7-ba7e-3007688f12d1",
                    "object_modified": "2024-02-04T23:05:59.000Z"
                },
                {
                    "object_ref": "x-mitre-tactic--17719260-6270-4060-8d07-369d622a73d4",
                    "object_modified": "2024-02-04T23:05:59.000Z"
                },
                {
                    "object_ref": "x-mitre-tactic--170069f3-584a-4e42-b70b-70e18bcfab2f",
                    "object_modified": "2024-02-04T23:05:59.000Z"
                },
                {
                    "object_ref": "attack-pattern--268b476a-8eea-4961-8215-c7557693e226",
                    "object_modified": "2022-07-29T18:07:09.000Z"
                },
                {
                    "object_ref": "attack-pattern--664d48ad-7883-4d11-9e11-e8ae3b74e429",
                    "object_modified": "2022-07-29T18:07:09.000Z"
                },
                {
                    "object_ref": "attack-pattern--9b9d58ea-b451-4964-ac4b-1e0082bd4f9d",
                    "object_modified": "2022-07-29T18:07:09.000Z"
                },
                {
                    "object_ref": "attack-pattern--11da0019-1a48-47df-a428-1f313caa4c47",
                    "object_modified": "2022-07-29T18:07:09.000Z"
                },
                {
                    "object_ref": "attack-pattern--32e95d98-f487-4395-99e1-3433e5baea8d",
                    "object_modified": "2022-07-29T18:07:09.000Z"
                },
                {
                    "object_ref": "attack-pattern--fdf40a9b-c87a-43ab-b669-c22e6d53c2b8",
                    "object_modified": "2022-07-29T18:07:09.000Z"
                },
                {
                    "object_ref": "attack-pattern--ac28b3e1-1bd0-491b-a859-6d0100ead69d",
                    "object_modified": "2024-02-04T23:05:59.000Z"
                },
                {
                    "object_ref": "attack-pattern--5b459d6b-6aac-442d-9d7d-8cf14fb2de3f",
                    "object_modified": "2023-06-12T03:16:53.000Z"
                },
                {
                    "object_ref": "attack-pattern--8d9b6e81-305c-4e62-871a-56ff43be6a8e",
                    "object_modified": "2024-02-04T23:05:59.000Z"
                },
                {
                    "object_ref": "attack-pattern--8964e259-5a76-496f-9187-b7d15c29a074",
                    "object_modified": "2023-06-12T03:16:53.000Z"
                },
                {
                    "object_ref": "attack-pattern--b68df883-87a8-4bc8-a553-16bbff53c72a",
                    "object_modified": "2022-07-29T18:07:09.000Z"
                },
                {
                    "object_ref": "attack-pattern--62686ebd-f6a3-425a-8272-8f79c5d7854d",
                    "object_modified": "2022-07-29T18:07:09.000Z"
                },
                {
                    "object_ref": "attack-pattern--0a1f5825-bdcf-4ac5-a7e7-cfe13d22f934",
                    "object_modified": "2023-06-12T03:27:03.000Z"
                },
                {
                    "object_ref": "attack-pattern--ac7f52b1-1a71-4f4c-9fef-4869861b29e5",
                    "object_modified": "2023-06-12T03:27:03.000Z"
                },
                {
                    "object_ref": "attack-pattern--0b072ae4-5fe4-4f70-8cd9-f1bf6abc8aba",
                    "object_modified": "2022-07-29T18:07:09.000Z"
                },
                {
                    "object_ref": "attack-pattern--845c16b9-fc4e-452b-872e-2d1815d392ad",
                    "object_modified": "2023-06-12T03:27:03.000Z"
                },
                {
                    "object_ref": "attack-pattern--574aa812-8ea4-434b-b51a-fb67a4701c6b",
                    "object_modified": "2023-06-12T03:27:03.000Z"
                },
                {
                    "object_ref": "attack-pattern--29e152af-b515-46c0-8ee5-e4c53286cc4e",
                    "object_modified": "2023-06-12T03:27:03.000Z"
                },
                {
                    "object_ref": "attack-pattern--65591b92-94da-41a4-9409-3f4b30fb37da",
                    "object_modified": "2023-06-20T15:00:42.000Z"
                },
                {
                    "object_ref": "attack-pattern--c979173f-9f72-4a6d-8eb7-c955a688544e",
                    "object_modified": "2022-07-29T18:07:09.000Z"
                },
                {
                    "object_ref": "attack-pattern--4e55dc6c-f0cd-4577-afb3-db973f1cfee4",
                    "object_modified": "2023-06-12T03:33:04.000Z"
                },
                {
                    "object_ref": "attack-pattern--094f30e0-d90c-47ec-949d-097c470183a9",
                    "object_modified": "2023-06-12T03:33:04.000Z"
                },
                {
                    "object_ref": "attack-pattern--3aff39b8-2ccb-488f-8f87-9cb48c4256ca",
                    "object_modified": "2023-06-12T03:16:53.000Z"
                },
                {
                    "object_ref": "attack-pattern--e543b6cd-c1c0-40df-99a5-3ab28690d06b",
                    "object_modified": "2023-06-12T03:27:03.000Z"
                },
                {
                    "object_ref": "attack-pattern--be59a4c2-c00b-49ee-940e-ea26be61bafa",
                    "object_modified": "2023-06-12T03:33:04.000Z"
                },
                {
                    "object_ref": "attack-pattern--8586f122-4c0f-4571-88ac-c7b6cc2593cd",
                    "object_modified": "2024-02-04T22:12:32.000Z"
                },
                {
                    "object_ref": "attack-pattern--eade80d2-e1ce-434f-827a-8324412c4ced",
                    "object_modified": "2023-06-12T03:27:03.000Z"
                },
                {
                    "object_ref": "attack-pattern--7bb9d8a8-3e9a-4551-ad1b-f3f7ee275bb0",
                    "object_modified": "2022-07-29T18:07:09.000Z"
                },
                {
                    "object_ref": "attack-pattern--5f6ea055-96ca-4d3e-ba7a-eb7952a33b1f",
                    "object_modified": "2023-06-12T03:16:53.000Z"
                },
                {
                    "object_ref": "attack-pattern--24b45623-3ddc-496b-bafa-f32127dc83c8",
                    "object_modified": "2023-06-12T03:33:04.000Z"
                },
                {
                    "object_ref": "attack-pattern--5ff11929-204c-4a06-89e7-6c13cd0b8023",
                    "object_modified": "2023-06-12T03:16:53.000Z"
                },
                {
                    "object_ref": "attack-pattern--9bdeb3ed-3192-4c25-b7ee-e0e7b2400545",
                    "object_modified": "2023-06-12T03:16:53.000Z"
                },
                {
                    "object_ref": "attack-pattern--a97fb0c4-2ae4-4f50-b96c-8007f652ffd9",
                    "object_modified": "2023-06-12T03:16:53.000Z"
                },
                {
                    "object_ref": "attack-pattern--5c07480f-949b-4459-aba1-a272193b5b26",
                    "object_modified": "2022-07-29T18:07:09.000Z"
                },
                {
                    "object_ref": "attack-pattern--2c98c491-2985-4991-b9db-a1c1e7615994",
                    "object_modified": "2023-06-12T03:27:03.000Z"
                },
                {
                    "object_ref": "attack-pattern--70f889b3-cd41-4177-8bff-d22691d4602e",
                    "object_modified": "2023-06-12T03:16:53.000Z"
                },
                {
                    "object_ref": "attack-pattern--d9210297-1194-4292-8416-7ab94dcc9a11",
                    "object_modified": "2023-06-12T03:16:53.000Z"
                },
                {
                    "object_ref": "attack-pattern--6155cdf2-448c-4dc9-a679-2b7118182723",
                    "object_modified": "2023-06-12T03:27:03.000Z"
                },
                {
                    "object_ref": "attack-pattern--b22a37d2-1268-4139-b012-ec10fc8ca488",
                    "object_modified": "2024-02-04T23:05:59.000Z"
                },
                {
                    "object_ref": "attack-pattern--777a1101-c222-4156-90a4-e311545db001",
                    "object_modified": "2023-06-12T03:33:04.000Z"
                },
                {
                    "object_ref": "attack-pattern--3830bfda-b828-4504-b0d0-8d3e9f65faf6",
                    "object_modified": "2023-06-12T03:27:03.000Z"
                },
                {
                    "object_ref": "attack-pattern--30e8a996-aaa6-46f7-932c-4eda49090356",
                    "object_modified": "2022-07-29T18:07:09.000Z"
                },
                {
                    "object_ref": "attack-pattern--8ad532cc-30be-44cd-823f-7deaf726c503",
                    "object_modified": "2023-06-12T03:25:08.000Z"
                },
                {
                    "object_ref": "attack-pattern--16c0a7fc-7252-4bf4-8ea6-7a60ea5cb966",
                    "object_modified": "2023-06-12T03:27:03.000Z"
                },
                {
                    "object_ref": "attack-pattern--61edac02-d1fa-44dd-8334-3df64bb65426",
                    "object_modified": "2023-06-12T03:27:03.000Z"
                },
                {
                    "object_ref": "attack-pattern--2b1549dd-a09f-4a9b-88a4-2eff87268528",
                    "object_modified": "2023-06-12T03:27:03.000Z"
                },
                {
                    "object_ref": "attack-pattern--e20e7837-0dd2-45b6-8265-6835e7079ff5",
                    "object_modified": "2023-06-12T03:27:03.000Z"
                },
                {
                    "object_ref": "attack-pattern--b614e8d7-039e-4e99-a1a0-e3ef5ed0ca97",
                    "object_modified": "2022-07-29T18:07:09.000Z"
                },
                {
                    "object_ref": "attack-pattern--0f01367c-ef9c-438a-b096-448148677c72",
                    "object_modified": "2023-06-12T03:27:03.000Z"
                },
                {
                    "object_ref": "attack-pattern--8cb8258c-b751-4b4d-92c2-ae4117ff41af",
                    "object_modified": "2023-06-12T03:27:03.000Z"
                },
                {
                    "object_ref": "attack-pattern--772716f5-4852-475a-a631-ae42348b007f",
                    "object_modified": "2024-02-04T23:05:59.000Z"
                },
                {
                    "object_ref": "attack-pattern--5c447245-3556-4c3d-913b-b7cd74e28039",
                    "object_modified": "2023-06-12T03:27:03.000Z"
                },
                {
                    "object_ref": "attack-pattern--0befda65-df42-4c80-a383-45c5d68ef9f0",
                    "object_modified": "2023-06-12T03:27:03.000Z"
                },
                {
                    "object_ref": "attack-pattern--85398833-61eb-46d4-9c81-69ee89a3d136",
                    "object_modified": "2023-06-12T03:27:03.000Z"
                },
                {
                    "object_ref": "attack-pattern--6c2cf99e-01ee-478b-9aa8-060a8d1f9d52",
                    "object_modified": "2022-07-29T18:07:09.000Z"
                },
                {
                    "object_ref": "attack-pattern--5137e13e-c99c-49cf-ad00-9eb9e3344b61",
                    "object_modified": "2023-06-12T03:27:03.000Z"
                },
                {
                    "object_ref": "attack-pattern--0a5b9484-01d2-45a7-8e2e-11fdd9d52b3a",
                    "object_modified": "2023-06-12T03:16:53.000Z"
                },
                {
                    "object_ref": "attack-pattern--6cc30162-d68d-4bfc-81be-15ad3e5bdae9",
                    "object_modified": "2023-06-12T03:16:53.000Z"
                },
                {
                    "object_ref": "attack-pattern--e0cc35c1-b058-4544-8ee3-129fc24ade4e",
                    "object_modified": "2024-02-04T22:12:32.000Z"
                },
                {
                    "object_ref": "attack-pattern--b7670d70-f1c4-4963-8c51-ecf8d7a099a4",
                    "object_modified": "2022-08-18T19:04:59.000Z"
                },
                {
                    "object_ref": "attack-pattern--cb6ea575-bc20-4261-a36d-614d59735ced",
                    "object_modified": "2023-06-12T03:16:53.000Z"
                },
                {
                    "object_ref": "attack-pattern--630791a3-d60e-4c4b-84a8-d9397166876f",
                    "object_modified": "2023-06-12T03:16:53.000Z"
                },
                {
                    "object_ref": "attack-pattern--1c06e6d6-d8c6-4c57-8d66-a73c6bb62ac2",
                    "object_modified": "2023-06-12T03:27:03.000Z"
                },
                {
                    "object_ref": "attack-pattern--2fb9a8b8-3141-4de8-bff3-ee36d65be398",
                    "object_modified": "2022-07-29T18:07:09.000Z"
                },
                {
                    "object_ref": "attack-pattern--aadb4d17-c65a-428b-beea-911c74a0593b",
                    "object_modified": "2023-06-12T03:33:04.000Z"
                },
                {
                    "object_ref": "attack-pattern--0ce2adf9-4f8c-4aeb-85aa-db0496b8629c",
                    "object_modified": "2023-06-12T03:33:04.000Z"
                },
                {
                    "object_ref": "attack-pattern--ed8c8c59-6a07-4d27-bb0d-e0e3ccf31c33",
                    "object_modified": "2023-06-12T03:27:03.000Z"
                },
                {
                    "object_ref": "attack-pattern--5517ec16-8116-4c7f-95d5-2f3a3be35ee2",
                    "object_modified": "2023-06-12T03:27:03.000Z"
                },
                {
                    "object_ref": "attack-pattern--b0844cbf-878c-4221-a7fc-70c276542fa5",
                    "object_modified": "2023-06-12T03:16:53.000Z"
                },
                {
                    "object_ref": "attack-pattern--09109128-664e-4eb5-b891-41935a01d5cf",
                    "object_modified": "2024-02-04T23:05:59.000Z"
                },
                {
                    "object_ref": "attack-pattern--a6c5dd02-1714-4fd1-8c7b-55b68eaab8fb",
                    "object_modified": "2023-06-12T03:16:53.000Z"
                },
                {
                    "object_ref": "attack-pattern--f99d7c5e-015e-4aec-809f-c62a392137d1",
                    "object_modified": "2023-06-12T03:16:53.000Z"
                },
                {
                    "object_ref": "attack-pattern--ff405e31-278c-42db-964c-b36eac195238",
                    "object_modified": "2022-07-29T18:07:09.000Z"
                },
                {
                    "object_ref": "attack-pattern--97dc0499-c809-46e0-8bdf-6e2991e9ee02",
                    "object_modified": "2023-06-12T03:16:53.000Z"
                },
                {
                    "object_ref": "attack-pattern--88a747d9-fa91-48ca-b7b5-829b13ed0884",
                    "object_modified": "2023-06-12T03:16:53.000Z"
                },
                {
                    "object_ref": "attack-pattern--dba23df3-b5ac-4bb1-b786-8a96d7ff5d61",
                    "object_modified": "2022-08-18T19:04:59.000Z"
                },
                {
                    "object_ref": "attack-pattern--f2dff7cf-8146-4eb2-8875-d7a293b66b5b",
                    "object_modified": "2023-06-12T03:16:53.000Z"
                },
                {
                    "object_ref": "attack-pattern--0d9f6aba-487c-4e0c-a483-97086bdec821",
                    "object_modified": "2023-06-12T03:16:53.000Z"
                },
                {
                    "object_ref": "attack-pattern--89a91ded-a372-4630-b5a8-3e14d91f8408",
                    "object_modified": "2023-06-12T03:16:53.000Z"
                },
                {
                    "object_ref": "attack-pattern--b5f240be-4747-498b-ad69-0be4d1d36f94",
                    "object_modified": "2024-02-04T23:05:59.000Z"
                },
                {
                    "object_ref": "attack-pattern--07a590ec-1c21-4b8c-87c7-79cf67c69612",
                    "object_modified": "2023-06-12T03:16:53.000Z"
                },
                {
                    "object_ref": "attack-pattern--bae42eab-b9f0-4f0e-8227-d4f619e8d679",
                    "object_modified": "2023-06-12T03:16:53.000Z"
                },
                {
                    "object_ref": "attack-pattern--2f0fb949-f307-45be-8989-a60da6f5ca06",
                    "object_modified": "2022-07-29T18:07:09.000Z"
                },
                {
                    "object_ref": "attack-pattern--fb488db2-63ff-42d9-9495-5ae27fc5a6cd",
                    "object_modified": "2023-06-12T03:16:53.000Z"
                },
                {
                    "object_ref": "attack-pattern--b4d2be4f-32c7-45a1-aa47-4292b4891355",
                    "object_modified": "2023-06-12T03:08:06.000Z"
                },
                {
                    "object_ref": "attack-pattern--32407871-8a18-4832-9239-922bcbfc2956",
                    "object_modified": "2024-02-04T22:12:32.000Z"
                },
                {
                    "object_ref": "attack-pattern--89575dad-41e5-4c78-9fa1-0ef36d93177e",
                    "object_modified": "2023-09-05T15:58:57.000Z"
                },
                {
                    "object_ref": "attack-pattern--4d4a170a-b5c6-47eb-9e5e-f4d844bdd18c",
                    "object_modified": "2023-09-05T15:58:57.000Z"
                },
                {
                    "object_ref": "attack-pattern--212ba8ed-7537-49bb-a562-865d29591ed4",
                    "object_modified": "2023-09-05T15:58:57.000Z"
                },
                {
                    "object_ref": "attack-pattern--c9fcb202-2596-419f-b4b0-a6f2d57579e5",
                    "object_modified": "2023-09-05T15:58:57.000Z"
                },
                {
                    "object_ref": "attack-pattern--001b4b10-7f27-479c-a120-f23ca32d2612",
                    "object_modified": "2023-09-05T15:58:57.000Z"
                },
                {
                    "object_ref": "attack-pattern--e9628e70-223d-43a7-a12d-e294331a3bd4",
                    "object_modified": "2023-09-05T15:58:57.000Z"
                },
                {
                    "object_ref": "attack-pattern--43f52b47-ed72-409a-b776-ff8bf53d5cde",
                    "object_modified": "2023-09-05T15:58:57.000Z"
                },
                {
                    "object_ref": "attack-pattern--3a5a3838-b787-413d-9f8c-5cd9f09f2a51",
                    "object_modified": "2024-02-04T23:05:59.000Z"
                },
                {
                    "object_ref": "attack-pattern--3df498cb-01bf-4cab-a912-bd1b515ba967",
                    "object_modified": "2023-09-05T15:58:57.000Z"
                },
                {
                    "object_ref": "attack-pattern--4571e48e-28cd-4ca2-b034-24ccd5a89588",
                    "object_modified": "2024-02-04T23:05:59.000Z"
                },
                {
                    "object_ref": "attack-pattern--2d63fbe3-1a4d-4698-bd86-a7a92f4222d0",
                    "object_modified": "2023-09-05T15:58:57.000Z"
                },
                {
                    "object_ref": "attack-pattern--5c870ef4-848b-4bd0-a556-b714e2c7d524",
                    "object_modified": "2023-09-05T19:05:13.000Z"
                },
                {
                    "object_ref": "relationship--3705787a-116c-4ed1-8bbb-72e4c0a06779",
                    "object_modified": "2024-03-25T08:50:27.912457Z"
                },
                {
                    "object_ref": "relationship--6aa4cafc-d9da-467a-852f-5f894a88eb46",
                    "object_modified": "2024-03-25T08:50:27.912545Z"
                },
                {
                    "object_ref": "relationship--99e356f1-72ca-4be0-9d9a-d985d25e4858",
                    "object_modified": "2024-03-25T08:50:27.912609Z"
                },
                {
                    "object_ref": "relationship--0dae5b00-d648-4a7e-ab1b-e1dffc89a1e5",
                    "object_modified": "2024-03-25T08:50:27.912684Z"
                },
                {
                    "object_ref": "relationship--33df35df-e2fd-4306-9714-5be660b562e0",
                    "object_modified": "2024-03-25T08:50:27.912745Z"
                },
                {
                    "object_ref": "relationship--04ae7330-75b2-417b-905d-ae8ed01226da",
                    "object_modified": "2024-03-25T08:50:27.912806Z"
                },
                {
                    "object_ref": "relationship--a87ddbb3-6d1d-43c3-8038-dcec375086f2",
                    "object_modified": "2024-03-25T08:50:27.912867Z"
                },
                {
                    "object_ref": "relationship--2e24ea6f-911a-4934-ac99-9eb134e5951c",
                    "object_modified": "2024-03-25T08:50:27.912927Z"
                },
                {
                    "object_ref": "relationship--5d3b607c-b467-4363-80b8-87cdb4dc11c4",
                    "object_modified": "2024-03-25T08:50:27.912996Z"
                },
                {
                    "object_ref": "relationship--1babad64-07d7-406b-ae70-b3114cb39e28",
                    "object_modified": "2024-03-25T08:50:27.913055Z"
                },
                {
                    "object_ref": "relationship--b31ff93b-fb3e-48b4-8e56-585e72f460e3",
                    "object_modified": "2024-03-25T08:50:27.913112Z"
                },
                {
                    "object_ref": "relationship--ede2c56f-c09b-4f15-9958-585ffd1b9382",
                    "object_modified": "2024-03-25T08:50:27.913176Z"
                },
                {
                    "object_ref": "relationship--a904c1be-d409-4ff9-93bc-ae737dba9e93",
                    "object_modified": "2024-03-25T08:50:27.913235Z"
                },
                {
                    "object_ref": "relationship--359476a1-9cef-459d-8541-0490c237e0ec",
                    "object_modified": "2024-03-25T08:50:27.913296Z"
                },
                {
                    "object_ref": "relationship--37c0b97f-ce34-408b-9410-5a8253945774",
                    "object_modified": "2024-03-25T08:50:27.913354Z"
                },
                {
                    "object_ref": "relationship--7cf449a9-7e3d-49ce-813b-5721f162ee49",
                    "object_modified": "2024-03-25T08:50:27.913412Z"
                },
                {
                    "object_ref": "relationship--a6e9aa46-520f-4a3c-bd91-fa6f31a28035",
                    "object_modified": "2024-03-25T08:50:27.913476Z"
                },
                {
                    "object_ref": "relationship--ef17129a-351d-42d4-97d8-cd6d03c5bef6",
                    "object_modified": "2024-03-25T08:50:27.913533Z"
                },
                {
                    "object_ref": "relationship--f7f1063f-59d4-4339-ac13-b96a59388fb3",
                    "object_modified": "2024-03-25T08:50:27.913589Z"
                },
                {
                    "object_ref": "relationship--f7e1fb1d-da85-4635-b357-c0159b25d1cd",
                    "object_modified": "2024-03-25T08:50:27.91365Z"
                },
                {
                    "object_ref": "relationship--18474824-7223-4320-94ec-9d864d3b0162",
                    "object_modified": "2024-03-25T08:50:27.913706Z"
                },
                {
                    "object_ref": "relationship--6f22cf11-b3f6-423b-b143-e6376ed249ec",
                    "object_modified": "2024-03-25T08:50:27.913766Z"
                },
                {
                    "object_ref": "relationship--98c2d2f4-96e0-4fcc-8aba-804cf0cef55d",
                    "object_modified": "2024-03-25T08:50:27.913824Z"
                },
                {
                    "object_ref": "relationship--e9a622d9-8e35-43ee-837d-6f796efa7ee1",
                    "object_modified": "2024-03-25T08:50:27.913881Z"
                },
                {
                    "object_ref": "relationship--ba917694-51d7-4e70-a42b-6bc8381d2ed0",
                    "object_modified": "2024-03-25T08:50:27.913937Z"
                },
                {
                    "object_ref": "relationship--b43ebdc4-8060-4fde-8cbc-eff948ce289c",
                    "object_modified": "2024-03-25T08:50:27.913996Z"
                },
                {
                    "object_ref": "relationship--c058b2b0-7946-4d44-8a13-f4d2730b0572",
                    "object_modified": "2024-03-25T08:50:27.914057Z"
                },
                {
                    "object_ref": "relationship--1927b5ec-59fa-470c-b6a5-b902ee7ff983",
                    "object_modified": "2024-03-25T08:50:27.914122Z"
                },
                {
                    "object_ref": "relationship--b6ca5145-ce19-49cf-9af9-ed9d8fa678e0",
                    "object_modified": "2024-03-25T08:50:27.91418Z"
                },
                {
                    "object_ref": "relationship--05911268-8eef-4e2c-bdc3-7f2d3331f569",
                    "object_modified": "2024-03-25T08:50:27.914237Z"
                },
                {
                    "object_ref": "relationship--bd4c6906-fcad-4ce2-b06b-67324948fe4b",
                    "object_modified": "2024-03-25T08:50:27.914294Z"
                },
                {
                    "object_ref": "relationship--5e51e9d6-cd13-4624-8959-5beeeb2ff62c",
                    "object_modified": "2024-03-25T08:50:27.914351Z"
                },
                {
                    "object_ref": "relationship--01ac9de6-7db1-472a-b65d-1ecef7da0371",
                    "object_modified": "2024-03-25T08:50:27.914407Z"
                },
                {
                    "object_ref": "relationship--7f6b05ce-3274-4f78-93fb-e4196cc903bf",
                    "object_modified": "2024-03-25T08:50:27.914479Z"
                },
                {
                    "object_ref": "relationship--aa4d33d8-56ab-45a0-8093-89e64857c91d",
                    "object_modified": "2024-03-25T08:50:27.914537Z"
                },
                {
                    "object_ref": "relationship--f4c2878f-c988-4246-aa5d-d3cfc701cb00",
                    "object_modified": "2024-03-25T08:50:27.914597Z"
                },
                {
                    "object_ref": "relationship--a11c1e52-76bd-4214-a92c-da3b2954e608",
                    "object_modified": "2024-03-25T08:50:27.914655Z"
                },
                {
                    "object_ref": "relationship--152ccf46-deb4-4b22-8a8a-ee1f7dada4a1",
                    "object_modified": "2024-03-25T08:50:27.914712Z"
                },
                {
                    "object_ref": "relationship--afdbd282-c7d1-40f8-bd4c-0027b78424be",
                    "object_modified": "2024-03-25T08:50:27.914772Z"
                },
                {
                    "object_ref": "relationship--555e471c-9107-40a6-8220-16c5779cec53",
                    "object_modified": "2024-03-25T08:50:27.914828Z"
                },
                {
                    "object_ref": "relationship--dd591950-1d83-4e87-9ffa-046022923f21",
                    "object_modified": "2024-03-25T08:50:27.914885Z"
                },
                {
                    "object_ref": "relationship--19d8ce5b-1813-44a3-9565-6ee26598e9d0",
                    "object_modified": "2024-03-25T08:50:27.914941Z"
                },
                {
                    "object_ref": "relationship--0e407f9f-a496-489a-8ae0-51f4e813894f",
                    "object_modified": "2024-03-25T08:50:27.915005Z"
                },
                {
                    "object_ref": "relationship--fe134f38-5772-4982-8ca0-3fa819589a7f",
                    "object_modified": "2024-03-25T08:50:27.915069Z"
                },
                {
                    "object_ref": "relationship--59e501a0-012e-4029-a77a-5c08502b03da",
                    "object_modified": "2024-03-25T08:50:27.915126Z"
                },
                {
                    "object_ref": "relationship--6231f2f6-6262-46df-893b-7b6393711d6d",
                    "object_modified": "2024-03-25T08:50:27.915186Z"
                },
                {
                    "object_ref": "relationship--34050712-ec46-4218-9e63-c2a2cec3cdd8",
                    "object_modified": "2024-03-25T08:50:27.915243Z"
                },
                {
                    "object_ref": "relationship--faee8d68-a556-4d0c-986d-fb112d1bedba",
                    "object_modified": "2024-03-25T08:50:27.9153Z"
                },
                {
                    "object_ref": "relationship--b77e88a1-644a-4add-9c03-1ac64eef7178",
                    "object_modified": "2024-03-25T08:50:27.915356Z"
                },
                {
                    "object_ref": "relationship--f44c90a2-a87c-4da6-8b4a-0e57025d2ff7",
                    "object_modified": "2024-03-25T08:50:27.915412Z"
                },
                {
                    "object_ref": "relationship--3156e2fa-cb53-4bd6-80af-37858731a439",
                    "object_modified": "2024-03-25T08:50:27.915479Z"
                },
                {
                    "object_ref": "relationship--04963686-e46e-4722-8d8a-3f9a3215009d",
                    "object_modified": "2024-03-25T08:50:27.915536Z"
                },
                {
                    "object_ref": "relationship--21c23524-1b66-4875-b145-2e7e8c8d4029",
                    "object_modified": "2024-03-25T08:50:27.915592Z"
                },
                {
                    "object_ref": "relationship--679acef4-bab3-4e1d-99e7-c4edac3f112b",
                    "object_modified": "2024-03-25T08:50:27.915649Z"
                },
                {
                    "object_ref": "relationship--1a405f19-04ac-4375-b777-8406935c2df3",
                    "object_modified": "2024-03-25T08:50:27.91642Z"
                },
                {
                    "object_ref": "relationship--0cdc6723-aa5e-4d1e-b3dc-34769606e832",
                    "object_modified": "2024-03-25T08:50:27.916494Z"
                },
                {
                    "object_ref": "relationship--7d17cd6d-80f6-40f4-9cb4-db262fef79e9",
                    "object_modified": "2024-03-25T08:50:27.916558Z"
                },
                {
                    "object_ref": "relationship--db94f040-fcd7-4741-939e-c4d4f45bbe49",
                    "object_modified": "2024-03-25T08:50:27.916619Z"
                },
                {
                    "object_ref": "relationship--2e309c48-1daf-4401-bbc5-6233c669248d",
                    "object_modified": "2024-03-25T08:50:27.916678Z"
                },
                {
                    "object_ref": "relationship--d1d1c6db-faba-408d-a173-3ac4592672c0",
                    "object_modified": "2024-03-25T08:50:27.916736Z"
                },
                {
                    "object_ref": "x-mitre-matrix--b7a201c7-e967-4adc-b4ac-ea1fc58f8c54",
                    "object_modified": "2024-03-25T11:50:27.916Z"
                },
                {
                    "object_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
                    "object_modified": "2024-02-05T14:00:00.188Z"
                }
            ],
            "x_mitre_version": "0.1"
        },
        {
            "type": "x-mitre-tactic",
            "spec_version": "2.1",
            "id": "x-mitre-tactic--72987607-3031-4e46-8352-255208c061c7",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2022-07-29T18:07:09.000Z",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Reconnaissance/Reconnaissance",
                    "external_id": "AZTA100"
                }
            ],
            "name": "Reconnaissance",
            "description": "The adversary is trying to gather information they can use to plan future operations.",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_mitre_shortname": "reconnaissance"
        },
        {
            "type": "x-mitre-tactic",
            "spec_version": "2.1",
            "id": "x-mitre-tactic--5664197e-8e77-4145-b848-9dd68227eca1",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2024-02-04T23:05:59.000Z",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/InitialAccess/InitialAccess",
                    "external_id": "AZTA200"
                }
            ],
            "name": "Initial Access",
            "description": "The adversary is attempting to gain access to an Azure Resource or Azure AD.",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_mitre_shortname": "initial-access"
        },
        {
            "type": "x-mitre-tactic",
            "spec_version": "2.1",
            "id": "x-mitre-tactic--2b04afaa-b289-49aa-9a83-44978deb984c",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2022-07-29T18:07:09.000Z",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Execution/Execution",
                    "external_id": "AZTA300"
                }
            ],
            "name": "Execution",
            "description": "The adversary is trying to run malicious code.",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_mitre_shortname": "execution"
        },
        {
            "type": "x-mitre-tactic",
            "spec_version": "2.1",
            "id": "x-mitre-tactic--f2cee537-023e-433c-83b3-54128e17dc0e",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2024-02-04T23:05:59.000Z",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/PrivilegeEscalation/PrivilegeEscalation",
                    "external_id": "AZTA400"
                }
            ],
            "name": "Privilege Escalation",
            "description": "The adversary is trying to escalate their privileges within Azure Resources or Azure Active Directory.",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_mitre_shortname": "privilege-escalation"
        },
        {
            "type": "x-mitre-tactic",
            "spec_version": "2.1",
            "id": "x-mitre-tactic--6caedcbe-eb96-4ba7-ba7e-3007688f12d1",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2024-02-04T23:05:59.000Z",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Persistence/Persistence",
                    "external_id": "AZTA500"
                }
            ],
            "name": "Persistence",
            "description": "The adversary is trying to persist in the Azure tenant or subscription. Persistence consists of techniques that adversaries use to modify existing resources, or modify and manipulate accounts in order to access Azure Active Directory.",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_mitre_shortname": "persistence"
        },
        {
            "type": "x-mitre-tactic",
            "spec_version": "2.1",
            "id": "x-mitre-tactic--17719260-6270-4060-8d07-369d622a73d4",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2024-02-04T23:05:59.000Z",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/CredentialAccess/CredentialAccess",
                    "external_id": "AZTA600"
                }
            ],
            "name": "Credential Access",
            "description": "The adversary is trying to steal account usernames, passwords, or access tokens. Credential access in Azure consists of stealing methods of authentication which includes passwords and tokens. Stealing these credentials can give adversaries a potential avenue of privilege escalation or persistence.",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_mitre_shortname": "credential-access"
        },
        {
            "type": "x-mitre-tactic",
            "spec_version": "2.1",
            "id": "x-mitre-tactic--170069f3-584a-4e42-b70b-70e18bcfab2f",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2023-09-05T15:58:57.000Z",
            "modified": "2024-02-04T23:05:59.000Z",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Impact/Impact",
                    "external_id": "AZTA700"
                }
            ],
            "name": "Impact",
            "description": "The adversary is trying to either steal, manipulate, or delete data. Exfiltration in Azure consists of using techniques to lift resource data from specific resources. This can be done by generating SAS URIs for unauthenticated & persistent downloads, or can be done by directly exfiltrating the data from the resource itself. Deletion can occur through various means.",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_mitre_shortname": "impact"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--268b476a-8eea-4961-8215-c7557693e226",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2022-07-29T18:07:09.000Z",
            "name": "Gather Application Information",
            "description": "An adversary may obtain information about an application within Azure Active Directory.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "reconnaissance"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Reconnaissance/AZT105/AZT105",
                    "external_id": "AZT105"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/graph/migrate-azure-ad-graph-configure-permissions"
                }
            ],
            "x_atrm_actions": [
                "microsoft.directory/applications/*/read"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\t[`#!powershell Get-AzADApplication`](https://docs.microsoft.com/en-us/powershell/module/az.resources/get-azadapplication?view=azps-8.0.0)\n\n=== \"Azure CLI\"\t\n\t[`#!powershell az ad app show`](https://docs.microsoft.com/en-us/cli/azure/ad/app?view=azure-cli-latest#az-ad-app-show)\n\n=== \"Microsoft Graph REST API\"\t\n\t[`#!powershell GET https://graph.microsoft.com/v1.0/applications/{id}`](https://docs.microsoft.com/en-us/graph/api/application-get?view=graph-rest-1.0&tabs=http)\n\n=== \"Azure Portal\"\n\t![Appdata](appdata.PNG)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_resources": [
                "Azure Active Directory"
            ],
            "x_mitre_brief": "An adversary may obtain information about an application within Azure Active Directory.",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--664d48ad-7883-4d11-9e11-e8ae3b74e429",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2022-07-29T18:07:09.000Z",
            "name": "IP Discovery",
            "description": "It is possible to view the IP address on a resource by viewing the Virtual Network Interface",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "reconnaissance"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Reconnaissance/AZT102/AZT102",
                    "external_id": "AZT102"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/virtual-network/ip-services/public-ip-addresses"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Network/publicIPAddresses/read",
                "Microsoft.Compute/virtualMachines/read"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\t[`#!powershell Get-AzPublicIpAddress`](https://docs.microsoft.com/en-us/powershell/module/az.network/get-azpublicipaddress?view=azps-8.0.0)\n\t\n=== \"Azure CLI\"\n\t[`#!powershell az network public-ip show`](https://docs.microsoft.com/en-us/cli/azure/network/public-ip?view=azure-cli-latest#az-network-public-ip-show)\n\n=== \"Azure REST API\"\t\n\t[`#!powershell GET https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Network/publicIPAddresses/{publicIpAddressName}?api-version=2021-08-01`](https://docs.microsoft.com/en-us/rest/api/virtualnetwork/public-ip-addresses/get)\n\n=== \"Azure Portal\"\n\t![IP](IP.png)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_resources": [
                "Network Interface",
                "Virtual Machine"
            ],
            "x_mitre_brief": "By viewing certain Azure resources, it is possible to view the private and public IP addresses assigned to a  resource.",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--9b9d58ea-b451-4964-ac4b-1e0082bd4f9d",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2022-07-29T18:07:09.000Z",
            "name": "Public Accessible Resource",
            "description": "A resource within Azure is accessible from the public internet.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "reconnaissance"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Reconnaissance/AZT103/AZT103",
                    "external_id": "AZT103"
                }
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_resources": [
                "Network Interface",
                "Virtual Machine"
            ],
            "x_mitre_brief": "A resource within Azure is accessible from the public internet.",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--11da0019-1a48-47df-a428-1f313caa4c47",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2022-07-29T18:07:09.000Z",
            "name": "Gather User Information",
            "description": "An adversary may obtain information about a User within Azure Active Directory. Details may include email addresses, first/last names, job information, addresses, and assigned roles. By default, all users are able to read other user's roles and group memberships within AAD.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "reconnaissance"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Reconnaissance/AZT104/AZT104",
                    "external_id": "AZT104"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/users-default-permissions"
                }
            ],
            "x_atrm_actions": [
                "microsoft.directory/\\*/*/read"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\t\n\t[`#!powershell Get-AzADUser`](https://docs.microsoft.com/en-us/powershell/module/az.resources/get-azaduser?view=azps-8.0.0)\n\t\n=== \"Azure CLI\"\t\n\t[`#!powershell az ad user show`](https://docs.microsoft.com/en-us/cli/azure/ad/user?view=azure-cli-latest#az-ad-user-show)\n\n=== \"Microsoft Graph REST API\"\t\n\t[`#!powershell GET https://graph.microsoft.com/v1.0/users/{id | userPrincipalName}`](https://docs.microsoft.com/en-us/graph/api/user-get?view=graph-rest-1.0&tabs=http)\n\n=== \"Azure Portal\"\n\t![Userinfo](userinfo.PNG)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_resources": [
                "Azure Active Directory"
            ],
            "x_mitre_brief": "An adversary may obtain information about a user within Azure Active Directory.",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--32e95d98-f487-4395-99e1-3433e5baea8d",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2022-07-29T18:07:09.000Z",
            "name": "Gather Victim Data",
            "description": "An adversary may access a user's personal data if their account is compromised. This includes data such as email, OneDrive, Teams, etc.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "reconnaissance"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Reconnaissance/AZT108/AZT108",
                    "external_id": "AZT108"
                }
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_resources": [
                "Azure Active Directory"
            ],
            "x_mitre_brief": "An adversary may access a user's personal data if their account is compromised",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--fdf40a9b-c87a-43ab-b669-c22e6d53c2b8",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2022-07-29T18:07:09.000Z",
            "name": "Port Mapping",
            "description": "It is possible to view the open ports on a virtual machine by viewing the Virtual Network Interface's assigned Network Security Group",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "reconnaissance"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Reconnaissance/AZT101/AZT101",
                    "external_id": "AZT101"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Network/networkSecurityGroups/read"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\t\n\t[`#!powershell Get-AzNetworkSecurityGroup`](https://docs.microsoft.com/en-us/powershell/module/az.network/get-aznetworksecuritygroup?view=azps-8.0.0)\n\n=== \"Azure CLI\"\t\n\t[`#!powershell az network nsg show`](https://docs.microsoft.com/en-us/cli/azure/network/nsg?view=azure-cli-latest#az-network-nsg-show)\n\t\n=== \"Azure REST API\"\t\n\t[`#!http GET https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Network/networkSecurityGroups/{networkSecurityGroupName}?api-version=2021-08-01`](https://docs.microsoft.com/en-us/rest/api/virtualnetwork/network-security-groups/get#code-try-0)\n\n=== \"Azure Portal\"\n\t![NSG](NSG.PNG)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_resources": [
                "Network Security Group"
            ],
            "x_mitre_brief": "By viewing certain Azure resources, it is possible to view the open ports on a resource.",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--ac28b3e1-1bd0-491b-a859-6d0100ead69d",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2024-02-04T23:05:59.000Z",
            "name": "Gather Role Information",
            "description": "An adversary may obtain information about a role within Azure Active Directory or within Azure Resource Manager.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "reconnaissance"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Reconnaissance/AZT106/AZT106",
                    "external_id": "AZT106"
                }
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_brief": "An adversary may obtain information about a role.",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--5b459d6b-6aac-442d-9d7d-8cf14fb2de3f",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:16:53.000Z",
            "name": "Gather AAD Role Information",
            "description": "An adversary may gather role assignments within Azure Active Directory.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "reconnaissance"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Reconnaissance/AZT106/AZT106-1",
                    "external_id": "AZT106.001"
                }
            ],
            "x_atrm_actions": [
                "microsoft.directory/roleAssignments/standard/read",
                "microsoft.directory/directoryRoles/standard/read",
                "microsoft.directory/directoryRoles/eligibleMembers/read",
                "microsoft.directory/directoryRoles/members/read"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_examples": [
                "=== \"Microsoft Graph REST API\"\t\n\t* [`#!powershell GET https://graph.microsoft.com/v1.0/directoryRoles/{role ID}`](https://docs.microsoft.com/en-us/graph/api/directoryrole-list-members?view=graph-rest-1.0&tabs=http)\n=== \"Azure Portal\"\n\t![Userroles](userroles.png)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_resources": [
                "Azure Active Directory"
            ],
            "x_mitre_brief": "An adversary may obtain information about a role within Azure Active Directory.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--8d9b6e81-305c-4e62-871a-56ff43be6a8e",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-02-04T23:05:59.000Z",
            "modified": "2024-02-04T23:05:59.000Z",
            "name": "List Transitive Role Assignments",
            "description": "An adversary may gather Transitive Role Assignments by specifiying a known principal id",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "reconnaissance"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Reconnaissance/AZT106/AZT106-4",
                    "external_id": "AZT106.004"
                }
            ],
            "x_atrm_examples": [
                "=== \"Microsoft Graph REST API\"\t\n\t* [`#!powershell GET https://graph.microsoft.com/v1.0/directoryRoles/{role ID}`](https://docs.microsoft.com/en-us/graph/api/directoryrole-list-members?view=graph-rest-1.0&tabs=http)"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_resources": [
                "Azure Active Directory"
            ],
            "x_mitre_brief": "An adversary may gather Transitive Role Assignments by specifiying a known principal id",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--8964e259-5a76-496f-9187-b7d15c29a074",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:16:53.000Z",
            "name": "Gather Azure Resources Role Assignments",
            "description": "An adversary may gather role assignments for a specific Azure Resource, Resource Group, or Subscription.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "reconnaissance"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Reconnaissance/AZT106/AZT106-3",
                    "external_id": "AZT106.003"
                }
            ],
            "x_atrm_actions": [
                "{resource}/read"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\t[`#!powershell Get-AzRoleAssignment`](https://docs.microsoft.com/en-us/powershell/module/az.resources/get-azroleassignment?view=azps-8.0.0)\n\t\n=== \"Azure CLI\"\t\t\n\t[`#!powershell az role assignment`](https://docs.microsoft.com/en-us/cli/azure/role/assignment?view=azure-cli-latest)\n\n=== \"Azure REST API\"\t\n\t* [`#!powershell GET https://management.azure.com/{scope}/providers/Microsoft.Authorization/roleAssignments?api-version=2015-07-01`](https://docs.microsoft.com/en-us/rest/api/authorization/role-assignments/list-for-scope)\n=== \"Azure Portal\"\n\t![UserRMroles](userRMroles.png)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_resources": [
                "Azure Resources"
            ],
            "x_mitre_brief": "An adversary may gather role assignments for a specific Azure Resource, Resource Group, or Subscription.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--b68df883-87a8-4bc8-a553-16bbff53c72a",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2022-07-29T18:07:09.000Z",
            "name": "Gather Application Role Information",
            "description": "An adversary may gather information about an application role & it's member assignments within Azure Active Directory.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "reconnaissance"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Reconnaissance/AZT106/AZT106-2",
                    "external_id": "AZT106.002"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/architecture/multitenant-identity/app-roles"
                }
            ],
            "x_atrm_actions": [
                "microsoft.directory/roleAssignments/standard/read",
                "microsoft.directory/directoryRoles/standard/read",
                "microsoft.directory/directoryRoles/eligibleMembers/read",
                "microsoft.directory/directoryRoles/members/read",
                "microsoft.directory/users/appRoleAssignments/read",
                "microsoft.directory/servicePrincipals/appRoleAssignments/read",
                "microsoft.directory/servicePrincipals/appRoleAssignedTo/read",
                "microsoft.directory/applications/owners/read"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\t[`#!powershell Get-AzADAppPermission`](https://docs.microsoft.com/en-us/powershell/module/az.resources/get-azadapppermission?view=azps-8.0.0)\n\t\n=== \"Azure CLI\"\t\t\n\t[`#!powershell az ad app permission list`](https://docs.microsoft.com/en-us/cli/azure/ad/app/permission?view=azure-cli-latest#az-ad-app-permission-list)\n\n=== \"Microsoft Graph REST API\"\t\n\t* [`#!powershell GET https://graph.microsoft.com/v1.0/users/{id}/appRoleAssignments`](https://docs.microsoft.com/en-us/graph/api/user-list-approleassignments?view=graph-rest-1.0&tabs=http)\n\t* [`#!powershell GET https://graph.microsoft.com/v1.0/servicePrincipals/{id}/appRoleAssignments`](https://docs.microsoft.com/en-us/graph/api/serviceprincipal-list-approleassignments?view=graph-rest-1.0&tabs=http)\t\t\n\t* [`#!powershell GET https://graph.microsoft.com/v1.0/groups/{id}/appRoleAssignments`](https://docs.microsoft.com/en-us/graph/api/group-list-approleassignments?view=graph-rest-1.0&tabs=http)\n\n=== \"Azure Portal\"\n\t![Approle](Approle.PNG)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_resources": [
                "Azure Active Directory"
            ],
            "x_mitre_brief": "An adversary may obtain information about an application role within Azure Active Directory.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--62686ebd-f6a3-425a-8272-8f79c5d7854d",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2022-07-29T18:07:09.000Z",
            "name": "Gather Resource Data",
            "description": "An adversary may obtain information and data within a resource.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "reconnaissance"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Reconnaissance/AZT107/AZT107",
                    "external_id": "AZT107"
                }
            ],
            "x_atrm_actions": [
                "Azure Resources"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\t[`#!powershell Get-AzResource`](https://docs.microsoft.com/en-us/powershell/module/az.resources/get-azresource?view=azps-8.0.0)\n\t\n=== \"Azure CLI\"\t\t\n\t[`#!powershell az resource show`](https://docs.microsoft.com/en-us/cli/azure/resource?view=azure-cli-latest#az-resource-show)\n\n=== \"Azure REST API\"\t\n\t[`#!powershell GET https://management.azure.com/{resourceId}?api-version=2021-04-01`](https://docs.microsoft.com/en-us/rest/api/resources/resources/get-by-id)\n\n=== \"Azure Portal\"\n\t![example](example.png)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_resources": [
                "\\{resource}/*/read"
            ],
            "x_mitre_brief": "An adversary may obtain information and data within a resource.",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--0a1f5825-bdcf-4ac5-a7e7-cfe13d22f934",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:27:03.000Z",
            "name": "Password Spraying",
            "description": "An adversary may potentially gain access to AzureAD by guessing a common password for multiple users.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "initial-access"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/InitialAccess/AZT202/AZT202",
                    "external_id": "AZT202"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/active-directory/reports-monitoring/concept-sign-ins"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/security/compass/incident-response-playbook-password-spray"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/graph/api/resources/azure-ad-auditlog-overview?view=graph-rest-1.0"
                }
            ],
            "x_atrm_detections": [
                "## **Logs**\n\n| Data Source        | Application     | Resource                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Azure Active Directory | Azure Portal\t | Windows Azure Service Management API\t| SignInLogs |\n| Azure Active Directory | Microsoft Azure PowerShell\t | Windows Azure Service Management API\t| SignInLogs |\n\n## **Detection Screenshots**\n\n![](failedsignin.png)\n\n## **Detection Notes**\n\nThe main difference between a successful and unsuccessful login is the 'Status' field, which will designate a \"Success\" or \"Failure\". \n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql SignInLogs | where UserId == 'IDGOESHERE'` |\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FInitialAccess%2FAZT202%2FAZT202.json)"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_examples": [
                "=== \"Az PowerShell (Secret)\"\n\t[`#!powershell Connect-AzAccount`](https://docs.microsoft.com/en-us/powershell/module/az.accounts/connect-azaccount?view=azps-8.0.0)\n\t\n=== \"Azure CLI\"\n\t[`#!powershell az login -u <username> -p <password>`](https://docs.microsoft.com/en-us/cli/azure/authenticate-azure-cli)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_resources": [
                "Azure Active Directory"
            ],
            "x_mitre_brief": "An adversary may potentially gain access to AzureAD by guessing a common password for multiple users.",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--ac7f52b1-1a71-4f4c-9fef-4869861b29e5",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-08-18T19:04:59.000Z",
            "modified": "2023-06-12T03:27:03.000Z",
            "name": "Malicious Application Consent",
            "description": "An adversary may lure a victim into giving their access to a malicious application registered in AzureAD.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "initial-access"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/InitialAccess/AZT203/AZT203",
                    "external_id": "AZT203"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/security/compass/incident-response-playbook-compromised-malicious-app"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/security/compass/incident-response-playbook-app-consent"
                }
            ],
            "x_atrm_actions": [
                "Any user can consent to an application which will impersonate that user's privileges."
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs**\n\n| Data Source        | Application     | Resource                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Azure Active Directory |N/A | AAD | AuditLogs\n\n## **Detection Details**\n\nPlease review the incident response playbooks in the 'Additional Resources' section below.\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AuditLogs | where ActivityDisplayName == \"Consent to application\"` |\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FInitialAccess%2FAZT203%2FAZT203.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_resources": [
                "Azure Active Directory"
            ],
            "x_mitre_brief": "An adversary may lure a victim into giving their access to a malicious application registered in AzureAD.",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--0b072ae4-5fe4-4f70-8cd9-f1bf6abc8aba",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2022-07-29T18:07:09.000Z",
            "name": "Valid Credentials",
            "description": "Adversaries may login to AzureAD using valid credentials. By logging in with valid credentials to an account or service principal, the adversary will assume all privileges of that account or service principal. If the account is privileged, this may lead to other tactics, such as persistence or privilege escalation.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "initial-access"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/InitialAccess/AZT201/AZT201",
                    "external_id": "AZT201"
                }
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_brief": "Adversaries may login to AzureAD using valid credentials.",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--845c16b9-fc4e-452b-872e-2d1815d392ad",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:27:03.000Z",
            "name": "Service Principal",
            "description": "By obtaining a valid secret or certificate, an adversary may login to AzureAD via command line.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "initial-access"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/InitialAccess/AZT201/AZT201-2",
                    "external_id": "AZT201.002"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/powershell/module/az.accounts/connect-azaccount?view=azps-8.0.0"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/active-directory/reports-monitoring/concept-sign-ins"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/cli/azure/authenticate-azure-cli#sign-in-with-a-service-principal"
                }
            ],
            "x_atrm_detections": [
                "## **Logs**\n\n| Data Source        | Application     | Resource                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Azure Active Directory | {Service Principal's Application ID}\t | Windows Azure Service Management API\t| AADServicePrincipalSignInLogs |\n\n## **Detection Screenshots**\n\n![spclilogin](spclilogin.png)\n\n## **Queries**\t\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AADServicePrincipalSignInLogs | where ServicePrincipalId == 'IDGOESHERE'` |\n\n## **Azure Monitor Alert**\n\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FInitialAccess%2FAZT201%2FAZT201-2.json)"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_examples": [
                "=== \"Az PowerShell (Secret)\"\n\t``` powershell\n\t$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $ApplicationId, $SecurePassword\n\tConnect-AzAccount -Credential $Credential -Tenant '$Context.Tenant.Id' -ServicePrincipal\n\t```\n=== \"Az PowerShell (Certificate)\"\n\t``` powershell\n\t$import = Import-PfxCertificate -FilePath $CertPath -CertStoreLocation Cert:\\LocalMachine\\My -Password $SecurePassword -Exportable\n\tConnect-AzAccount -CertificateThumbprint \"$thumbprint\" -ApplicationId \"$appID\" -Tenant \"$tenant\"\n\t```\t\t\n=== \"Azure CLI\"\n\t``` powershell\n\taz login --service-principal -u <app-id> -p <password-or-cert> --tenant <tenant>\n\t```"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_resources": [
                "Azure Active Directory"
            ],
            "x_mitre_brief": "By obtaining a valid secret or certificate, an adversary may login to AzureAD via command line.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--574aa812-8ea4-434b-b51a-fb67a4701c6b",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:27:03.000Z",
            "name": "User Account",
            "description": "By obtaining valid user credentials, an adversary may login to AzureAD via command line or through the Azure Portal.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "initial-access"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/InitialAccess/AZT201/AZT201-1",
                    "external_id": "AZT201.001"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/active-directory/reports-monitoring/concept-sign-ins"
                }
            ],
            "x_atrm_detections": [
                "## **Logs**\n\n| Data Source        | Application     | Resource                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Azure Active Directory | Azure Portal\t | Windows Azure Service Management API\t| SignInLogs |\n| Azure Active Directory | Microsoft Azure PowerShell\t | Windows Azure Service Management API\t| SignInLogs |\n\n## **Detection Screenshots**\n\n=== \"Portal Sign-in\"\n\t![](portalsignin.png)\n\t\t\n=== \"PowerShell Sign-in\"\n\t![](userclilogin.png)\n\t\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql SignInLogs | where UserId == 'IDGOESHERE'` |\n\t\n## **Azure Monitor Alert**\n\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FInitialAccess%2FAZT201%2FAZT201-1.json)"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_examples": [
                "=== \"Az PowerShell (Secret)\"\n\t[`#!powershell Connect-AzAccount`](https://docs.microsoft.com/en-us/powershell/module/az.accounts/connect-azaccount?view=azps-8.0.0)\n\t\n=== \"Azure CLI\"\n\t[`#!powershell az login -u <username> -p <password>`](https://docs.microsoft.com/en-us/cli/azure/authenticate-azure-cli)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_resources": [
                "Azure Active Directory"
            ],
            "x_mitre_brief": "By obtaining valid user credentials, an adversary may login to AzureAD via command line or through the Azure Portal.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--29e152af-b515-46c0-8ee5-e4c53286cc4e",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:27:03.000Z",
            "name": "AKS Command Invoke",
            "description": "By utilizing 'command invoke' on an Azure Kubernetes Service (AKS) cluster, an attacker can pass commands to the cluster's VM as SYSTEM",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "execution"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Execution/AZT301/AZT301-5",
                    "external_id": "AZT301.005"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/aks/command-invoke"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.ContainerService/managedClusters/runcommand/action",
                "Microsoft.ContainerService/managedclusters/commandResults/read"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Detection Details**\n\nLogs are only generated when running a command through az cli or Az PowerShell. Using `kubectl` will not generate logs.\n\n## **Logs** \n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource | RunCommand\t | Microsoft.ContainerService/managedClusters/runCommand/action\t| AzureActivity |\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AzureActivity | where OperationNameValue == 'MICROSOFT.CONTAINERSERVICE/MANAGEDCLUSTERS/RUNCOMMAND/ACTION'`|\n\n## **Azure Monitor Alert**\n\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FExecution%2FAZT301%2FAZT301-5.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\t[`#!powershell Invoke-AzAksRunCommand`](https://docs.microsoft.com/en-us/powershell/module/az.aks/invoke-azaksruncommand?view=azps-8.0.0)\n\t\n=== \"Azure CLI\"\n    [`#!powershell az aks command invoke`](https://docs.microsoft.com/en-us/cli/azure/aks/command?view=azure-cli-latest)\n\t\n=== \"Azure REST API\"\t\n\t[`#!powershell POST https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.ContainerService/managedClusters/{resourceName}/runCommand?api-version=2022-04-01`](https://docs.microsoft.com/en-us/rest/api/aks/managed-clusters/run-command)\n\n=== \"Azure Portal\"\n\t![aks](aks.PNG)"
            ],
            "x_atrm_resources": [
                "Azure Kubernetes Service"
            ],
            "x_mitre_brief": "By utilizing 'command invoke' on an Azure Kubernetes Service (AKS) cluster, an attacker can pass commands to the cluster's VM as SYSTEM",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--65591b92-94da-41a4-9409-3f4b30fb37da",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-20T15:00:42.000Z",
            "name": "RunCommand",
            "description": "By utilizing the 'RunCommand' feature on a Virtual Machine, an attacker can pass:\n- Windows: PowerShell commands to the VM as SYSTEM.\n- Linux: Shell commands to the VM as root.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "execution"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Execution/AZT301/AZT301-1",
                    "external_id": "AZT301.001"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/virtual-machines/windows/run-command"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/virtual-machines/linux/run-command"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Compute/virtualMachines/runCommand/action",
                "Microsoft.Compute/locations/runCommands/read"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Detection Details**\n\n* **Windows**: The commands are stored as .PS1 files.\n* **Linux**: The commands are stored as script.sh files. \n\n## **Logs** \n\n| Data Source        | Operation Name      | Action/On-Disk Location                                               | Log Provider | \n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource           | Run Command on Virtual Machine\t | Microsoft.Compute/virtualMachines/runCommand/action\t| AzureActivity |\n| On-Resource File (Windows)  | File Creation       | C:\\Packages\\Plugins\\Microsoft.CPlat.Core.RunCommandWindows\\1.1.11\\Downloads | Event |\n| On-Resource File (Windows)  | File Creation       |  C:\\Packages\\Plugins\\Microsoft.CPlat.Core.RunCommandWindows\\1.1.11\\Status | Event |\n| On-Resource File (Linux)    | File Creation       | /var/lib/waagent/run-command/download/ | syslog |\n| On-Resource File (Linux)    | File Creation       | /var/lib/waagent/Microsoft.CPlat.Core.RunCommandLinux-1.0.3/status/ | syslog |\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql let timeframe = toscalar(AzureActivity | where OperationNameValue == 'MICROSOFT.COMPUTE/VIRTUALMACHINES/RUNCOMMAND/ACTION' and ActivityStatusValue == 'Success' | distinct TimeGenerated); Event | where EventID  == '4104' and RenderedDescription has 'RunCommandWindows' | where (timeframe - TimeGenerated) <= 1m` |\n| Log Analytics | `#!sql AzureActivity | where OperationNameValue has 'MICROSOFT.COMPUTE/VIRTUALMACHINES/RUNCOMMAND/ACTION' and ActivityStatusValue == 'Success' or OperationNameValue has 'MICROSOFT.COMPUTE/VIRTUALMACHINES/RUNCOMMANDS/WRITE' and ActivityStatusValue == 'Success'`\n\n## **Azure Monitor Alert**\n\nFor resources *with* Azure Monitor Agent installed\n\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FExecution%2FAZT301%2FAZT301-1-AMA.json)\n\nFor resources *without* Azure Monitor Agent installed\n\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FExecution%2FAZT301%2FAZT301-1.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\n    [`#!powershell Invoke-AzVMRunCommand`](https://docs.microsoft.com/en-us/powershell/module/az.compute/invoke-azvmruncommand?view=azps-8.0.0)\n\t\n=== \"Azure CLI\"\n\n    [`#!powershell az vm run-command`](https://docs.microsoft.com/en-us/cli/azure/vm/run-command?view=azure-cli-latest)\n\t\n=== \"Azure REST API\"\t\n\t[`#!powershell POST https://management.azure.com/subscriptions/{sub id}/resourceGroups/{rg name}/providers/Microsoft.Compute/virtualMachines/{vm name}/runCommand?api-version=2022-03-01`](https://docs.microsoft.com/en-us/rest/api/compute/virtual-machines/run-command)\n\n=== \"Azure Portal\"\n\n    ![runcommand](runcommand.PNG)"
            ],
            "x_atrm_resources": [
                "Virtual Machine"
            ],
            "x_mitre_brief": "By utilizing the 'RunCommand' feature on a Virtual Machine, an attacker can pass PowerShell commands to the VM as SYSTEM.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--c979173f-9f72-4a6d-8eb7-c955a688544e",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2022-07-29T18:07:09.000Z",
            "name": "Virtual Machine Scripting",
            "description": "Adversaries may abuse access to virtual machines by executing a script through various methods in order to gain access to the Virtual Machine.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "execution"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Execution/AZT301/AZT301",
                    "external_id": "AZT301"
                }
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_brief": "Adversaries may abuse access to virtual machines by executing a script through various methods in order to gain access to the Virtual Machine.",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--4e55dc6c-f0cd-4577-afb3-db973f1cfee4",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:33:04.000Z",
            "name": "Compute Gallery Application",
            "description": "By utilizing Compute Gallery Applications, an attacker can pass MS-DOS or PowerShell commands to the VM as SYSTEM.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "execution"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Execution/AZT301/AZT301-4",
                    "external_id": "AZT301.004"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/virtual-machines/vm-applications"
                }
            ],
            "x_atrm_actions": [
                "Virtual Machine"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name     | Action/On-Disk Location                                              | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource | Create or Update Gallery Application Version\t | Microsoft.Compute/galleries/applications/versions/write\t| AzureActivity |\n| Resource | Create or Update Gallery Application\t | Microsoft.Compute/galleries/applications/write\t| AzureActivity |\n| Resource | Create or Update Gallery Application Version\t | Microsoft.Compute/galleries/applications/versions/write\t| AzureActivity |\n| Resource | Create or Update Gallery Application Version\t | Microsoft.Compute/galleries/applications/versions/write\t| AzureActivity |\n| On-Resource File      | File Creation       |  C:\\Packages\\Plugins\\Microsoft.Powershell.DSC\\2.83.2.0\\Status            | Event |\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AzureActivity | where OperationNameValue == 'MICROSOFT.COMPUTE/GALLERIES/APPLICATIONS/VERSIONS/WRITE' and ActivityStatusValue == 'Created'`|\n\n## **Azure Monitor Alert**\n\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FExecution%2FAZT301%2FAZT301-4.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\t* [`#!powershell New-AzGalleryApplication`](https://docs.microsoft.com/en-us/powershell/module/az.compute/new-azgalleryapplication?view=azps-8.0.0)\n\n\t* [`#!powershell New-AzGalleryApplicationVersion`](https://docs.microsoft.com/en-us/powershell/module/az.compute/new-azgalleryapplicationversion?view=azps-8.0.0)\n\n=== \"Azure CLI\"\n    * [`#!powershell az sig gallery-application create`](https://docs.microsoft.com/en-us/cli/azure/sig/gallery-application?view=azure-cli-latest)\n\t* [`#!powershell az sig image-version create`](https://docs.microsoft.com/en-us/cli/azure/sig/image-version?view=azure-cli-latest#az-sig-image-version-create)\n\n=== \"Azure REST API\"\t\n\t[`#!powershell PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Compute/galleries/{galleryName}/applications/{galleryApplicationName}?api-version=2021-10-01`](https://docs.microsoft.com/en-us/rest/api/compute/gallery-applications/create-or-update)\n\n=== \"Azure Portal\"\n\t![vmapp](vmapp.png)"
            ],
            "x_atrm_resources": [
                "Microsoft.Compute/virtualMachines/write",
                "Microsoft.Compute/galleries/write",
                "Microsoft.Compute/galleries/applications/write",
                "Microsoft.Compute/galleries/applications/versions/write"
            ],
            "x_mitre_brief": "By utilizing Compute Gallery Applications, an attacker can pass MS-DOS or PowerShell commands to the VM as SYSTEM.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--094f30e0-d90c-47ec-949d-097c470183a9",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:33:04.000Z",
            "name": "Desired State Configuration",
            "description": "By utilizing the 'Desired State Configuration extension' extension on a Virtual Machine, an attacker can pass PowerShell commands to the VM as SYSTEM.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "execution"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Execution/AZT301/AZT301-3",
                    "external_id": "AZT301.003"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/virtual-machines/extensions/dsc-overview"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Compute/virtualMachines/extensions/*",
                "Microsoft.Compute/virtualMachines/write"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name     | Action/On-Disk Location                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource | Create or Update Virtual Machine Extension\t | Microsoft.Compute/virtualMachines/extensions/write\t| AzureActivity |\n| On-Resource File    | File Creation       |  C:\\Packages\\Plugins\\Microsoft.Powershell.DSC\\2.83.2.0\\Status            | Event |\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql let timeframe = toscalar(AzureActivity | where OperationNameValue == 'MICROSOFT.COMPUTE/VIRTUALMACHINES/EXTENSIONS/WRITE' and Properties_d has 'Microsoft.Powershell.DSC' | distinct TimeGenerated); Event | where EventID == '4104' and ParameterXml has 'Microsoft.Powershell.DSC' and RenderedDescription has '.ps1' | where (TimeGenerated - timeframe) <= 1m` |\n| Log Analytics | `#!sql AzureActivity | where OperationNameValue == 'MICROSOFT.COMPUTE/VIRTUALMACHINES/EXTENSIONS/WRITE' and Properties_d has 'Microsoft.Powershell.DSC'`\n\t\t\t\n## **Azure Monitor Alert**\n\nFor resources *with* Azure Monitor Agent installed\n\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FExecution%2FAZT301%2FAZT301-3-AMA.json)\n\nFor resources *without* Azure Monitor Agent installed\n\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FExecution%2FAZT301%2FAZT301-3.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\t[`#!powershell Set-AzVMDscExtension`](https://docs.microsoft.com/en-us/powershell/module/az.compute/set-azvmdscextension?view=azps-8.0.0)\n\n=== \"Azure CLI\"\n    [`#!powershell az vm extension set`](https://docs.microsoft.com/en-us/cli/azure/vm/extension?view=azure-cli-latest#az-vm-extension-set)\n\t\n=== \"Azure REST API\"\t\n\t[`#!powershell PUT https://management.azure.com/subscriptions/{subscription-id}/resourceGroups/{rg name}/providers/Microsoft.Compute/virtualMachines/{vm name]/extensions/DSC?api-version=2022-03-01`](https://docs.microsoft.com/en-us/rest/api/compute/virtual-machine-extensions/create-or-update)\n\n=== \"Azure Portal\"\n\t![dsc](dsc.PNG)"
            ],
            "x_atrm_resources": [
                "Virtual Machine",
                "Virtual Machine Scale Sets"
            ],
            "x_mitre_brief": "By utilizing the 'Desired State Configuration extension' extension on a Virtual Machine, an attacker can pass PowerShell commands to the VM as SYSTEM.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--3aff39b8-2ccb-488f-8f87-9cb48c4256ca",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:16:53.000Z",
            "name": "Serial Console",
            "description": "By utilizing the serial console feature on an Azure Virtual Machine, an adversary can pass arbitrary commands.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "execution"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Execution/AZT301/AZT301-7",
                    "external_id": "AZT301.007"
                }
            ],
            "x_atrm_actions": [
                "## **Detection Details**",
                "",
                "Commands are passed directly via COM1 port to the virtual machine. Logging requires [boot diagnostics to be enabled.](https://docs.microsoft.com/en-us/troubleshoot/azure/virtual-machines/serial-console-windows#audit-logs)",
                "",
                "## **Logs**",
                "",
                "| Data Source        | Operation Name      | Action                                                            | Log Location |",
                "|--------------------|---------------------|-------------------------------------------------------------------|--------------|",
                "| Resource           | N/A\t | N/A\t| Boot Diagnostics |"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                ""
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "* [https://docs.microsoft.com/en-us/troubleshoot/azure/virtual-machines/serial-console-overview](https://docs.microsoft.com/en-us/troubleshoot/azure/virtual-machines/serial-console-overview)"
            ],
            "x_atrm_resources": [
                "=== \"Azure Portal\"",
                "",
                "![SerialConsole](SerialConsole.png)"
            ],
            "x_mitre_brief": "By utilizing the serial console feature on an Azure Virtual Machine, an adversary can pass arbitrary commands.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--e543b6cd-c1c0-40df-99a5-3ab28690d06b",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:27:03.000Z",
            "name": "Vmss Run Command",
            "description": "By utilizing the 'RunCommand' feature on a virtual machine scale set (Vmss), an attacker can execute a command on an instance or instances of VMs as:\n- Windows: PowerShell commands to the VM as SYSTEM.\n- Linux: Shell commands to the VM as root.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "execution"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Execution/AZT301/AZT301-6",
                    "external_id": "AZT301.006"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/virtual-machines/windows/run-command"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/virtual-machines/linux/run-command"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Compute/virtualMachineScaleSets/virtualMachines/runCommand/action"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Detection Details**\n\n* **Windows**: The commands are stored as .PS1 files. \n* **Linux**: The commands are stored as script.sh files. \n\n## **Logs** \n\n| Data Source        | Operation Name      | Action/On-Disk Location                                                             | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource           | Run Command on a Virtual Machine instance in a Virtual Machine Scale Set\t | Microsoft.Compute/virtualMachineScaleSets/virtualMachines/runCommand/action\t| AzureActivity |\n| On-Resource File (Windows)  | File Creation       | C:\\Packages\\Plugins\\Microsoft.CPlat.Core.RunCommandWindows\\1.1.11\\Downloads | Event |          \n| On-Resource File (Windows)  | File Creation       | C:\\Packages\\Plugins\\Microsoft.CPlat.Core.RunCommandWindows\\1.1.11\\Status    | Event |\n| On-Resource File (Linux)    | File Creation       | /var/lib/waagent/run-command/download/ | syslog |\n| On-Resource File (Linux)    | File Creation       | /var/lib/waagent/Microsoft.CPlat.Core.RunCommandLinux-1.0.3/status/ | syslog |\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AzureActivity | where OperationNameValue=='Microsoft.Compute/virtualMachineScaleSets/virtualMachines/runCommand/action'`|\n\n## **Azure Monitor Alert**\n\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FExecution%2FAZT301%2FAZT301-6.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\n    [`#!powershell Invoke-AzVmssVMRunCommand`](https://docs.microsoft.com/en-us/powershell/module/az.compute/invoke-azvmssvmruncommand?view=azps-8.0.0)\n\t\n=== \"Azure CLI\"\n\n    [`#!powershell az vmss run-command`](https://docs.microsoft.com/en-us/cli/azure/vmss/run-command?view=azure-cli-latest)\n\t\n=== \"Azure REST API\"\t\n\t[`#!powershell PATCH https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Compute/virtualMachineScaleSets/{vmScaleSetName}/virtualMachines/{instanceId}/runCommands/{runCommandName}?api-version=2022-03-01`](https://docs.microsoft.com/en-us/rest/api/compute/virtual-machine-scale-set-vm-run-commands/update)"
            ],
            "x_atrm_resources": [
                "Virtual Machine Scale Sets"
            ],
            "x_mitre_brief": "By utilizing the 'RunCommand' feature on a virtual machine scale set (vmss), an attacker can execute a command on an instance of a VM as SYSTEM.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--be59a4c2-c00b-49ee-940e-ea26be61bafa",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:33:04.000Z",
            "name": "CustomScriptExtension",
            "description": "By utilizing the 'CustomScriptExtension' extension on a Virtual Machine, an attacker can pass PowerShell commands to the VM as SYSTEM.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "execution"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Execution/AZT301/AZT301-2",
                    "external_id": "AZT301.002"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/virtual-machines/extensions/custom-script-windows"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/virtual-machines/extensions/custom-script-linux"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Compute/virtualMachines/extensions/*",
                "Microsoft.Compute/virtualMachines/write"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Detection Details**\n\nThe commands are stored as .PS1 files and deleted after running.\n\n## **Logs** \n\n| Data Source        | Operation Name     | Action/On-Disk Location                                             | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource  | Create or Update Virtual Machine Extension\t | Microsoft.Compute/virtualMachines/extensions/write | AzureActivity |\n| On-Resource File    | File Creation       | C:\\Packages\\Plugins\\Microsoft.Compute.CustomScriptExtension\\1.9.5\\Downloads | Event |\n| On-Resource File    | File Creation       | C:\\Packages\\Plugins\\Microsoft.Compute.CustomScriptExtension\\1.9.5\\Status | Event |\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql let timeframe = toscalar(AzureActivity | where OperationNameValue == 'MICROSOFT.COMPUTE/VIRTUALMACHINES/EXTENSIONS/WRITE' and Properties has 'CustomScriptExtension' | distinct TimeGenerated); Event | where EventID  == '4104' | where (timeframe - TimeGenerated) <= 1m` |\n| Log Analytics | `#!sql AzureActivity | where OperationNameValue == 'MICROSOFT.COMPUTE/VIRTUALMACHINES/EXTENSIONS/WRITE' and Properties has 'CustomScriptExtension'`\n\t\n## **Azure Monitor Alert**\n\nFor resources *with* Azure Monitor Agent installed\n\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FExecution%2FAZT301%2FAZT301-2-AMA.json)\n\nFor resources *without* Azure Monitor Agent installed\n\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FExecution%2FAZT301%2FAZT301-2.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\t[`#!powershell Set-AzVMCustomScriptExtension`](https://docs.microsoft.com/en-us/powershell/module/az.compute/set-azvmcustomscriptextension?view=azps-8.0.0)\n\t\n=== \"Azure CLI\"\n    [`#!powershell az vm extension set`](https://docs.microsoft.com/en-us/cli/azure/vm/extension?view=azure-cli-latest#az-vm-extension-set)\n\t\n=== \"Azure REST API\"\t\n\t[`#!powershell PUT https://management.azure.com/subscriptions/{subscription-id}/resourceGroups/{rg name}/providers/Microsoft.Compute/virtualMachines/{vm name]/extensions/CustomScriptExtension?api-version=2022-03-01`](https://docs.microsoft.com/en-us/rest/api/compute/virtual-machine-extensions/create-or-update)\n\n=== \"Azure Portal\"\n\t![cse](CSE.PNG)"
            ],
            "x_atrm_resources": [
                "Virtual Machine",
                "Virtual Machine Scale Sets",
                "Azure ARC"
            ],
            "x_mitre_brief": "By utilizing the 'CustomScriptExtension' extension on a Virtual Machine, an attacker can pass PowerShell commands to the VM as SYSTEM.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--8586f122-4c0f-4571-88ac-c7b6cc2593cd",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2024-02-04T22:12:32.000Z",
            "name": "Automation Account Runbook RunAs Account",
            "description": "By utilizing an Automation Account configured with a RunAs account, an attacker can execute commands on an Azure VM via RunCommand if that service principal has the correct role and privileges.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "execution"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Execution/AZT302/AZT302-2",
                    "external_id": "AZT302.002"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/automation/automation-runbook-execution"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Automation/automationAccounts/runbooks/*"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Detection Details**\n\nNote that the listed query requires Azure Diagnostics turned on for the resource.\n\n## **Logs** \n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource | Create an Azure Automation job\t | Microsoft.Automation/automationAccounts/jobs/write\t| AzureActivity  |\n| Resource | Publish an Azure Automation runbook draft\t | Microsoft.Automation/automationAccounts/runbooks/publish/action\t| AzureActivity  |\n| Resource | Write an Azure Automation runbook draft\t | Microsoft.Automation/automationAccounts/runbooks/draft/write\t| AzureActivity  |\n| Resource | Create or Update an Azure Automation Runbook\t | Microsoft.Automation/automationAccounts/runbooks/write\t| AzureActivity  |\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AzureDiagnostics | where ResultDescription has 'TenantId' and ResultDescription has 'SubscriptionName' and ResultDescription has 'Account' and ResourceType == 'AUTOMATIONACCOUNTS'`|\n\n## **Azure Monitor Alert**\n\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FExecution%2FAZT301%2FAZT302-2.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\t[`#!powershell New-AzAutomationRunbook`](https://docs.microsoft.com/en-us/powershell/module/az.automation/new-azautomationrunbook?view=azps-8.0.0)\n\t\n=== \"Azure CLI\"\n\t[`#!python az automation runbook create`](https://docs.microsoft.com/en-us/cli/azure/automation/runbook?view=azure-cli-latest#az-automation-runbook-create)\n\t\n=== \"Azure REST API\"\t\n\t[`#!powershell PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Automation/automationAccounts/{automationAccountName}/runbooks/{runbookName}?api-version=2019-06-01`](https://docs.microsoft.com/en-us/rest/api/automation/runbook/create-or-update)\t\t\n\n=== \"Azure Portal\"\n\t![runbook](runbook.PNG)"
            ],
            "x_atrm_resources": [
                "Automation Account"
            ],
            "x_mitre_brief": "By utilizing an Automation Account configured with a RunAs account, an attacker can execute commands on an Azure VM via RunCommand if that service principal has the correct role and privileges.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--eade80d2-e1ce-434f-827a-8324412c4ced",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:27:03.000Z",
            "name": "Automation Account Runbook Managed Identity",
            "description": "By utilizing an Automation Account configured with a Managed Identity, an attacker can execute commands on an Azure VM via RunCommand if that service principal has the correct role and privileges.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "execution"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Execution/AZT302/AZT302-3",
                    "external_id": "AZT302.003"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/automation/automation-runbook-execution"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Automation/automationAccounts/runbooks/*"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Detection Details**\n\nNote that the listed query requires Azure Diagnostics turned on for the resource.\n\n## **Logs** \n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource | Create an Azure Automation job\t | Microsoft.Automation/automationAccounts/jobs/write\t| AzureActivity |\n| Resource | Publish an Azure Automation runbook draft\t | Microsoft.Automation/automationAccounts/runbooks/publish/action\t| AzureActivity |\n| Resource | Write an Azure Automation runbook draft\t | Microsoft.Automation/automationAccounts/runbooks/draft/write\t| AzureActivity  |\n| Resource | Create or Update an Azure Automation Runbook\t | Microsoft.Automation/automationAccounts/runbooks/write\t| AzureActivity  |\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql \n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AzureDiagnostics | where ResultDescription has 'TenantId' and ResultDescription has 'SubscriptionName' and ResultDescription has 'Account' and ResourceType == 'AUTOMATIONACCOUNTS'`|\n`|\n\n## **Azure Monitor Alert**\n\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FExecution%2FAZT301%2FAZT302-3.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\t[`#!powershell New-AzAutomationRunbook`](https://docs.microsoft.com/en-us/powershell/module/az.automation/new-azautomationrunbook?view=azps-8.0.0)\n\t\n=== \"Azure CLI\"\n\t[`#!python az automation runbook create`](https://docs.microsoft.com/en-us/cli/azure/automation/runbook?view=azure-cli-latest#az-automation-runbook-create)\n\t\n=== \"Azure REST API\"\t\n\t[`#!powershell PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Automation/automationAccounts/{automationAccountName}/runbooks/{runbookName}?api-version=2019-06-01`](https://docs.microsoft.com/en-us/rest/api/automation/runbook/create-or-update)\t\t\n\n=== \"Azure Portal\"\n\t![runbook](runbook.PNG)"
            ],
            "x_atrm_resources": [
                "Automation Account"
            ],
            "x_mitre_brief": "By utilizing an Automation Account configured with a Managed Identity, an attacker can execute commands on an Azure VM via RunCommand if that service principal has the correct role and privileges.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--7bb9d8a8-3e9a-4551-ad1b-f3f7ee275bb0",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2022-07-29T18:07:09.000Z",
            "name": "Serverless Scripting",
            "description": "Adversaries may abuse access to serverless resources that are able to execute PowerShell or Python scripts on an Azure resource.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "execution"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Execution/AZT302/AZT302",
                    "external_id": "AZT302"
                }
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_brief": "Adversaries may abuse access to serverless resources that are able to execute PowerShell or Python scripts on an Azure Resource.",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--5f6ea055-96ca-4d3e-ba7a-eb7952a33b1f",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:16:53.000Z",
            "name": "Function Application",
            "description": "By utilizing a Function Application, an attacker can execute Azure operations on a given resource.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "execution"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Execution/AZT302/AZT302-4",
                    "external_id": "AZT302.004"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/azure-functions/functions-get-started?pivots=programming-language-powershell"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Web/sites/hostruntime/vfs/run.csx/write",
                "Microsoft.Web/sites/functions/write",
                "Microsoft.Web/sites/write"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource | Write Run.csx\t | Microsoft.Web/sites/hostruntime/vfs/run.csx/write\t| AzureActivity  |\n| Resource | Update Web Apps Functions\t | Microsoft.Web/sites/functions/write\t| AzureActivity  |\n| Resource | Update website\t | Microsoft.Web/sites/write\t| AzureActivity  |"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\t[`#!powershell Update-AzFunctionApp`](https://docs.microsoft.com/en-us/powershell/module/az.functions/update-azfunctionapp?view=azps-8.0.0)\n\t\n=== \"Azure CLI\"\n    [`#!powershell az functionapp update`](https://docs.microsoft.com/en-us/cli/azure/functionapp?view=azure-cli-latest#az-functionapp-update)\n\t\n=== \"Azure REST API\"\t\n\t[`#!powershell GET https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Web/sites/{name}/functions?api-version=2021-02-01`](https://docs.microsoft.com/en-us/rest/api/appservice/web-apps/list-functions)\n\n=== \"Azure Portal\"\n\t![functionapp](functionapp.PNG)"
            ],
            "x_atrm_resources": [
                "Automation Account"
            ],
            "x_mitre_brief": "By utilizing a Function Application, an attacker can execute Azure operations on a given resource.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--24b45623-3ddc-496b-bafa-f32127dc83c8",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:33:04.000Z",
            "name": "Automation Account Runbook Hybrid Worker Group",
            "description": "By utilizing an Automation Account configured with a Hybrid Worker Group, an attacker can execute Azure commands on any Azure VM within that Hybrid Worker Group.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "execution"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Execution/AZT302/AZT302-1",
                    "external_id": "AZT302.001"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/automation/automation-runbook-execution"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Automation/automationAccounts/runbooks/draft/write",
                "Microsoft.Automation/automationAccounts/runbooks/write",
                "Microsoft.Automation/automationAccounts/runbooks/publish/action",
                "Microsoft.Automation/automationAccounts/jobs/write"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Detection Details**\n\nIt is recommended to [turn on verbose logging](https://docs.microsoft.com/en-us/system-center/sma/overview-runbook-messages-output?view=sc-sma-2022) for Automation Accounts. Note that the listed query requires Azure Diagnostics turned on for the resource.\n\n## **Logs** \n\n| Data Source        | Operation Name     | Action/On-Disk Location                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource | Create an Azure Automation job\t | Microsoft.Automation/automationAccounts/jobs/write\t| AzureActivity  |\n| Resource | Publish an Azure Automation runbook draft\t | Microsoft.Automation/automationAccounts/runbooks/publish/action\t| AzureActivity  |\n| Resource | Write an Azure Automation runbook draft\t | Microsoft.Automation/automationAccounts/runbooks/draft/write\t| AzureActivity  |\n| Resource | Create or Update an Azure Automation Runbook\t | Microsoft.Automation/automationAccounts/runbooks/write\t| AzureActivity  |\n| On Target Resource File (Windows) | File Creation       | C:\\Packages\\Plugins\\Microsoft.Azure.Automation.HybridWorker.HybridWorkerForWindows\\0.1.0.18\\Status | Event |\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AzureDiagnostics | where ResourceType == 'AUTOMATIONACCOUNTS' and RunOn_s != ''`|\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FExecution%2FAZT301%2FAZT302-1.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\t[`#!powershell New-AzAutomationRunbook`](https://docs.microsoft.com/en-us/powershell/module/az.automation/new-azautomationrunbook?view=azps-8.0.0)\n\t\n=== \"Azure CLI\"\n    [`#!powershell az automation runbook create`](https://docs.microsoft.com/en-us/cli/azure/automation/runbook?view=azure-cli-latest#az-automation-runbook-create)\n\t\n=== \"Azure REST API\"\t\n\t[`#!powershell PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Automation/automationAccounts/{automationAccountName}/runbooks/{runbookName}?api-version=2019-06-01`](https://docs.microsoft.com/en-us/rest/api/automation/runbook/create-or-update)\n\n=== \"Azure Portal\"\n\t![runbook](runbook.PNG)"
            ],
            "x_atrm_resources": [
                "Automation Account"
            ],
            "x_mitre_brief": "By utilizing an Automation Account configured with a Hybrid Worker Group, an attacker can execute Azure commands on any Azure VM within that Hybrid Worker Group.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--5ff11929-204c-4a06-89e7-6c13cd0b8023",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:16:53.000Z",
            "name": "Managed Device Scripting",
            "description": "Adversaries may abuse access to any managed devices in AzureAD by executing PowerShell or Python scripts on them.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "execution"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Execution/AZT303/AZT303",
                    "external_id": "AZT303"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/mem/intune/apps/intune-management-extension"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/graph/api/resources/intune-graph-overview?view=graph-rest-beta"
                }
            ],
            "x_atrm_actions": [
                "microsoft.directory/devices/basic/update"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Intune |  | \t| IntuneAuditLogs |\n| Intune | \t | \t| IntuneAuditLogs |\n| Intune |  | \t| IntuneAuditLogs |"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Microsoft Azure Graph API\"\t\n\t[`#!powershell POST https://graph.microsoft.com/beta/deviceManagement/deviceManagementScripts`](https://docs.microsoft.com/en-us/graph/api/intune-shared-devicemanagementscript-create?view=graph-rest-beta)\n\n=== \"Azure Portal\"\n\t![intune](intune.PNG)"
            ],
            "x_atrm_resources": [
                "Azure Active Directory Intune"
            ],
            "x_mitre_brief": "Adversaries may abuse access to any managed devices in AzureAD by executing PowerShell or Python scripts on them.",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--9bdeb3ed-3192-4c25-b7ee-e0e7b2400545",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:16:53.000Z",
            "name": "Privileged Identity Management Role",
            "description": "An adversary may escalate their privileges if their current account is eligible for role activation via Privileged Identity Management (PIM).",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "privilege-escalation"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/PrivilegeEscalation/AZT401/AZT401",
                    "external_id": "AZT401"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/active-directory/privileged-identity-management/pim-configure"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/active-directory/privileged-identity-management/powershell-for-azure-ad-roles"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/active-directory/privileged-identity-management/pim-apis"
                }
            ],
            "x_atrm_actions": [
                "RoleManagement.ReadWrite.Directory",
                "RoleManagement.Read.Directory"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs**\n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Azure Active Directory | Add member to role requested (PIM activation)\t | RoleManagement.ReadWrite.Directory\t| PIM Audit Logs |\n| Azure Active Directory | Add member to role completed (PIM activation)\t | RoleManagement.ReadWrite.Directory\t| PIM Audit Logs  |\n| Azure Active Directory | Add eligible member to role in PIM completed (permanent)\t| RoleManagement.ReadWrite.Directory| PIM Audit Logs  |\n| Azure Active Directory | Add eligible member to role in PIM requested (permanent)\t| RoleManagement.ReadWrite.Directory\t| PIM Audit Logs  |\n\n## **Detection Screenshots**\n\n![directorylogs](directorylogs.PNG)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"AzureAD PowerShell\"\n\t[`#!powershell Open-AzureADMSPrivilegedRoleAssignmentRequest`](https://docs.microsoft.com/en-us/powershell/module/azuread/open-azureadmsprivilegedroleassignmentrequest?view=azureadps-2.0-preview)\n\n=== \"Microsoft Azure Graph API\"\t\n\t[`#!powershell GET https://graph.microsoft.com/beta/roleManagement/directory/roleEligibilitySchedules/313af44a-07c9-43a7-9970-5072a6b5591f`](https://docs.microsoft.com/en-us/graph/api/unifiedroleeligibilityschedule-get?view=graph-rest-beta&tabs=http)\n\n=== \"Azure REST API\"\t\n\t[`#!powershell GET https://management.azure.com/{scope}/providers/Microsoft.Authorization/roleEligibilityScheduleRequests/{roleEligibilityScheduleRequestName}?api-version=2020-10-01`](https://docs.microsoft.com/en-us/rest/api/authorization/role-eligibility-schedule-requests/get)\n\n=== \"Azure Portal\"\n\t![pimactivate](pimactivate.PNG)"
            ],
            "x_atrm_resources": [
                "Azure Active Directory",
                "Azure Resources"
            ],
            "x_mitre_brief": "An adversary may escalate their privileges if their current account has access to Privileged Identity Management (PIM)",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--a97fb0c4-2ae4-4f50-b96c-8007f652ffd9",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:16:53.000Z",
            "name": "App Service",
            "description": "By utilizing an App Service configured with a managed identity or other identity provider, an attacker can execute Azure operations on a given resource.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "privilege-escalation"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/PrivilegeEscalation/AZT404/AZT404-4",
                    "external_id": "AZT404.004"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/app-service/overview-managed-identity?tabs=portal%2Chttp"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Web/sites/write"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource | Update website\t | Microsoft.Web/sites/write\t| AzureActivity |\n| Resource | Start Web App | Microsoft.Web/sites/start/action\t| AzureActivity |"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\t[`#!powershell Update-AzStaticWebApp`](https://docs.microsoft.com/en-us/powershell/module/az.websites/update-azstaticwebapp?view=azps-8.0.0)\n\t\n=== \"Azure CLI\"\n\t[`#!python az staticwebapp update`](https://docs.microsoft.com/en-us/cli/azure/staticwebapp?view=azure-cli-latest#az-staticwebapp-update)\n\t\n=== \"Azure REST API\"\t\n\t[`#!powershell PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Web/sites/{name}?api-version=2021-02-01`](https://docs.microsoft.com/en-us/rest/api/appservice/web-apps/create-or-update)\t\t\n\n=== \"Azure Portal\"\n\t![appservice](appservice.PNG)"
            ],
            "x_atrm_resources": [
                "App Service"
            ],
            "x_mitre_brief": "By utilizing an App Service configured with a managed identity or other identity provider, an attacker can execute Azure operations on a given resource.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--5c07480f-949b-4459-aba1-a272193b5b26",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2022-07-29T18:07:09.000Z",
            "name": "Principal Impersonation",
            "description": "Adversaries may abuse resources that are configured with a service principal or other identity to further their access to the current or other resources.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "privilege-escalation"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/PrivilegeEscalation/AZT404/AZT404",
                    "external_id": "AZT404"
                }
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_brief": "Adversaries may abuse resources that are configured with a service principal or other identity to further their access to the current or other resources.",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--2c98c491-2985-4991-b9db-a1c1e7615994",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:27:03.000Z",
            "name": "Function Application",
            "description": "By utilizing a Function Application configured with a managed identity or other identity provider, an attacker can execute Azure operations on a given resource.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "privilege-escalation"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/PrivilegeEscalation/AZT404/AZT404-1",
                    "external_id": "AZT404.001"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/app-service/overview-managed-identity?tabs=ps%2Cdotnet"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Web/sites/hostruntime/vfs/run.csx/write",
                "Microsoft.Web/sites/functions/write",
                "Microsoft.Web/sites/write"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource | Write Run.csx\t | Microsoft.Web/sites/hostruntime/vfs/run.csx/write\t|  AzureActivity |\n| Resource | Update Web Apps Functions\t | Microsoft.Web/sites/functions/write\t|  AzureActivity |\n| Resource | Update website\t | Microsoft.Web/sites/write\t| AzureActivity |\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql let appname = toscalar(FunctionAppLogs | where Type == 'FunctionAppLogs' and Message has 'Executed' | project split(_ResourceId, '/')[-1]); AADManagedIdentitySignInLogs | where ServicePrincipalName contains appname` |\t\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FPrivilegeEscalation%2FAZT404%2FAZT404-1.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\t[`#!powershell Update-AzFunctionApp`](https://docs.microsoft.com/en-us/powershell/module/az.functions/update-azfunctionapp?view=azps-8.0.0)\n\n=== \"Azure CLI\"\n\t[`#!python az functionapp update`](https://docs.microsoft.com/en-us/cli/azure/functionapp?view=azure-cli-latest#az-functionapp-update)\n\t\n=== \"Azure REST API\"\t\n\t[`#!powershell PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Web/sites/{name}?api-version=2021-02-01`](https://docs.microsoft.com/en-us/rest/api/appservice/web-apps/create-or-update)\t\t\n\n=== \"Azure Portal\"\n\t![functionapp](functionappmi.png)"
            ],
            "x_atrm_resources": [
                "Function Application"
            ],
            "x_mitre_brief": "By utilizing a Function Application configured with a managed identity or other identity provider, an attacker can execute Azure operations on a given resource.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--70f889b3-cd41-4177-8bff-d22691d4602e",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:16:53.000Z",
            "name": "Logic Application",
            "description": "By utilizing a Logic Application configured with a managed identity or other identity provider, an attacker can execute Azure operations on a given resource.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "privilege-escalation"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/PrivilegeEscalation/AZT404/AZT404-2",
                    "external_id": "AZT404.002"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/logic-apps/logic-apps-overview"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Logic/workflows/write",
                "Microsoft.Logic/workflows/run/action",
                "Microsoft.Logic/operations/read"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource | Gets workflow recommend operation groups\t | Microsoft.Logic/locations/workflows/recommendOperationGroups/action\t| AzureActivity |\n| Resource | List Trigger Callback URL | Microsoft.Logic/workflows/triggers/listCallbackUrl/action\t| AzureActivity |\n| Resource | Add or Update Connection\t| Microsoft.Web/connections/write\t|  AzureActivity |\n| Azure Active Directory | Update website\t | Microsoft.Web/sites/write\t|  AuditLogs |\n| Azure Active Directory | Start Web App | Microsoft.Web/sites/start/action\t|  AuditLogs |"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\t[`#!powershell Set-AzLogicApp`](https://docs.microsoft.com/en-us/powershell/module/az.logicapp/set-azlogicapp?view=azps-8.0.0)\n\n=== \"Azure CLI\"\n\t[`#!python az logicapp start`](https://docs.microsoft.com/en-us/cli/azure/logicapp?view=azure-cli-latest#az-logicapp-start)\n\t\n=== \"Azure REST API\"\t\n\t[`#!powershell PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Logic/workflows/{workflowName}?api-version=2016-06-01`](https://docs.microsoft.com/en-us/rest/api/logic/workflows/create-or-update)\t\t\n\n=== \"Azure Portal\"\n\t![logicapp](logciappimds.PNG)"
            ],
            "x_atrm_resources": [
                "Logic Application"
            ],
            "x_mitre_brief": "By utilizing a Logic Application configured with a managed identity or other identity provider, an attacker can execute Azure operations on a given resource.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--d9210297-1194-4292-8416-7ab94dcc9a11",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:16:53.000Z",
            "name": "Automation Account",
            "description": "By utilizing a Function Application, an attacker can execute Azure operations on a given resource.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "privilege-escalation"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/PrivilegeEscalation/AZT404/AZT404-3",
                    "external_id": "AZT404.003"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/azure-functions/functions-get-started?pivots=programming-language-powershell"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Web/sites/hostruntime/vfs/run.csx/write",
                "Microsoft.Web/sites/functions/write",
                "Microsoft.Web/sites/write"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource | Write Run.csx\t | Microsoft.Web/sites/hostruntime/vfs/run.csx/write\t| AzureActivity |\n| Resource | Update Web Apps Functions\t | Microsoft.Web/sites/functions/write\t| AzureActivity |\n| Resource | Update website\t | Microsoft.Web/sites/write\t| AzureActivity |"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\t[`#!powershell Update-AzFunctionApp`](https://docs.microsoft.com/en-us/powershell/module/az.functions/update-azfunctionapp?view=azps-8.0.0)\n\t\n=== \"Azure CLI\"\n    [`#!powershell az functionapp update`](https://docs.microsoft.com/en-us/cli/azure/functionapp?view=azure-cli-latest#az-functionapp-update)\n\t\n=== \"Azure REST API\"\t\n\t[`#!powershell GET https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Web/sites/{name}/functions?api-version=2021-02-01`](https://docs.microsoft.com/en-us/rest/api/appservice/web-apps/list-functions)\n\n=== \"Azure Portal\"\n\t![functionapp](functionapp.PNG)"
            ],
            "x_atrm_resources": [
                "Automation Account"
            ],
            "x_mitre_brief": "By utilizing a Automation Account configured with a managed identity or RunAs account, an attacker can execute Azure operations on a given resource.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--6155cdf2-448c-4dc9-a679-2b7118182723",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:27:03.000Z",
            "name": "Cloud Shell .IMG",
            "description": "By modifying the .bashrc file in a CloudShell .IMG file, an adversary may escalate their privileges by injecting commands that will add an arbitrary user account to a desired role and scope.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "privilege-escalation"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/PrivilegeEscalation/AZT403/AZT403-1",
                    "external_id": "AZT403.001"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/cloud-shell/overview"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://www.netspi.com/blog/technical/cloud-penetration-testing/attacking-azure-cloud-shell/"
                }
            ],
            "x_atrm_detections": [
                "## **Detection Details**\n\nA storage account is created in order to store the profile .IMG file when using CloudShell. These storage accounts always start with `cs` followed by a string of numbers + letters. E.g.: `cs120000000ff`\nLogs from the storage account require them to be configured with diagnostic settings being sent to a log aggregator. \n\nAdditionally, `~/.config/PowerShell/Microsoft.PowerShell_profile.ps1` is where the PowerShell startup script is stored, which also may be a target for backdooring. \n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql ` |\t\n\t\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FPrivilegeEscalation%2FAZT403%2FAZT403-1.json)"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_examples": [
                "=== \"Azure Portal\"\n\t![cloudshell](cloudshell.PNG)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_resources": [
                "Azure CloudShell"
            ],
            "x_mitre_brief": "By modifying the .bashrc file in a CloudShell .IMG file, an adversary may escalate their privileges",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--b22a37d2-1268-4139-b012-ec10fc8ca488",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-02-04T23:05:59.000Z",
            "modified": "2024-02-04T23:05:59.000Z",
            "name": "Local Resource Hijack",
            "description": "An adversary may escalate their privileges by tampering with a local file generated by a resource.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "privilege-escalation"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/PrivilegeEscalation/AZT403/AZT403",
                    "external_id": "AZT403"
                }
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_brief": "An adversary may escalate their privileges by tampering with a local file generated by a resource",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--777a1101-c222-4156-90a4-e311545db001",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:33:04.000Z",
            "name": "Elevated Access Toggle",
            "description": "An adversary may escalate their privileges from Azure AD to all Azure subscriptions in the tenant if they are a global administrator",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "privilege-escalation"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/PrivilegeEscalation/AZT402/AZT402",
                    "external_id": "AZT402"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/role-based-access-control/elevate-access-global-admin"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Authorization/elevateAccess/action"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Azure Active Directory | Assigns the caller to User Access Administrator role\t | Microsoft.Authorization/elevateAccess/action | AuditLogs |\n\n## **Detection Screenshots**\n\n![monitorlogs](monitor-directory-activity.png)\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AuditLogs | where ActivityDisplayName == 'Assigns the caller to User Access Administrator role'` |\t\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FPrivilegeEscalation%2FAZT402%2FAZT402.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Azure CLI\"\n\t[`#!python az rest --method post --url \"/providers/Microsoft.Authorization/elevateAccess?api-version=2016-07-01\"`](https://docs.microsoft.com/en-us/azure/role-based-access-control/elevate-access-global-admin#azure-cli)\n\t\n=== \"Azure REST API\"\t\n\t[`#!powershell POST https://management.azure.com/providers/Microsoft.Authorization/elevateAccess?api-version=2016-07-01`](https://docs.microsoft.com/en-us/azure/role-based-access-control/elevate-access-global-admin#rest-api)\t\t\n\n=== \"Azure Portal\"\n\t![toggle](toggle.png)"
            ],
            "x_atrm_resources": [
                "Azure Active Directory"
            ],
            "x_mitre_brief": "An adversary may escalate their privileges from Azure AD to all Azure subscriptions in the tenant if they are a global administrator",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--3830bfda-b828-4504-b0d0-8d3e9f65faf6",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:27:03.000Z",
            "name": "Application API Permissions",
            "description": "By compromising a user, user in a group, or service principal that has an application role over an application, they may be able to escalate their privileges by impersonating the associated service principal and leveraging any privileged assigned application role.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "privilege-escalation"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/PrivilegeEscalation/AZT405/AZT405-1",
                    "external_id": "AZT405.001"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/graph/migrate-azure-ad-graph-configure-permissions"
                }
            ],
            "x_atrm_actions": [
                "Since the attacker controls the application, no actions are needed."
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Azure Active Directory | N/A\t | N/A\t| AADServicePrincipalSignInLogs|\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AADServicePrincipalSignInLogs | where ServicePrincipalId == 'IDGOESHERE'` |\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FPrivilegeEscalation%2FAZT405%2FAZT405-1.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Azure REST API\"\t\n\t[`#!powershell GET https://graph.microsoft.com/v1.0/servicePrincipals?$filter=appId eq '00000002-0000-0000-c000-000000000000'`](https://docs.microsoft.com/en-us/graph/migrate-azure-ad-graph-configure-permissions)\t\t\n\n=== \"Azure Portal\"\n\t![approle](approle.PNG)"
            ],
            "x_atrm_resources": [
                "Azure Active Directory"
            ],
            "x_mitre_brief": "By compromising a service principal whose application has privileged API permissions, an attacker can escalate their privileges to a higher privileged role.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--30e8a996-aaa6-46f7-932c-4eda49090356",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2022-07-29T18:07:09.000Z",
            "name": "Azure AD Application",
            "description": "Adversaries may abuse the assigned permissions on an Azure AD Application to escalate their privileges.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "privilege-escalation"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/PrivilegeEscalation/AZT405/AZT405",
                    "external_id": "AZT405"
                }
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_brief": "Adversaries may abuse the assigned permissions on an Azure AD Application to escalate their privileges.",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--8ad532cc-30be-44cd-823f-7deaf726c503",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:25:08.000Z",
            "name": "Application Registration Owner",
            "description": "By compromising an account who is an 'Owner' over an application that is configured with additional roles or API permissions, an attacker can escalate their privileges by adding a certificate or credentials & logging in as the service principal.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "privilege-escalation"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/PrivilegeEscalation/AZT405/AZT405-3",
                    "external_id": "AZT405.003"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/powershell/azure/create-azure-service-principal-azureps?view=azps-8.0.0#reset-credentials"
                }
            ],
            "x_atrm_actions": [
                "microsoft.directory/servicePrincipals/credentials/update"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name     | Category                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Azure AD           | Update application \u2013 Certificates and secrets management \t | ApplicationManagement\t| AuditLogs |\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AuditLogs | where OperationName == 'Update application \u2013 Certificates and secrets management' and Category== 'ApplicationManagement'` |\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FPrivilegeEscalation%2FAZT405%2FAZT405-3.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Azure PowerShell\"\n\t[`#!powershell New-AzADSpCredential -ServicePrincipalName ServicePrincipalName`](https://docs.microsoft.com/en-us/powershell/module/az.resources/new-azadspcredential?view=azps-8.0.0)\n\n=== \"az cli\"\n\t[`#!powershell az ad sp credential reset`](https://docs.microsoft.com/en-us/cli/azure/ad/sp/credential?view=azure-cli-latest#az-ad-sp-credential-reset)\n\n=== \"Azure REST API\"\t\n\t[`#!powershell POST /servicePrincipals/{id}/addKey`](https://docs.microsoft.com/en-us/graph/api/serviceprincipal-addkey?view=graph-rest-1.0&tabs=http)\t\t\n\n=== \"Azure Portal\"\n\t![AppOwner](appowner.png)"
            ],
            "x_atrm_resources": [
                "Azure Active Directory"
            ],
            "x_mitre_brief": "By compromising an account who is an 'Owner' over an application that is configured with additional roles or API permissions, an attacker can escalate their privileges by adding a certificate or credentials & logging in as the service principal.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--16c0a7fc-7252-4bf4-8ea6-7a60ea5cb966",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:27:03.000Z",
            "name": "Application Role",
            "description": "By compromising a service principal whose application has privileged API permissions, an attacker can escalate their privileges to a higher privileged role.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "privilege-escalation"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/PrivilegeEscalation/AZT405/AZT405-2",
                    "external_id": "AZT405.002"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/app-service/overview-managed-identity?tabs=portal%2Chttp"
                }
            ],
            "x_atrm_actions": [
                "Since the attacker controls the application, no actions are needed."
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Azure Active Directory | N/A\t | N/A\t| AADServicePrincipalSignInLogs|\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AADServicePrincipalSignInLogs | where ServicePrincipalId == 'IDGOESHERE'` |\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FPrivilegeEscalation%2FAZT405%2FAZT405-2.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Azure REST API\"\t\n\t[`#!powershell PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Web/sites/{name}?api-version=2021-02-01`](https://docs.microsoft.com/en-us/rest/api/appservice/web-apps/create-or-update)\t\t\n\n=== \"Azure Portal\"\n\t![APIPerm](APIPerm.PNG)"
            ],
            "x_atrm_resources": [
                "Azure Active Directory"
            ],
            "x_mitre_brief": "By compromising a user, user in a group, or service principal that has an application role over an application, they may be able to escalate their privileges by impersonating the associated service principal and leveraging any privileged assigned application role.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--61edac02-d1fa-44dd-8334-3df64bb65426",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:27:03.000Z",
            "name": "Runbook Webhook",
            "description": "Adversaries may create a webhook to a Runbook which allows unauthenticated access into an Azure subscription or tenant.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "persistence"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Persistence/AZT503/AZT503-3",
                    "external_id": "AZT503.003"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/automation/automation-webhooks?tabs=portal"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://www.netspi.com/blog/technical/cloud-penetration-testing/maintaining-azure-persistence-via-automation-accounts/"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Automation/automationAccounts/runbooks/*",
                "Microsoft.Automation/automationAccounts/webhooks/write"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource | Create or Update an Azure Automation webhook | Microsoft.Automation/automationAccounts/webhooks/write| AzureActivity |\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AzureActivity | where OperationNameValue == 'MICROSOFT.AUTOMATION/AUTOMATIONACCOUNTS/WEBHOOKS/WRITE'` |\t\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FPersistence%2FAZT503%2FAZT503-3.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\t[`#!powershell New-AzAutomationWebhook`](https://docs.microsoft.com/en-us/powershell/module/az.automation/new-azautomationwebhook?view=azps-8.0.0)\n\n=== \"Azure REST API\"\n\n\t[`#!python PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Automation/automationAccounts/{automationAccountName}/webhooks/{webhookName}?api-version=2015-10-31`](https://docs.microsoft.com/en-us/rest/api/automation/webhook/create-or-update)\t\n\n=== \"Azure Portal\"\n\t![webhook](webhook.PNG)"
            ],
            "x_atrm_resources": [
                "Automation Accounts"
            ],
            "x_mitre_brief": "Adversaries may create a webhook to a Runbook which allows unauthenticated access into an Azure subscription or tenant.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--2b1549dd-a09f-4a9b-88a4-2eff87268528",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:27:03.000Z",
            "name": "Function App HTTP Trigger",
            "description": "Adversaries may configure a Function Application with a user account or managed identity and modify the HTTP trigger to run a command via HTTP request.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "persistence"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Persistence/AZT503/AZT503-2",
                    "external_id": "AZT503.002"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/azure-functions/functions-overview"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Web/sites/Write",
                "Microsoft.web/sites/functions/action",
                "Microsoft.web/sites/functions/write"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Azure Active Directory | Update website\t | Microsoft.Web/sites/write\t|  AuditLogs |\n| Azure Active Directory | Start Web App | Microsoft.Web/sites/start/action\t|  AuditLogs |\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AuditLogs| where ActivityDisplayName == 'Update website' or ActivityDisplayName == 'Start Web App'` |\t\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FPersistence%2FAZT503%2FAZT503-2.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\n\t[`#!powershell Update-AzFunctionApp`](https://docs.microsoft.com/en-us/powershell/module/az.functions/update-azfunctionapp?view=azps-8.0.0)\n\t\n=== \"Azure CLI\"\n\n\t[`#!python az functionapp update`](https://docs.microsoft.com/en-us/cli/azure/functionapp?view=azure-cli-latest#az-functionapp-update)"
            ],
            "x_atrm_resources": [
                "Function App"
            ],
            "x_mitre_brief": "Adversaries may configure a Function Application with a user account or managed identity and modify the HTTP trigger to run a command via HTTP request.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--e20e7837-0dd2-45b6-8265-6835e7079ff5",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:27:03.000Z",
            "name": "Logic Application HTTP Trigger",
            "description": "Adversaries may configure a Logic Application with a user account or managed identity and modify the HTTP trigger to run a command via HTTP request.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "persistence"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Persistence/AZT503/AZT503-1",
                    "external_id": "AZT503.001"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/logic-apps/logic-apps-overview"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Logic/workflows/write",
                "Microsoft.Logic/workflows/run/action",
                "Microsoft.Logic/operations/read"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource | Gets workflow recommend operation groups\t | Microsoft.Logic/locations/workflows/recommendOperationGroups/action\t| AzureActivity |\n| Resource | List Trigger Callback URL | Microsoft.Logic/workflows/triggers/listCallbackUrl/action\t| AzureActivity |\n| Resource | Add or Update Connection\t| Microsoft.Web/connections/write\t| AzureActivity  |\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AzureActivity | where OperationNameValue=='Microsoft.Logic/locations/workflows/recommendOperationGroups/action' or OperationNameValue=='Microsoft.Logic/workflows/triggers/listCallbackUrl/action' or OperationNameValue=='Microsoft.Web/connections/write'` |\t\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FPersistence%2FAZT503%2FAZT503-1.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\n\t[`#!powershell Set-AzLogicApp`](https://docs.microsoft.com/en-us/powershell/module/az.logicapp/set-azlogicapp?view=azps-8.0.0)\n\t\n=== \"Azure CLI\"\n\n\t[`#!python az logicapp start`](https://docs.microsoft.com/en-us/cli/azure/logicapp?view=azure-cli-latest#az-logicapp-start)\t\n\n=== \"Azure REST API\"\n\n\t[`#!python PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Logic/workflows/{workflowName}?api-version=2016-06-01`](https://docs.microsoft.com/en-us/rest/api/logic/workflows/create-or-update)\t\n\n=== \"Azure Portal\"\n\t![logicapp1](logicapp1.png)\n\t![logicapp2](logicapp2.png)"
            ],
            "x_atrm_resources": [
                "Logic Application"
            ],
            "x_mitre_brief": "Adversaries may configure a Logic Application with a user account or managed identity and modify the HTTP trigger to run a command via HTTP request.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--b614e8d7-039e-4e99-a1a0-e3ef5ed0ca97",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2022-07-29T18:07:09.000Z",
            "name": "HTTP Trigger",
            "description": "Adversaries may configure a resource with an HTTP trigger to run commands without needing authentication.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "persistence"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Persistence/AZT503/AZT503",
                    "external_id": "AZT503"
                }
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_brief": "Adversaries may configure a resource with an HTTP trigger to run commands without needing authentication.",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--0f01367c-ef9c-438a-b096-448148677c72",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:27:03.000Z",
            "name": "WebJob",
            "description": "Adversaries may create a WebJob on a App Service which allows arbitrary background tasks to be run on a set schedule",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "persistence"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Persistence/AZT503/AZT503-4",
                    "external_id": "AZT503.004"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://github.com/Azure/azure-webjobs-sdk/wiki#documentation"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/app-service/webjobs-create"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Web/sites/Write"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Detection Details**\n\nTo enable logging on AppServices, a Diagnostic setting must be enabled to send logs to an aggregator. In addition, App Service Logs should be enabled.\n\nWebJob output logs can be viewed on the web application in the format: https://{WEBAPPNAME}.scm.azurewebsites.net/azurejobs/#/jobs/\n\n## **Detection Screenshot**\n\n=== \"Web Job Logs\"\n\t![webjoblog](webjoblog.PNG)\n\n=== \"Application Logs\"\n\t![applogs](applogs.PNG)\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql ` |\t\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FPersistence%2FAZT503%2FAZT503-4.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\t[`#!powershell Start-AzWebAppTriggeredWebJob`](https://docs.microsoft.com/ru-ru/powershell/module/az.websites/start-azwebapptriggeredwebjob?view=azps-8.0.0&viewFallbackFrom=azps-7.4.0)\n\n=== \"Azure CLI\"\n\n\t[`#!python az webapp webjob triggered`](https://docs.microsoft.com/en-us/cli/azure/webapp/webjob/triggered?view=azure-cli-latest)\n\n=== \"Azure REST API\"\n\n\t[`#!python PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Web/sites/{name}/triggeredwebjobs/{webJobName}/run?api-version=2021-02-01`](https://docs.microsoft.com/en-us/rest/api/appservice/web-apps/run-triggered-web-job)\t\n\n=== \"Azure Portal\"\n\t![webjob](webjob.PNG)"
            ],
            "x_atrm_resources": [
                "App Service"
            ],
            "x_mitre_brief": "Adversaries may create a WebJob on a App Service which allows arbitrary background tasks to be run on a set schedule",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--8cb8258c-b751-4b4d-92c2-ae4117ff41af",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:27:03.000Z",
            "name": "Watcher Tasks",
            "description": "By configurating a watcher task and a Runbook, an adversary can establish persistence by executing the Runbook on a triggered event.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "persistence"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Persistence/AZT504/AZT504",
                    "external_id": "AZT504"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/automation/automation-scenario-using-watcher-task"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Automation/automationAccounts/runbooks/*"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Detection Details**\n\nNo logs are generated when a watcher task is created.\n\n## **Logs** \n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource | Create an Azure Automation job\t | Microsoft.Automation/automationAccounts/jobs/write\t| AzureActivity |\n| Resource | Publish an Azure Automation runbook draft\t | Microsoft.Automation/automationAccounts/runbooks/publish/action\t| AzureActivity |\n| Resource | Write an Azure Automation runbook draft\t | Microsoft.Automation/automationAccounts/runbooks/draft/write\t| AzureActivity |\n| Resource | Create or Update an Azure Automation Runbook\t | Microsoft.Automation/automationAccounts/runbooks/write\t| AzureActivity |\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AzureActivity | where OperationNameValue == 'MICROSOFT.AUTOMATION/AUTOMATIONACCOUNTS/WATCHERS/WATCHERACTIONS/WRITE'` |\t\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FPersistence%2FAZT504%2FAZT504.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\t[`#!powershell New-AzAutomationWebhook`](https://docs.microsoft.com/en-us/powershell/module/az.automation/new-azautomationwebhook?view=azps-8.0.0)\n\n=== \"Azure REST API\"\n\n\t[`#!python PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Automation/automationAccounts/{automationAccountName}/webhooks/{webhookName}?api-version=2015-10-31`](https://docs.microsoft.com/en-us/rest/api/automation/webhook/create-or-update)\t\n\n=== \"Azure Portal\"\n\t![watcher](watcher.PNG)"
            ],
            "x_atrm_resources": [
                "Automation Account"
            ],
            "x_mitre_brief": "By configurating a watcher task and a Runbook, an adversary can establish persistence by executing the Runbook on a triggered event.",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--772716f5-4852-475a-a631-ae42348b007f",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-02-04T23:05:59.000Z",
            "modified": "2024-02-04T23:05:59.000Z",
            "name": "Scheduled Jobs",
            "description": "By configurating an Azure resource that supports scheduled execution, an adversary can execute an operation at a defined interval.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "persistence"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Persistence/AZT505/AZT505",
                    "external_id": "AZT505"
                }
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_brief": "By configurating an Azure resource that supports scheduled execution, an adversary can execute an operation at a defined interval.",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--5c447245-3556-4c3d-913b-b7cd74e28039",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:27:03.000Z",
            "name": "Scheduled Jobs",
            "description": "Adversaries may create a schedule for a Runbook to run at a defined interval.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "persistence"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Persistence/AZT505/AZT505-1",
                    "external_id": "AZT505.001"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/automation/shared-resources/schedules"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Automation/automationAccounts/Schedules/write"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource | Create or Update an Azure Automation schedule asset\t | Microsoft.Automation/automationAccounts/Schedules/write\t| AzureActivity |\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AzureActivity | where OperationNameValue == 'MICROSOFT.AUTOMATION/AUTOMATIONACCOUNTS/WATCHERS/WATCHERACTIONS/WRITE'` |\t\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FPersistence%2FAZT505%2FAZT505.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\t[`#!powershell New-AzAutomationSchedule`](https://docs.microsoft.com/en-us/powershell/module/Az.Automation/New-AzAutomationSchedule?view=azps-8.0.0)\n\n=== \"Azure REST API\"\n\n\t[`#!python PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Automation/automationAccounts/{automationAccountName}/jobSchedules/{jobScheduleId}?api-version=2019-06-01`](https://docs.microsoft.com/en-us/rest/api/automation/job-schedule)\t\n\n=== \"Azure Portal\"\n\t![runbookschedule](runbookschedule.PNG)"
            ],
            "x_atrm_resources": [
                "Automation Account"
            ],
            "x_mitre_brief": "Adversaries may create a schedule for a Runbook to run at a defined interval.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--0befda65-df42-4c80-a383-45c5d68ef9f0",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:27:03.000Z",
            "name": "Service Principal Creation",
            "description": "An adversary may create an application & service principal in Azure Active Directory",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "persistence"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Persistence/AZT502/AZT502-2",
                    "external_id": "AZT502.002"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/active-directory/develop/app-objects-and-service-principals"
                }
            ],
            "x_atrm_actions": [
                "microsoft.directory/servicePrincipals/create",
                "microsoft.directory/applications/create"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Azure Active Directory | Add service principal\t | microsoft.directory/servicePrincipals/create\t|  AuditLogs |\n| Azure Active Directory | Add application | microsoft.directory/applications/create\t| AuditLogs |\n| Azure Active Directory | Add owner to application | microsoft.directory/servicePrincipals/owners/update\t| AuditLogs |\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AuditLogs | where OperationName == 'Add service principal'` |\t\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FPersistence%2FAZT502%2FAZT502-2.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\n\t[`#!powershell New-AzADServicePrincipal`](https://docs.microsoft.com/en-us/powershell/module/az.resources/new-azadserviceprincipal?view=azps-8.0.0)\n\n=== \"Azure CLI\"\n\n\t[`#!python az ad sp create`](https://docs.microsoft.com/en-us/cli/azure/ad/sp?view=azure-cli-latest#az-ad-sp-create)\n\n=== \"Microsoft Graph API\"\n\n\t[`#!python POST https://graph.microsoft.com/v1.0/servicePrincipals`](https://docs.microsoft.com/en-us/graph/api/serviceprincipal-post-serviceprincipals?view=graph-rest-1.0&tabs=http)\t\n\n=== \"Azure Portal\"\n\n\t![newsp](newsp.PNG)"
            ],
            "x_atrm_resources": [
                "Azure Active Directory"
            ],
            "x_mitre_brief": "An adversary may create an application & service principal in Azure Active Directory",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--85398833-61eb-46d4-9c81-69ee89a3d136",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:27:03.000Z",
            "name": "Guest Account Creation",
            "description": "An adversary may create a guest account in Azure Active Directory",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "persistence"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Persistence/AZT502/AZT502-3",
                    "external_id": "AZT502.003"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/active-directory/external-identities/b2b-quickstart-add-guest-users-portal"
                }
            ],
            "x_atrm_actions": [
                "microsoft.directory/users/create",
                "microsoft.directory/users/inviteGuest"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Azure Active Directory | Invited Users | microsoft.directory/users/inviteGuest | AuditLogs |\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AuditLogs | where ActivityDisplayName == 'Invited Users'` |\t\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FPersistence%2FAZT502%2FAZT502-3.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Azure Portal\"\n\n\t![newuser](https://docs.microsoft.com/en-us/azure/active-directory/external-identities/media/quickstart-add-users-portal/new-guest-user.png)"
            ],
            "x_atrm_resources": [
                "Azure Active Directory"
            ],
            "x_mitre_brief": "An adversary may create a guest account in Azure Active Directory",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--6c2cf99e-01ee-478b-9aa8-060a8d1f9d52",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2022-07-29T18:07:09.000Z",
            "name": "Account Creation",
            "description": "An adversary may create an account in Azure Active Directory.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "persistence"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Persistence/AZT502/AZT502",
                    "external_id": "AZT502"
                }
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_brief": "An adversary may create an account in Azure Active Directory.",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--5137e13e-c99c-49cf-ad00-9eb9e3344b61",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:27:03.000Z",
            "name": "User Account Creation",
            "description": "An adversary may create an application & service principal in Azure Active Directory",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "persistence"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Persistence/AZT502/AZT502-1",
                    "external_id": "AZT502.001"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/active-directory-users-reset-password-azure-portal"
                }
            ],
            "x_atrm_actions": [
                "microsoft.directory/users/create"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Azure Active Directory | Add user | microsoft.directory/users/create | AuditLogs |\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AuditLogs | where OperationName == 'Add user'` |\t\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FPersistence%2FAZT502%2FAZT502-1.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\t[`#!powershell New-AzADUser`](https://docs.microsoft.com/en-us/powershell/module/az.resources/new-azaduser?view=azps-8.0.0)\n\n=== \"Azure CLI\"\n\n\t[`#!python az ad user create`](https://docs.microsoft.com/en-us/cli/azure/ad/user?view=azure-cli-latest#az-ad-user-create)\n\n=== \"Microsoft Graph API\"\n\n\t[`#!python POST https://graph.microsoft.com/v1.0/users`](https://docs.microsoft.com/en-us/graph/api/user-post-users?view=graph-rest-1.0&tabs=http)\t\n\n=== \"Azure Portal\"\n\n\t![newuser](newuser.PNG)"
            ],
            "x_atrm_resources": [
                "Azure Active Directory"
            ],
            "x_mitre_brief": "An adversary may create an application & service principal in Azure Active Directory",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--0a5b9484-01d2-45a7-8e2e-11fdd9d52b3a",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-11-28T17:45:43.000Z",
            "modified": "2023-06-12T03:16:53.000Z",
            "name": "Azure Bastion",
            "description": "Azure Bastion can be abused to allow persistent network access to a virtual machine over public internet.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "persistence"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Persistence/AZT509/AZT509",
                    "external_id": "AZT509"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Network/bastionHosts/write",
                "",
                "Microsoft.Network/bastionHosts/createShareableLinks/action",
                "",
                "Microsoft.Network/bastionHosts/getShareableLinks/action"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "[https://blog.karims.cloud/2022/11/26/yet-another-azure-vm-persistence.html](https://blog.karims.cloud/2022/11/26/yet-another-azure-vm-persistence.html)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "## **Logs** \n\n| Data Source        | Operation Name      | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource           | Get Bastion Shareable Link\t | Microsoft.Network/bastionHosts/GetShareableLinks/action\t| AzureActivity |       \n| Resource           | N/A\t | Microsoft.Network/bastionHosts/write\t| AzureActivity |   \n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AzureActivity | where OperationNameValue =~ \"MICROSOFT.NETWORK/BASTIONHOSTS/GETSHAREABLELINKS/ACTION\" or OperationNameValue =~ \"MICROSOFT.NETWORK/BASTIONHOSTS/CREATESHAREABLELINKS/ACTION` |"
            ],
            "x_atrm_resources": [
                "Azure Bastion"
            ],
            "x_mitre_brief": "Azure Bastion can be abused to allow persistent network access to a virtual machine over public internet.",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--6cc30162-d68d-4bfc-81be-15ad3e5bdae9",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:16:53.000Z",
            "name": "Azure Lighthouse",
            "description": "Adversaries may utilize Azure Lighthouse to manage the target tenant from an external tenant",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "persistence"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Persistence/AZT507/AZT507-1",
                    "external_id": "AZT507.001"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/lighthouse/how-to/onboard-customer"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.ManagedServices/registrationAssignments/Write"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Detection Details**\n\n* The Az PowerShell cmdlets `Get-AzManagedServicesDefinition` and `Get-AzManagedServicesAssignment`, or az cli cmdlets `az managedservices definition list` and `az managedservices assignment list` can be used to list the onboarded customers to the tenant."
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\n\t[`#!powershell New-AzSubscriptionDeployment`](https://docs.microsoft.com/en-us/powershell/module/az.resources/new-azdeployment?view=azps-8.1.0)\n\t\n=== \"Azure CLI\"\n\n\t[`#!python az deployment sub create`](https://docs.microsoft.com/en-us/cli/azure/deployment/sub?view=azure-cli-latest)\t\n\n=== \"Azure REST API\"\n\n\t[`#!python PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Network/networkSecurityGroups/{networkSecurityGroupName}/securityRules/{securityRuleName}?api-version=2021-08-01`](https://docs.microsoft.com/en-us/rest/api/virtualnetwork/security-rules)\t\n\n=== \"Azure Portal\"\n\t![portal](https://docs.microsoft.com/en-us/azure/lighthouse/media/add-offer-via-template.png)"
            ],
            "x_atrm_resources": [
                "AzureAD"
            ],
            "x_mitre_brief": "Adversaries may utilize Azure Lighthouse to manage the target tenant from an external tenant",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--e0cc35c1-b058-4544-8ee3-129fc24ade4e",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-08-18T19:04:59.000Z",
            "modified": "2024-02-04T22:12:32.000Z",
            "name": "Domain Trust Modification",
            "description": "An adversary may add an additional identity provider or domain to maintain a backdoor into the tenant.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "persistence"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Persistence/AZT507/AZT507-4",
                    "external_id": "AZT507.004"
                }
            ],
            "x_atrm_detections": [
                "* [https://o365blog.com/post/aadbackdoor/](https://o365blog.com/post/aadbackdoor/)\n\n* [https://www.mandiant.com/resources/detecting-microsoft-365-azure-active-directory-backdoors](https://www.mandiant.com/resources/detecting-microsoft-365-azure-active-directory-backdoors)\n\n* [https://github.com/Azure/Azure-Sentinel/blob/master/Hunting%20Queries/Microsoft%20365%20Defender/Defense%20evasion/ADFSDomainTrustMods%5BNobelium%5D.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Hunting%20Queries/Microsoft%20365%20Defender/Defense%20evasion/ADFSDomainTrustMods%5BNobelium%5D.yaml)"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_examples": [
                "## **Detection Details**\n\nMonitor the 'Pass-through Authentication' page in the Azure portal. Azure AD Connect > Pass-through Authentication"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_resources": [
                "AzureAD"
            ],
            "x_mitre_brief": "An adversary may add an additional identity provider or domain to maintain a backdoor into the tenant.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--b7670d70-f1c4-4963-8c51-ecf8d7a099a4",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2022-08-18T19:04:59.000Z",
            "name": "External Entity Access",
            "description": "Adversaries may configure the target Azure tenant to be managed by another, externel tenant, or its users.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "persistence"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Persistence/AZT507/AZT507",
                    "external_id": "AZT507"
                }
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_brief": "Adversaries may configure the target Azure tenant to be managed by another, externel tenant, or its users.",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--cb6ea575-bc20-4261-a36d-614d59735ced",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-08-18T19:04:59.000Z",
            "modified": "2023-06-12T03:16:53.000Z",
            "name": "Subscription Hijack",
            "description": "An adversary may transfer a subscription from a target tenant to an attacker-controlled tenant. This retains the billing account setup by the target and the target tenant administrators will no longer have control over the subscription.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "persistence"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Persistence/AZT507/AZT507-3",
                    "external_id": "AZT507.003"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/role-based-access-control/transfer-subscription"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://derkvanderwoude.medium.com/azure-subscription-hijacking-and-cryptomining-86c2ac018983"
                }
            ],
            "x_atrm_actions": [
                "The \"Owner\" role is needed to complete the transfer."
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Detection Details**\n\n* A policy can be placed on the subscription to prevent transfers. [https://docs.microsoft.com/en-us/azure/cost-management-billing/manage/manage-azure-subscription-policy](https://docs.microsoft.com/en-us/azure/cost-management-billing/manage/manage-azure-subscription-policy)\n\n* The logs for the subscription are transfered with the subscription"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Azure Portal\"\n\t![portal](507-3-1.png)"
            ],
            "x_atrm_resources": [
                "Azure Subscription"
            ],
            "x_mitre_brief": "An adversary may transfer a subscription from a target tenant to an attacker-controlled tenant. This retains the billing account setup by the target and the target tenant administrators will no longer have control over the subscription.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--630791a3-d60e-4c4b-84a8-d9397166876f",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:16:53.000Z",
            "name": "Microsoft Partners",
            "description": "Adversaries may use Delegated Administrative Privileges to give themselves administrator access to the target tenant.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "persistence"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Persistence/AZT507/AZT507-2",
                    "external_id": "AZT507.002"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/microsoft-365/commerce/manage-partners?view=o365-worldwide"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://o365blog.com/post/partners/"
                }
            ],
            "x_atrm_detections": [
                "## **Detection Details**\n\nBy reviewing access logs in AzureAD, a key indicator is identifying logins from users that do not contain a domain linked to the tenant."
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_examples": [
                "* N/A"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_resources": [
                "AzureAD"
            ],
            "x_mitre_brief": "Adversaries may use Delegated Administrative Privileges to give themselves administrator access to the target tenant.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--1c06e6d6-d8c6-4c57-8d66-a73c6bb62ac2",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:27:03.000Z",
            "name": "User Account Manipulation",
            "description": "An adverary may manipulate a user account to maintain access in an Azure tenant",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "persistence"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Persistence/AZT501/AZT501-1",
                    "external_id": "AZT501.001"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/active-directory-users-reset-password-azure-portal"
                }
            ],
            "x_atrm_actions": [
                "microsoft.directory/users/password/update",
                "microsoft.directory/users/enable",
                "microsoft.directory/users/restore"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Azure Active Directory | Reset password\t | microsoft.directory/users/password/update\t|  AuditLogs |\n| Azure Active Directory | Enable account\t | microsoft.directory/users/enable\t|  AuditLogs |\n| Azure Active Directory | Update user\t| microsoft.directory/users/password/update\t|  AuditLogs |\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AuditLogs | where OperationName =='Reset user password' or OperationName =='Enable account' or OperationName =='Update user'` |\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FPersistence%2FAZT501%2FAZT501-1.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\t[`#!powershell Update-AzADUser`](https://docs.microsoft.com/en-us/powershell/module/az.resources/update-azaduser?view=azps-8.0.0)\n\t\n=== \"Azure CLI\"\n\t[`#!python az ad user update`](https://docs.microsoft.com/en-us/cli/azure/ad/user?view=azure-cli-latest#az-ad-user-update)\n\t\n=== \"Microsoft Graph API\"\t\n\t[`#!powershell PATCH https://graph.microsoft.com/v1.0/users/{id}`](https://docs.microsoft.com/en-us/graph/api/user-update?view=graph-rest-1.0&tabs=http)\t\t\n\n=== \"Azure Portal\"\n\t![directorylogs](directorylogs.PNG)"
            ],
            "x_atrm_resources": [
                "Azure Active Directory"
            ],
            "x_mitre_brief": "An adverary may manipulate a user account to maintain access in an Azure tenant",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--2fb9a8b8-3141-4de8-bff3-ee36d65be398",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2022-07-29T18:07:09.000Z",
            "name": "Account Manipulation",
            "description": "An adverary may manipulate an account to maintain access in an Azure tenant",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "persistence"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Persistence/AZT501/AZT501",
                    "external_id": "AZT501"
                }
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_brief": "An adverary may manipulate an account to maintain access in an Azure tenant",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--aadb4d17-c65a-428b-beea-911c74a0593b",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:33:04.000Z",
            "name": "Azure VM Local Administrator Manipulation",
            "description": "An adverary may manipulate the local admin account on an Azure VM",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "persistence"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Persistence/AZT501/AZT501-3",
                    "external_id": "AZT501.003"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/troubleshoot/azure/virtual-machines/reset-rdp"
                }
            ],
            "x_atrm_actions": [
                "microsoft.compute/virtualMachines/extensions/write"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Detection Details**\n\nAfter a successful reset, the log 'Validate Deployment' will be created. Specifically, in the scope, a password reset will be mentioned \"VMAccessWindowsPasswordReset\".\n\n## **Logs** \n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource | Create or Udpate Virutal Machine Extension | microsoft.compute/virtualMachines/extensions/write\t| ActivityLog |\n| Resource | Validate Deployment | Microsoft.Resources/deployments/validate/action\t| ActivityLog |\n\n## **Detection Screenshot**\n\n![validate](validate.png)\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AzureActivity | where Properties_d has 'vmaccesswindowspasswordreset'` |\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FPersistence%2FAZT501%2FAZT501-3.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\t[`#!powershell Set-AzVMAccessExtension`](https://docs.microsoft.com/en-us/powershell/module/az.compute/set-azvmaccessextension?view=azps-8.0.0)\n\t\n=== \"Azure CLI\"\n\t[`#!python az vm extension set`](https://docs.microsoft.com/en-us/cli/azure/vm/extension?view=azure-cli-latest#az-vm-extension-set)\n\t\n=== \"Azure REST API\"\t\n\t[`#!powershell PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Compute/virtualMachines/{vmName}/extensions/{vmExtensionName}?api-version=2022-03-01`](https://docs.microsoft.com/en-us/rest/api/compute/virtual-machine-extensions/create-or-update)\t\t\n\n=== \"Azure Portal\"\n\t![localadminreset](localadminreset.PNG)"
            ],
            "x_atrm_resources": [
                "Azure Active Directory"
            ],
            "x_mitre_brief": "An adverary may manipulate the local admin account on an Azure VM",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--0ce2adf9-4f8c-4aeb-85aa-db0496b8629c",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:33:04.000Z",
            "name": "Service Principal Manipulation",
            "description": "An adverary may manipulate a service principal to maintain access in an Azure tenant",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "persistence"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Persistence/AZT501/AZT501-2",
                    "external_id": "AZT501.002"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/active-directory/develop/app-objects-and-service-principals"
                }
            ],
            "x_atrm_actions": [
                "microsoft.directory/servicePrincipals/enable",
                "microsoft.directory/servicePrincipals/credentials/update",
                "microsoft.directory/servicePrincipals/owners/update"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Azure Active Directory | Update application \u2013 Certificates and secrets management\t | microsoft.directory/servicePrincipals/credentials/update\t|  AuditLogs |\n| Azure Active Directory | Update service principal | microsoft.directory/servicePrincipals/credentials/update\t|  AuditLogs |\n| Azure Active Directory | Update user\t| microsoft.directory/users/password/update\t|  AuditLogs |\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AzureActivity | where OperationName == 'Update application \u2013 Certificates and secrets management' or OperationName =='Update service principal' or OperationName =='Update user'` |\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FPersistence%2FAZT501%2FAZT501-2.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\t[`#!powershell Update-AzADServicePrincipal`](https://docs.microsoft.com/en-us/powershell/module/az.resources/update-azadserviceprincipal?view=azps-8.0.0)\n\t\n=== \"Azure CLI\"\n\t[`#!python az ad sp update`](https://docs.microsoft.com/en-us/cli/azure/ad/sp?view=azure-cli-latest#az-ad-sp-update)\n\t\n=== \"Microsoft Graph API\"\t\n\t[`#!powershell PATCH https://graph.microsoft.com/v1.0/servicePrincipals/{id}`](https://docs.microsoft.com/en-us/graph/api/serviceprincipal-update?view=graph-rest-1.0&tabs=http)\t\t\n\n=== \"Azure Portal\"\n\t![directorylogs](directorylogs.PNG)"
            ],
            "x_atrm_resources": [
                "Azure Active Directory"
            ],
            "x_mitre_brief": "An adverary may manipulate a service principal to maintain access in an Azure tenant",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--ed8c8c59-6a07-4d27-bb0d-e0e3ccf31c33",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:27:03.000Z",
            "name": "Network Security Group Modification",
            "description": "Adversaries can modify the rules in a Network Security Group to establish access over additional ports.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "persistence"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Persistence/AZT506/AZT506",
                    "external_id": "AZT506"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/virtual-network/manage-network-security-group"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Network/networkSecurityGroups/*"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|--------------------|-------------------------------------------------------------------|--------------|\n| Resource           | Create or Update Security Rule\t | Microsoft.Network/networkSecurityGroups/securityRules/write\t| AzureActivity |\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AzureActivity | where OperationNameValue=='MICROSOFT.NETWORK/NETWORKSECURITYGROUPS/SECURITYRULES/WRITE'` |\t\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FPersistence%2FAZT506%2FAZT506.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\n\t[`#!powershell Set-AzNetworkSecurityRuleConfig`](https://docs.microsoft.com/en-us/powershell/module/az.network/set-aznetworksecurityruleconfig?view=azps-8.0.0)\n\t\n=== \"Azure CLI\"\n\n\t[`#!python az network nsg rule`](https://docs.microsoft.com/en-us/cli/azure/network/nsg/rule?view=azure-cli-latest)\t\n\n=== \"Azure REST API\"\n\n\t[`#!python PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Network/networkSecurityGroups/{networkSecurityGroupName}/securityRules/{securityRuleName}?api-version=2021-08-01`](https://docs.microsoft.com/en-us/rest/api/virtualnetwork/security-rules)\t\n\n=== \"Azure Portal\"\n\t![nsg](nsg.PNG)"
            ],
            "x_atrm_resources": [
                "Network Security Group"
            ],
            "x_mitre_brief": "Adversaries can modify the rules in a Network Security Group to establish access over additional ports.",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--5517ec16-8116-4c7f-95d5-2f3a3be35ee2",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-08-18T19:04:59.000Z",
            "modified": "2023-06-12T03:27:03.000Z",
            "name": "Azure Policy",
            "description": "By configuring a policy with the 'DeployIfNotExists' definition, an adverary may establish persistence by creating a backdoor when the policy is triggered.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "persistence"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Persistence/AZT508/AZT508",
                    "external_id": "AZT508"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/governance/policy/concepts/effects#deployifnotexists"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Authorization/policies/deployIfNotExists/action",
                "",
                "Microsoft.Authorization/policyAssignments/write"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name      | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource           | 'deployIfNotExists' Policy Action\t | Microsoft.Authorization/policies/deployIfNotExists/action\t| AzureActivity |       \n| Resource           | N/A\t | Microsoft.Authorization/policyAssignments/write\t| AzureActivity  |   \n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AzureActivity | where OperationNameValue=='MICROSOFT.AUTHORIZATION/POLICYDEFINITIONS/WRITE'` |\t\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FPersistence%2FAZT508%2FAZT508.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Azure Portal\"\n\t![portal](508.PNG)"
            ],
            "x_atrm_resources": [
                "Azure Policy"
            ],
            "x_mitre_brief": "By configuring a policy with the 'DeployIfNotExists' definition, an adverary may establish persistence by creating a backdoor when the policy is triggered.",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--b0844cbf-878c-4221-a7fc-70c276542fa5",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:16:53.000Z",
            "name": "Function App Settings",
            "description": "If a Function App is using a service principal for authentication, an adversary may manipulate the function app logic to reveal the service principal's secret in plain text.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "credential-access"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/CredentialAccess/AZT603/AZT603-1",
                    "external_id": "AZT603.001"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/automation/automation-runbook-execution"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.web/sites/functions/read",
                "Microsoft.Web/sites/read",
                "Microsoft.Web/sites/config/list/action"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Detection Details**\n\nNo logs are generated when retrieving the settings of a function app.\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AADServicePrincipalSignInLogs | where  ServicePrincipalName == 'NAMEOFFUNCTIONAPP'` |\t\n\t\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FAzureThreatResearchMatrix%2FCredentialAccess%2FAZT603%2FAZT603-1.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\" \n\n\t[`#!powershell Get-AzFunctionAppSetting`](https://docs.microsoft.com/en-us/powershell/module/az.functions/get-azfunctionappsetting?view=azps-8.0.0)\n\t\t\n=== \"Azure CLI\"\n\n\t[`#!python az functionapp config appsettings`](https://docs.microsoft.com/en-us/cli/azure/functionapp/config/appsettings?view=azure-cli-latest)\n\n=== \"Azure REST API\"\n\n\t[`#!python PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Web/sites/{name}/config/appsettings?api-version=2021-02-01`](https://docs.microsoft.com/en-us/rest/api/appservice/web-apps/update-application-settings)"
            ],
            "x_atrm_resources": [
                "Function App"
            ],
            "x_mitre_brief": "If a Function App is using a service principal for authentication, an adversary may manipulate the function app logic to reveal the service principal's secret in plain text.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--09109128-664e-4eb5-b891-41935a01d5cf",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-02-04T23:05:59.000Z",
            "modified": "2024-02-04T23:05:59.000Z",
            "name": "Service Principal Secret Reveal",
            "description": "An Adversary may reveal a service principal's secret in plain text.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "credential-access"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/CredentialAccess/AZT603/AZT603",
                    "external_id": "AZT603"
                }
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_brief": "An Adversary may reveal a service principal's secret in plain text.",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--a6c5dd02-1714-4fd1-8c7b-55b68eaab8fb",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:16:53.000Z",
            "name": "Azure KeyVault Secret Dump",
            "description": "By accessing an Azure Key Vault, an adversary may dump any or all secrets.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "credential-access"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/CredentialAccess/AZT604/AZT604-1",
                    "external_id": "AZT604.001"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/key-vault/general/logging?WT.mc_id=Portal-fx&tabs=Vault"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.KeyVault/vaults/secrets/getSecret/action"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Detection Details**\n\nBy default, logging is not enabled on Key Vaults, meaning whenever a secret/key/certificate is accessed, it will not be logged unless Key Vault logging is turned on. \n\n## **Logs**\n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource | SecretGet\t | N/A\t| AzureDiagnostics |\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AzureDiagnostics | where OperationName == 'SecretList'` |\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FAzureThreatResearchMatrix%2FCredentialAccess%2FAZT604%2FAZT604-1.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\n\t[`#!powershell Get-AzKeyVaultSecret`](https://docs.microsoft.com/en-us/powershell/module/az.keyvault/get-azkeyvaultsecret?view=azps-8.0.0)\n\t\n=== \"Azure CLI\"\n\n\t[`#!python az keyvault secret`](https://docs.microsoft.com/en-us/cli/azure/keyvault/secret?view=azure-cli-latest)\n\n=== \"Azure REST API\"\n\n\t[`#!python GET {vaultBaseUrl}/secrets/{secret-name}/{secret-version}?api-version=7.3`](https://docs.microsoft.com/en-us/rest/api/keyvault/secrets/get-secret/get-secret)\t\n\n=== \"Azure Portal\"\n\n\t![secrets](secrets.PNG)"
            ],
            "x_atrm_resources": [
                "Azure Key Vault"
            ],
            "x_mitre_brief": "By accessing an Azure KeyVault, an adversary may dump any or all secrets.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--f99d7c5e-015e-4aec-809f-c62a392137d1",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:16:53.000Z",
            "name": "Azure KeyVault Key Dump",
            "description": "By accessing an Azure Key Vault, an adversary may dump any or all public keys. Note that Private keys cannot be retrieved.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "credential-access"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/CredentialAccess/AZT604/AZT604-3",
                    "external_id": "AZT604.003"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/key-vault/general/logging?WT.mc_id=Portal-fx&tabs=Vault"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.KeyVault/vaults/keys/read"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Detection Details**\n\nBy default, logging is not enabled on Key Vaults, meaning whenever a secret/key/certificate is accessed, it will not be logged unless Key Vault logging is turned on. \n\n## **Logs**\n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource | KeyGet\t | N/A\t| AzureDiagnostics |\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AzureDiagnostics | where ResourceProvider == 'MICROSOFT.KEYVAULT' and OperationName == 'KeyGet'` |\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FAzureThreatResearchMatrix%2FCredentialAccess%2FAZT604%2FAZT604-3.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\n\t[`#!powershell Get-AzKeyVaultKey`](https://docs.microsoft.com/en-us/powershell/module/az.keyvault/get-azkeyvaultkey?view=azps-8.0.0)\n\n=== \"Azure CLI\"\n\n\t[`#!python az keyvault key`](https://docs.microsoft.com/en-us/cli/azure/keyvault/key?view=azure-cli-latest)\n\n=== \"Azure REST API\"\n\n\t[`#!python GET {vaultBaseUrl}/keys/{key-name}/{key-version}?api-version=7.3`](https://docs.microsoft.com/en-us/rest/api/keyvault/keys/get-key/get-key)\t\n\n=== \"Azure Portal\"\n\n\t![keys](keys.PNG)"
            ],
            "x_atrm_resources": [
                "Azure Key Vault"
            ],
            "x_mitre_brief": "By accessing an Azure KeyVault, an adversary may dump any or all keys.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--ff405e31-278c-42db-964c-b36eac195238",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2022-07-29T18:07:09.000Z",
            "name": "Azure KeyVault Dumping",
            "description": "An adverary may access an Azure KeyVault in an attempt to view secrets, certificates, or keys.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "credential-access"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/CredentialAccess/AZT604/AZT604",
                    "external_id": "AZT604"
                }
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_brief": "An adverary may access an Azure KeyVault in an attempt to view secrets, certificates, or keys.",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--97dc0499-c809-46e0-8bdf-6e2991e9ee02",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:16:53.000Z",
            "name": "Azure KeyVault Certificate Dump",
            "description": "By accessing an Azure Key Vault, an adversary may dump any or all certificates.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "credential-access"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/CredentialAccess/AZT604/AZT604-2",
                    "external_id": "AZT604.002"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/key-vault/general/logging?WT.mc_id=Portal-fx&tabs=Vault"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.KeyVault/vaults/secrets/getSecret/action"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Detection Details**\n\nBy default, logging is not enabled on Key Vaults, meaning whenever a secret/key/certificate is accessed, it will not be logged unless Key Vault logging is turned on. \n\n## **Logs**\n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource | CertificateList\t | N/A\t| AzureDiagnostics|\n| Resource | SecretGet\t | N/A\t| AzureDiagnostics |\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AzureDiagnostics | where ResourceProvider == 'MICROSOFT.KEYVAULT' and OperationName == 'CertificateList' or OperationName == 'SecretGet'` |\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FAzureThreatResearchMatrix%2FCredentialAccess%2FAZT604%2FAZT604-2.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\n\t[`#!powershell Get-AzKeyVaultCertificate`](https://docs.microsoft.com/en-us/powershell/module/az.keyvault/get-azkeyvaultcertificate?view=azps-8.0.0)\n\t\n=== \"Azure CLI\"\n\n\t[`#!python az keyvault certificate`](https://docs.microsoft.com/en-us/cli/azure/keyvault/certificate?view=azure-cli-latest)\n\n=== \"Azure REST API\"\n\n\t[`#!python GET {vaultBaseUrl}/certificates/{certificate-name}/{certificate-version}?api-version=7.3`](https://docs.microsoft.com/en-us/rest/api/keyvault/certificates/get-certificate/get-certificate)\t\n\n\n=== \"Azure Portal\"\n\n\t![certs](certs.PNG)"
            ],
            "x_atrm_resources": [
                "Azure Key Vault"
            ],
            "x_mitre_brief": "By accessing an Azure KeyVault, an adversary may dump any or all certificates.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--88a747d9-fa91-48ca-b7b5-829b13ed0884",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:16:53.000Z",
            "name": "Storage Account Access Key Dumping",
            "description": "By accessing a Storage Account, an adversary may dump access keys pertaining to the Storage Account, which will give them full access to the Storage Account.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "credential-access"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/CredentialAccess/AZT605/AZT605-1",
                    "external_id": "AZT605.001"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/storage/common/storage-account-keys-manage?tabs=azure-portal"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Storage/storageAccounts/listkeys/action"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource | MICROSOFT.STORAGE/STORAGEACCOUNTS/LISTKEYS/ACTION\t | Microsoft.Storage/storageAccounts/listkeys/action\t| AzureActivity |\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AzureActivity | where OperationNameValue == 'MICROSOFT.STORAGE/STORAGEACCOUNTS/LISTKEYS/ACTION' and ActivityStatusValue == 'Start'` |\t\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FAzureThreatResearchMatrix%2FCredentialAccess%2FAZT605%2FAZT605-1.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\n\t[`#!powershell Get-AzStorageAccountKey`](https://docs.microsoft.com/en-us/powershell/module/az.storage/get-azstorageaccountkey?view=azps-8.0.0)\n\n=== \"Azure CLI\"\n\n\t[`#!python az storage account keys`](https://docs.microsoft.com/en-us/cli/azure/storage/account/keys?view=azure-cli-latest)\n\n=== \"Azure REST API\"\n\n\t[`#!python https://{myaccount}.blob.core.windows.net/?restype=service&comp=userdelegationkey`](https://docs.microsoft.com/en-us/rest/api/storageservices/get-user-delegation-key)\t\n\n=== \"Azure Portal\"\n\n\t![storagekeys](StorageKeys.PNG)"
            ],
            "x_atrm_resources": [
                "Azure Storage Account"
            ],
            "x_mitre_brief": "By accessing a Storage Account, an adversary may dump access keys pertaining to the Storage Account, which will give them full access to the Storage Account.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--dba23df3-b5ac-4bb1-b786-8a96d7ff5d61",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2022-08-18T19:04:59.000Z",
            "name": "Resource Secret Reveal",
            "description": "An adverary may access an Azure KeyVault in an attempt to view secrets, certificates, or keys.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "credential-access"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/CredentialAccess/AZT605/AZT605",
                    "external_id": "AZT605"
                }
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_brief": "",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--f2dff7cf-8146-4eb2-8875-d7a293b66b5b",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:16:53.000Z",
            "name": "Automation Account Credential Secret Dump",
            "description": "By editing a Runbook, a credential configured in an Automation Account may be revealed",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "credential-access"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/CredentialAccess/AZT605/AZT605-2",
                    "external_id": "AZT605.002"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://learn.microsoft.com/en-us/azure/automation/shared-resources/credentials?tabs=azure-powershell#create-a-new-credential-asset-with-the-azure-portal"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Automation/automationAccounts/runbooks/*"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource | Create an Azure Automation job\t | Microsoft.Automation/automationAccounts/jobs/write\t| AzureActivity |\n| Resource | Publish an Azure Automation runbook draft\t | Microsoft.Automation/automationAccounts/runbooks/publish/action\t| AzureActivity |\n| Resource | Write an Azure Automation runbook draft\t | Microsoft.Automation/automationAccounts/runbooks/draft/write\t| AzureActivity |\n| Resource | Create or Update an Azure Automation Runbook\t | Microsoft.Automation/automationAccounts/runbooks/write\t| AzureActivity |\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AzureActivity  |where OperationNameValue=='Microsoft.Automation/automationAccounts/jobs/write' or OperationNameValue=='Microsoft.Automation/automationAccounts/runbooks/publish/action' or OperationNameValue=='Microsoft.Automation/automationAccounts/runbooks/draft/write' or OperationNameValue=='Microsoft.Automation/automationAccounts/runbooks/write'` |\t\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FAzureThreatResearchMatrix%2FCredentialAccess%2FAZT605%2FAZT605-2.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\n\t* [`#!powershell New-AzAutomationRunbook`](https://docs.microsoft.com/en-us/powershell/module/az.automation/new-azautomationrunbook?view=azps-8.0.0)\n\t* [`#!powershell Set-AzAutomationRunbook`](https://docs.microsoft.com/en-us/powershell/module/az.automation/set-azautomationrunbook?view=azps-8.0.0)\n\t\t\n=== \"Azure CLI\"\n\n\t[`#!python az automation runbook`](https://docs.microsoft.com/en-us/cli/azure/automation/runbook?view=azure-cli-latest)\n\n=== \"Azure REST API\"\n\n\t[`#!python PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Automation/automationAccounts/{automationAccountName}/runbooks/{runbookName}?api-version=2019-06-01`](https://docs.microsoft.com/en-us/rest/api/automation/runbook/create-or-update)\t\n\n=== \"Azure Portal\"\n\n\t![NEWCRED](newcred.png)"
            ],
            "x_atrm_resources": [
                "Automation Account"
            ],
            "x_mitre_brief": "By editing a Runbook, a credential configured in an Automation Account may be revealed",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--0d9f6aba-487c-4e0c-a483-97086bdec821",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-08-18T19:04:59.000Z",
            "modified": "2023-06-12T03:16:53.000Z",
            "name": "Resource Group Deployment History Secret Dump",
            "description": "By accessing deployment history of a Resource Group, secrets used in the ARM template may be revealed.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "credential-access"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/CredentialAccess/AZT605/AZT605-3",
                    "external_id": "AZT605.003"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/azure-resource-manager/templates/deployment-history?tabs=azure-portal"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Resources/deployments/read",
                "Microsoft.Resources/subscriptions/resourceGroups/read"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Detection Details**\n\nWhen a template is used, the parameters from the template are reflected on the 'Input' page when viewing the deployment detail in the Azure portal. The parameter key value's are shown unless the key 'SecureString' is used. If 'SecureString' is not used, then the value will show in the deployment input details. \n\n## **Logs** \n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource | N/A\t | N/A\t| AzureActivity |"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\n\t[`#!powershell Get-AzResourceGroupDeployment`](https://docs.microsoft.com/en-us/powershell/module/az.resources/get-azresourcegroupdeployment?view=azps-8.2.0)\n\t\t\n=== \"Azure CLI\"\n\n\t* [`#!python az deployment group list`](https://docs.microsoft.com/en-us/cli/azure/deployment/group?view=azure-cli-latest#az-deployment-group-list)\n\t* [`#!python az deployment group export`](https://docs.microsoft.com/en-us/cli/azure/deployment/group?view=azure-cli-latest#az-deployment-group-export)\n\n=== \"Azure Portal\"\n\n\t![605.3.1](605-3-1.PNG)\n\t![605.3.2](605-3-2.PNG)"
            ],
            "x_atrm_resources": [
                "Resource Group"
            ],
            "x_mitre_brief": "By accessing deployment history of a Resource Group, secrets used in the ARM template may be revealed.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--89a91ded-a372-4630-b5a8-3e14d91f8408",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:16:53.000Z",
            "name": "Automation Account RunAs Account",
            "description": "If a Runbook is utilizing a 'RunAs' account, then an adversary may manipulate the Runbook to reveal the certificate the Service Principal is using for authentication.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "credential-access"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/CredentialAccess/AZT602/AZT602-1",
                    "external_id": "AZT602.001"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/automation/automation-runbook-execution"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Automation/automationAccounts/runbooks/*"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource | Create an Azure Automation job\t | Microsoft.Automation/automationAccounts/jobs/write\t| AzureActivity |\n| Resource | Publish an Azure Automation runbook draft\t | Microsoft.Automation/automationAccounts/runbooks/publish/action\t| AzureActivity |\n| Resource | Write an Azure Automation runbook draft\t | Microsoft.Automation/automationAccounts/runbooks/draft/write\t| AzureActivity |\n| Resource | Create or Update an Azure Automation Runbook\t | Microsoft.Automation/automationAccounts/runbooks/write\t| AzureActivity |\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AzureDiagnostics | where ResourceProvider == 'MICROSOFT.AUTOMATION' and ResultDescription has 'Thumbprint'` |\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FAzureThreatResearchMatrix%2FCredentialAccess%2FAZT602%2FAZT602-1.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\n\t* [`#!powershell New-AzAutomationRunbook`](https://docs.microsoft.com/en-us/powershell/module/az.automation/new-azautomationrunbook?view=azps-8.0.0)\n\t* [`#!powershell Set-AzAutomationRunbook`](https://docs.microsoft.com/en-us/powershell/module/az.automation/set-azautomationrunbook?view=azps-8.0.0)\n\t\t\n=== \"Azure CLI\"\n\n\t[`#!python az automation runbook`](https://docs.microsoft.com/en-us/cli/azure/automation/runbook?view=azure-cli-latest)\n\n=== \"Azure REST API\"\n\n\t[`#!python PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Automation/automationAccounts/{automationAccountName}/runbooks/{runbookName}?api-version=2019-06-01`](https://docs.microsoft.com/en-us/rest/api/automation/runbook/create-or-update)\t\n\n=== \"Azure Portal\"\n\n\t![runbook](runbook.PNG)"
            ],
            "x_atrm_resources": [
                "Automation Account"
            ],
            "x_mitre_brief": "If a Runbook is utilizing a 'RunAs' account, then an adversary may manipulate the Runbook to reveal the certificate the Service Principal is using for authentication.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--b5f240be-4747-498b-ad69-0be4d1d36f94",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-02-04T23:05:59.000Z",
            "modified": "2024-02-04T23:05:59.000Z",
            "name": "Steal Service Principal Certificate",
            "description": "An Adversary may steal a Service Principal's certificate for authentication.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "credential-access"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/CredentialAccess/AZT602/AZT602",
                    "external_id": "AZT602"
                }
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_brief": "An Adversary may steal a Service Principal's certificate for authentication.",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--07a590ec-1c21-4b8c-87c7-79cf67c69612",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:16:53.000Z",
            "name": "Azure Kubernetes Service IMDS Request",
            "description": "By utilizing access to IMDS, an attacker can request a JWT for a Managed Identity on an AKS Cluster if they have access to execute commands on the system.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "credential-access"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/CredentialAccess/AZT601/AZT601-2",
                    "external_id": "AZT601.002"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/aks/command-invoke"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/aks/use-managed-identity"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.ContainerService/managedClusters/runcommand/action",
                "Microsoft.ContainerService/managedclusters/commandResults/read"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Detection Details**\n\nLogs are only generated when running a command through az cli or Az PowerShell. Using `kubectl` will not generate logs.\n\n## **Logs**  \n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource | RunCommand\t | Microsoft.ContainerService/managedClusters/runCommand/action\t| AzureActivity |\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AzureDiagnostics | where log_s has '169.254.169.254'` |\t\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FAzureThreatResearchMatrix%2FCredentialAccess%2FAZT601%2FAZT601-2.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Python\"\n\n\t`#!python curl 'http://169.254.169.254/metadata/identity/oauth2/token?api-version=2018-02-01&resource=https%3A%2F%2Fmanagement.azure.com%2F' -H Metadata:true -s`\n\n=== \"PowerShell\"\n\t\n\t[`#!powershell powershell.exe -c $a=Invoke-Restmethod -Uri 'http://169.254.169.254/metadata/identity/oauth2/token?api-version=2018-02-01\"&\"resource=https://management.azure.com/' -Method GET -Headers @{Metadata='true'} -UseBasicParsing;$a.access_token`](https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/how-to-use-vm-token)\n\t\n=== \"Azure Portal\"\n\n\t![aks](aks.PNG)"
            ],
            "x_atrm_resources": [
                "Azure Kubernetes Service"
            ],
            "x_mitre_brief": "By utilizing access to IMDS, an attacker can request a JWT for a Managed Identity on an AKS Cluster if they have access to execute commands on the system.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--bae42eab-b9f0-4f0e-8227-d4f619e8d679",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:16:53.000Z",
            "name": "Logic Application JWT PUT Request",
            "description": "If a Logic App is using a Managed Identity, an adversary can modify the logic to make an HTTP POST request to reveal the Managed Identity's JWT.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "credential-access"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/CredentialAccess/AZT601/AZT601-3",
                    "external_id": "AZT601.003"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/logic-apps/logic-apps-overview"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Logic/workflows/write",
                "Microsoft.Logic/workflows/run/action",
                "Microsoft.Logic/operations/read"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource | Gets workflow recommend operation groups\t | Microsoft.Logic/locations/workflows/recommendOperationGroups/action\t| AzureActivity |\n| Resource | List Trigger Callback URL | Microsoft.Logic/workflows/triggers/listCallbackUrl/action\t| AzureActivity |\n| Resource | Add or Update Connection\t| Microsoft.Web/connections/write\t| AzureActivity |\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AzureActivity | where OperationNameValue == 'MICROSOFT.LOGIC/WORKFLOWS/TRIGGERS/LISTCALLBACKURL/ACTION'` |\t\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FAzureThreatResearchMatrix%2FCredentialAccess%2FAZT601%2FAZT601-3.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\n\t[`#!powershell Set-AzLogicApp`](https://docs.microsoft.com/en-us/powershell/module/az.logicapp/set-azlogicapp?view=azps-8.0.0)\n\t\n=== \"Azure CLI\"\n\n\t[`#!python az logicapp start`](https://docs.microsoft.com/en-us/cli/azure/logicapp?view=azure-cli-latest#az-logicapp-start)\t\n\n=== \"Azure REST API\"\n\n\t[`#!python PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Logic/workflows/{workflowName}?api-version=2016-06-01`](https://docs.microsoft.com/en-us/rest/api/logic/workflows/create-or-update)\t\n\n=== \"Azure Portal\"\n\n\t![logicapp](logciappimds.PNG)"
            ],
            "x_atrm_resources": [
                "Logic Application"
            ],
            "x_mitre_brief": "If a Logic App is using a Managed Identity, an adversary can modify the logic to make an HTTP POST request to reveal the Managed Identity's JWT.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--2f0fb949-f307-45be-8989-a60da6f5ca06",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2022-07-29T18:07:09.000Z",
            "name": "Steal Managed Identity JsonWebToken",
            "description": "An adverary may utilize the resource's functionality to obtain a JWT for the applied Managed Identity Service Principal account.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "credential-access"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/CredentialAccess/AZT601/AZT601",
                    "external_id": "AZT601"
                }
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_brief": "An adverary may utilize the resource's functionality to obtain a JWT for the applied Managed Identity Service Principal account.",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--fb488db2-63ff-42d9-9495-5ae27fc5a6cd",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:16:53.000Z",
            "name": "Function Application JWT GET Request",
            "description": "If a Function App is using a Managed Identity, an adversary can modify the logic respond to an HTTP GET request to reveal the Managed Identity's JWT.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "credential-access"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/CredentialAccess/AZT601/AZT601-4",
                    "external_id": "AZT601.004"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/azure-functions/functions-overview"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Web/sites/Write",
                "Microsoft.web/sites/functions/action",
                "Microsoft.web/sites/functions/write"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Azure Active Directory | Update website\t | Microsoft.Web/sites/write\t| AzureAD Audit Logs |\n| Azure Active Directory | Start Web App | Microsoft.Web/sites/start/action\t| AzureAD Audit Logs |"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\n\t[`#!powershell Update-AzFunctionApp`](https://docs.microsoft.com/en-us/powershell/module/az.functions/update-azfunctionapp?view=azps-8.0.0)\n\t\n=== \"Azure CLI\"\n\n\t[`#!python az functionapp update`](https://docs.microsoft.com/en-us/cli/azure/functionapp?view=azure-cli-latest#az-functionapp-update)\n\n=== \"Azure Portal\"\n\n\t![functionappmi](functionappmi.png)"
            ],
            "x_atrm_resources": [
                "Function App"
            ],
            "x_mitre_brief": "If a Function App is using a Managed Identity, an adversary can modify the logic respond to an HTTP GET request to reveal the Managed Identity's JWT.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--b4d2be4f-32c7-45a1-aa47-4292b4891355",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2023-06-12T03:08:06.000Z",
            "name": "Virtual Machine IMDS Request",
            "description": "By utilizing access to IMDS, an attacker can request a JWT for a Managed Identity on an Azure VM if they have access to execute commands on the system.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "credential-access"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/CredentialAccess/AZT601/AZT601-1",
                    "external_id": "AZT601.001"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/virtual-machines/windows/instance-metadata-service?tabs=windows"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/how-to-use-vm-token"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Compute/virtualMachines/write",
                "Microsoft.Compute/virtualMachines/extensions/*"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "The detection will be based off of the [Command Execution](../../Execution/AZT301/AZT301.md) technique chosen. If using RDP, then no logs will be generated in Azure. \nSince the command to retrieve the JWT requires local PowerShell execution, script block logging will reveal the request used to gather the token.\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql union Event, Syslog | where EventID == 4104 and RenderedDescription has 'http://169.254.169.254/metadata/identity/oauth2/token' or SyslogMessage has 'http://169.254.169.254/metadata'` |\t\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FAzureThreatResearchMatrix%2FCredentialAccess%2FAZT601%2FAZT601-1.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"PowerShell\"\n\t\n\t[`#!powershell powershell.exe -c $a=Invoke-Restmethod -Uri 'http://169.254.169.254/metadata/identity/oauth2/token?api-version=2018-02-01\"&\"resource=https://management.azure.com/' -Method GET -Headers @{Metadata='true'} -UseBasicParsing;$a.access_token`](https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/how-to-use-vm-token)\n\n=== \"Azure Portal\"\n\n\t![vmimds](vmimds.PNG)"
            ],
            "x_atrm_resources": [
                "Virtual Machine"
            ],
            "x_mitre_brief": "By utilizing access to IMDS, an attacker can request a JWT for a Managed Identity on an Azure VM if they have access to execute commands on the system.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--32407871-8a18-4832-9239-922bcbfc2956",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2022-07-29T18:07:09.000Z",
            "modified": "2024-02-04T22:12:32.000Z",
            "name": "Automation Account Runbook",
            "description": "If an Automation Account is using a Managed Identity, an adversary can create a Runbook to request the Managed Identity's JWT.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "credential-access"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/CredentialAccess/AZT601/AZT601-5",
                    "external_id": "AZT601.005"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/automation/automation-runbook-execution"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://posts.specterops.io/managed-identity-attack-paths-part-1-automation-accounts-82667d17187a"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Automation/automationAccounts/runbooks/write"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource | Create an Azure Automation job\t | Microsoft.Automation/automationAccounts/jobs/write\t| AzureActivity |\n| Resource | Publish an Azure Automation runbook draft\t | Microsoft.Automation/automationAccounts/runbooks/publish/action\t| AzureActivity |\n| Resource | Write an Azure Automation runbook draft\t | Microsoft.Automation/automationAccounts/runbooks/draft/write\t| AzureActivity |\n| Resource | Create or Update an Azure Automation Runbook\t | Microsoft.Automation/automationAccounts/runbooks/write\t| AzureActivity |\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AzureDiagnostics | where ResourceProvider == 'MICROSOFT.AUTOMATION' and ResultDescription has 'access_token'` |\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FAzureThreatResearchMatrix%2FCredentialAccess%2FAZT601%2FAZT601-5.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\t[`#!powershell New-AzAutomationRunbook`](https://docs.microsoft.com/en-us/powershell/module/az.automation/new-azautomationrunbook?view=azps-8.0.0)\n\t\n=== \"Azure CLI\"\n\t[`#!python az automation runbook create`](https://docs.microsoft.com/en-us/cli/azure/automation/runbook?view=azure-cli-latest#az-automation-runbook-create)\n\t\n=== \"Azure REST API\"\t\n\t[`#!powershell PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Automation/automationAccounts/{automationAccountName}/runbooks/{runbookName}?api-version=2019-06-01`](https://docs.microsoft.com/en-us/rest/api/automation/runbook/create-or-update)\t\t\n\n=== \"Azure Portal\"\n\t![runbook](runbook.PNG)"
            ],
            "x_atrm_resources": [
                "Automation Account"
            ],
            "x_mitre_brief": "If an Automation Account is using a Managed Identity, an adversary can create a Runbook to request the Managed Identity's JWT.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--89575dad-41e5-4c78-9fa1-0ef36d93177e",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2023-09-05T15:58:57.000Z",
            "modified": "2023-09-05T15:58:57.000Z",
            "name": "VM Disk SAS URI",
            "description": "An adversary may create an SAS URI to download the disk attached to a virtual machine.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "impact"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Impact/AZT701/AZT701-1",
                    "external_id": "AZT701.001"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/marketplace/azure-vm-get-sas-uri"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Compute/disks/beginGetAccess/action"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name     | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource | Get Disk SAS URI\t | Microsoft.Compute/disks/BeginGetAccess/action\t| AzureActivity |\n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AzureActivity | where OperationNameValue == 'MICROSOFT.COMPUTE/DISKS/BEGINGETACCESS/ACTION' and ActivityStatusValue == 'Success'` |\t\n\n## **Azure Monitor Alert**\n(https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FExfiltration%2FAZT701%2FAZT701-1.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\n\t* [`#!powershell New-AzureStorageBlobSASToken`](https://docs.microsoft.com/en-us/powershell/module/azure.storage/new-azurestorageblobsastoken?view=azurermps-6.13.0)\n\t\n\t* [`#!powershell New-AzStorageContainerSASToken`](https://docs.microsoft.com/en-us/powershell/module/az.storage/new-azstoragecontainersastoken?view=azps-8.0.0)\n\t\n=== \"Azure CLI\"\n\t[`#!python az storage blob generate-sas`](https://docs.microsoft.com/en-us/cli/azure/storage/blob?view=azure-cli-latest#az-storage-blob-generate-sas)\n\n=== \"Azure Portal\"\n\n\t![diskexport](diskexport.PNG)"
            ],
            "x_atrm_resources": [
                "Virutal Machine Disk"
            ],
            "x_mitre_brief": "An adversary may create an SAS URI to download the disk attached to a virtual machine.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--4d4a170a-b5c6-47eb-9e5e-f4d844bdd18c",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2023-09-05T15:58:57.000Z",
            "modified": "2023-09-05T15:58:57.000Z",
            "name": "Storage Account File Share SAS",
            "description": "By generating a Shared Access Signature (SAS) URI, an adversary can access a container in a Storage Account at any time.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "impact"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Impact/AZT701/AZT701-2",
                    "external_id": "AZT701.002"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/storage/common/storage-sas-overview"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Storage/storageAccounts/listAccountSas/action"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name      | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource           | N/A\t | N/A\t| StorageBlobLogs |       \n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql StorageBlobLogs | where AuthorizationDetails has 'generateUserDelegationKey'` |\t\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FExfiltration%2FAZT701%2FAZT701-2.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\n\t* [`#!powershell New-AzureStorageBlobSASToken`](https://docs.microsoft.com/en-us/powershell/module/azure.storage/new-azurestorageblobsastoken?view=azurermps-6.13.0)\n\t\n\t* [`#!powershell New-AzStorageContainerSASToken`](https://docs.microsoft.com/en-us/powershell/module/az.storage/new-azstoragecontainersastoken?view=azps-8.0.0)\n\t\n=== \"Azure CLI\"\n\t[`#!python az storage blob generate-sas`](https://docs.microsoft.com/en-us/cli/azure/storage/blob?view=azure-cli-latest#az-storage-blob-generate-sas)\n\t\n=== \"Azure Portal\"\n\t![blobsas](blobsas.PNG)"
            ],
            "x_atrm_resources": [
                "Azure Storage Account"
            ],
            "x_mitre_brief": "By generating a Shared Access Signature (SAS) URI, an adversary can access a container in a Storage Account at any time.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--212ba8ed-7537-49bb-a562-865d29591ed4",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2023-09-05T15:58:57.000Z",
            "modified": "2023-09-05T15:58:57.000Z",
            "name": "SAS URI Generation",
            "description": "By generating an SAS URI for a resource, an adversary may extract the contents of that resource without authentication at any time.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "impact"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Impact/AZT701/AZT701",
                    "external_id": "AZT701"
                }
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_brief": "By generating an SAS URI for a resource, an adversary may extract the contents of that resource without authentication at any time.",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--c9fcb202-2596-419f-b4b0-a6f2d57579e5",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2023-09-05T15:58:57.000Z",
            "modified": "2023-09-05T15:58:57.000Z",
            "name": "Virtual Machine",
            "description": "An adversary may recover a virtual machine object found in a 'soft deletion' state.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "impact"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Impact/AZT704/AZT704-3",
                    "external_id": "AZT704.003"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/powershell/module/az.recoveryservices/undo-azrecoveryservicesbackupitemdeletion?view=azps-8.2.0"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.RecoveryServices/Vaults/backupconfig/write"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name      | Action                                                            | Log Location |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource           | TBD\t | TBD\t| Log Analytics |"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\t[`#!powershell Undo-AzRecoveryServicesBackupItemDeletion`](https://docs.microsoft.com/en-us/powershell/module/az.recoveryservices/undo-azrecoveryservicesbackupitemdeletion?view=azps-8.2.0)\n\n=== \"Azure REST API\"\n\n\t[`#!powershell Invoke-RESTMethod -body $body -Method PUT -Uri 'https://management.azure.com/Subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/testVaultRG/providers/Microsoft.RecoveryServices/vaults/testVault/backupFabrics/Azure/protectionContainers/iaasvmcontainer;iaasvmcontainerv2;testRG;testVM/protectedItems/vm;iaasvmcontainerv2;testRG;testVM?api-version=2019-05-13'`](https://docs.microsoft.com/en-us/powershell/module/az.recoveryservices/undo-azrecoveryservicesbackupitemdeletion?view=azps-8.2.0)\n\t\n\t```#!powershell $Body =\t\t\n\t\t{\n\t\t  \"properties\": {\n\t\t\t\"protectedItemType\": \"Microsoft.Compute/virtualMachines\",\n\t\t\t\"protectionState\": \"ProtectionStopped\",\n\t\t\t\"sourceResourceId\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/testRG/providers/Microsoft.Compute/virtualMachines/testVM\",\n\t\t\t\"isRehydrate\": true\n\t\t  }\n\t\t}\n\t``` \n=== \"Azure Portal\"\n\t![portal](https://docs.microsoft.com/en-us/azure/backup/media/backup-azure-security-feature-cloud/undelete-vm.png)"
            ],
            "x_atrm_resources": [
                "Azure Recovery Services Vault"
            ],
            "x_mitre_brief": "An adversary may recover a virtual machine found in a 'soft deletion' state.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--001b4b10-7f27-479c-a120-f23ca32d2612",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2023-09-05T15:58:57.000Z",
            "modified": "2023-09-05T15:58:57.000Z",
            "name": "Storage Blob",
            "description": "An adversary may recover a storage account object found in a 'soft deletion' state.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "impact"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Impact/AZT704/AZT704-2",
                    "external_id": "AZT704.002"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/storage/blobs/soft-delete-blob-overview"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Storage/storageAccounts/blobServices/*\\/*"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name      | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource           | RestoreContainer\t | Microsoft.Storage/storageAccounts/blobServices/*\\/*\t| StorageBlobLogs |       \n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql StorageBlobLogs | where OperationName == 'RestoreContainer'` |"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Azure REST API\"\n\n\t* [`Invoke-RESTMethod -Uri https://myaccount.blob.core.windows.net/mycontainer/myblob?comp=undelete -Method PUT`](https://docs.microsoft.com/en-us/rest/api/storageservices/undelete-blob)\n\t\n\t* [`Invoke-RESTMethod -Uri https://myaccount.blob.core.windows.net/destinationcontainer?restype=container&comp=undelete -Method PUT`](https://myaccount.blob.core.windows.net/destinationcontainer?restype=container&comp=undelete)\n\n=== \"Azure Portal\"\n\t![portal](704-2-1.PNG)"
            ],
            "x_atrm_resources": [
                "Azure Storage Account"
            ],
            "x_mitre_brief": "An adversary may recover a storage blob found in a 'soft deletion' state.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--e9628e70-223d-43a7-a12d-e294331a3bd4",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2023-09-05T15:58:57.000Z",
            "modified": "2023-09-05T15:58:57.000Z",
            "name": "Soft-Delete Recovery",
            "description": "An adversary may leverage resources found at a 'soft deletion' state, restore them and advance their attack by retrieving contents meant to be deleted",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "impact"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Impact/AZT704/AZT704",
                    "external_id": "AZT704"
                }
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_brief": "An adversary may leverage resources found at a 'soft deletion' state, restore them and advance their attack by retrieving contents meant to be deleted",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--43f52b47-ed72-409a-b776-ff8bf53d5cde",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2023-09-05T15:58:57.000Z",
            "modified": "2023-09-05T15:58:57.000Z",
            "name": "Key Vault",
            "description": "An adversary may recover a key vault object found in a 'soft deletion' state.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "impact"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Impact/AZT704/AZT704-1",
                    "external_id": "AZT704.001"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/key-vault/general/soft-delete-overview"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.KeyVault/vaults/\\*/restore",
                "",
                "Microsoft.KeyVault/locations/deletedVaults/read"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name      | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource           | SecretRecover\t | Microsoft.KeyVault/vaults/\\*/restore| AzureDiagnostics |       \n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AzureDiagnostics | where OperationName == 'SecretRecover' or OperationName == 'KeyRecover' or OperationName == 'CertificateRecover'` |\t\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FExfiltration%2FAZT704%2FAZT704-1.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\t* [`#!powershell Undo-AzKeyVaultRemoval`](https://docs.microsoft.com/en-us/powershell/module/az.keyvault/undo-azkeyvaultremoval?view=azps-8.2.0)\n\t\n\t* [`#!powershell Undo-AzKeyVaultSecretRemoval`](https://docs.microsoft.com/en-us/powershell/module/az.keyvault/undo-azkeyvaultsecretremoval?view=azps-8.2.0)\n\t\n\t* [`#!powershell Undo-AzKeyVaultKeyRemoval`](https://docs.microsoft.com/en-us/powershell/module/az.keyvault/undo-azkeyvaultkeyremoval?view=azps-8.2.0)\n\t\n\t* [`#!powershell Undo-AzKeyVaultCertificateRemoval`](https://docs.microsoft.com/en-us/powershell/module/az.keyvault/undo-azkeyvaultcertificateremoval?view=azps-8.2.0)\n\t\t\t\t\t\n=== \"Azure CLI\"\n\t* [`#!python az keyvault certificate  recover`](https://docs.microsoft.com/en-us/azure/key-vault/general/key-vault-recovery?tabs=azure-cli)\n\t\n\t* [`#!python az keyvault key recover`](https://docs.microsoft.com/en-us/azure/key-vault/general/key-vault-recovery?tabs=azure-cli)\n\t\n\t* [`#!python az keyvault secret recover`](https://docs.microsoft.com/en-us/azure/key-vault/general/key-vault-recovery?tabs=azure-cli)\n\t\n\t* [`#!python az keyvault recover`](https://docs.microsoft.com/en-us/azure/key-vault/general/key-vault-recovery?tabs=azure-cli)\n\t\n=== \"Azure Portal\"\n\t![portal](704-1-1.PNG)"
            ],
            "x_atrm_resources": [
                "Azure Key Vault"
            ],
            "x_mitre_brief": "An adversary may recover a key vault object found in a 'soft deletion' state.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--3a5a3838-b787-413d-9f8c-5cd9f09f2a51",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-02-04T23:05:59.000Z",
            "modified": "2024-02-04T23:05:59.000Z",
            "name": "Replication",
            "description": "An adversary may exfiltrate data by replicating it.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "impact"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Impact/AZT703/AZT703",
                    "external_id": "AZT703"
                }
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_brief": "An adversary may exfiltrate data by replicating it.",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--3df498cb-01bf-4cab-a912-bd1b515ba967",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2023-09-05T15:58:57.000Z",
            "modified": "2023-09-05T15:58:57.000Z",
            "name": "Storage Account Replication",
            "description": "By setting up cross-tenant replication, an adversary may set up replication from one tenant's storage account to an extrenal tenant's storage account.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "impact"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Impact/AZT703/AZT703-1",
                    "external_id": "AZT703.001"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/storage/blobs/object-replication-configure?tabs=portal"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/storage/blobs/object-replication-prevent-cross-tenant-policies?tabs=portal"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Storage/storageAccounts/write"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Detection Details**\n\nA [policy can be created](https://docs.microsoft.com/en-us/azure/storage/blobs/object-replication-prevent-cross-tenant-policies?tabs=portal#create-a-policy-with-an-audit-effect) to alert when replication is set up.\n\n## **Logs** \n\n| Data Source        | Operation Name      | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource           | Put Object Replication Policy\t | Microsoft.Storage/storageAccounts/objectReplicationPolicies/write\t| AzureActivity |       \n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AzureActivity | where OperationNameValue=='Microsoft.Storage/storageAccounts/objectReplicationPolicies/write'` |\t\n\n## **Azure Monitor Alert**\n[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2FAzDetectSuite%2Fmain%2FExfiltration%2FAZT703%2FAZT703-1.json)"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\t[`#!powershell New-AzStorageObjectReplicationPolicyRule`](https://docs.microsoft.com/en-us/powershell/module/az.storage/new-azstorageobjectreplicationpolicyrule?view=azps-8.0.0)\n\t\n=== \"Azure CLI\"\n\t[`#!python az storage account or-policy rule add`](https://docs.azure.cn/zh-cn/cli/ext/storage-or-preview/storage/account/or-policy/rule?view=azure-cli-latest#ext-storage-or-preview-az-storage-account-or-policy-rule-add)\n\t\n=== \"Azure Portal\"\n\t![configure-replication-policy](configure-replication-policy.png)"
            ],
            "x_atrm_resources": [
                "Azure Storage Account"
            ],
            "x_mitre_brief": "By setting up cross-tenant replication, an adversary may set up replication from one tenant's storage account to an extrenal tenant's storage account.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--4571e48e-28cd-4ca2-b034-24ccd5a89588",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-02-04T23:05:59.000Z",
            "modified": "2024-02-04T23:05:59.000Z",
            "name": "File Share Mounting",
            "description": "An adversary may attach an Azure resource as a file share.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "impact"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Impact/AZT702/AZT702",
                    "external_id": "AZT702"
                }
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_brief": "An adversary may attach an Azure resource as a file share",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--2d63fbe3-1a4d-4698-bd86-a7a92f4222d0",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2023-09-05T15:58:57.000Z",
            "modified": "2023-09-05T15:58:57.000Z",
            "name": "Storage Account File Share NFS/SMB Mount",
            "description": "An adversary can generate a connection string to mount an Azure Storage Account File Share as an NFS or SMB share to their local machine.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "impact"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Impact/AZT702/AZT702-1",
                    "external_id": "AZT702.001"
                },
                {
                    "source_name": "microsoft",
                    "url": "https://docs.microsoft.com/en-us/azure/storage/files/files-smb-protocol?tabs=azure-portal"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.Storage/storageAccounts/fileServices/shares/write"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "Connection logs to the share are not generated in Azure."
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Azure Portal\"\n\n\t![smbshare](smbshare.PNG)"
            ],
            "x_atrm_resources": [
                "Azure Storage Account"
            ],
            "x_mitre_brief": "An adversary can generate a connection string to mount an Azure Storage Account File Share as an NFS or SMB share to their local machine.",
            "x_mitre_is_subtechnique": true,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--5c870ef4-848b-4bd0-a556-b714e2c7d524",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2023-09-05T15:58:57.000Z",
            "modified": "2023-09-05T19:05:13.000Z",
            "name": "Azure Backup Delete",
            "description": "An adversary may delete data within the Recovery Service Vault, which houses backup data.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "atrm",
                    "phase_name": "impact"
                }
            ],
            "x_mitre_attack_spec_version": "2.1.0",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/Impact/AZT705/AZT705",
                    "external_id": "AZT705"
                }
            ],
            "x_atrm_actions": [
                "Microsoft.RecoveryServices/Vaults/delete",
                "",
                "Microsoft.RecoveryServices/Vaults/read"
            ],
            "x_mitre_domains": [
                "atrm"
            ],
            "x_atrm_detections": [
                "## **Logs** \n\n| Data Source        | Operation Name      | Action                                                            | Log Provider |\n|--------------------|---------------------|-------------------------------------------------------------------|--------------|\n| Resource           | Delete\t | Microsoft.RecoveryServices/Vaults/delete| AzureActivity |       \n\n## **Queries**\n\n| Platform | Query |\n|----------|-------|\n| Log Analytics | `#!sql AzureActivity | where ResourceProviderValue == \"MICROSOFT.RECOVERYSERVICES\" and OperationNameValue contains \"Delete\" ` |"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "x_atrm_examples": [
                "=== \"Az PowerShell\"\n\t* [`#!powershell Remove-AzRecoveryServicesVault`](https://learn.microsoft.com/en-us/powershell/module/az.recoveryservices/remove-azrecoveryservicesvault?view=azps-10.2.0)\n\n\t\t\t\t\t\n=== \"Azure CLI\"\n\t* [`#!python az backup vault delete`](https://learn.microsoft.com/en-us/cli/azure/backup/vault?view=azure-cli-latest#az-backup-vault-delete)\n\t\n\t\n=== \"Azure Portal\"\n\t![portal](AZT705.png)"
            ],
            "x_atrm_resources": [
                "Recovery Service Vaults"
            ],
            "x_mitre_brief": "An adversary may delete data within the Recovery Service Vault, which houses backup data.",
            "x_mitre_is_subtechnique": false,
            "x_mitre_platforms": [
                "Azure AD"
            ],
            "x_mitre_version": "1.0"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--3705787a-116c-4ed1-8bbb-72e4c0a06779",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.912457Z",
            "modified": "2024-03-25T08:50:27.912457Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--5b459d6b-6aac-442d-9d7d-8cf14fb2de3f",
            "target_ref": "attack-pattern--ac28b3e1-1bd0-491b-a859-6d0100ead69d",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--6aa4cafc-d9da-467a-852f-5f894a88eb46",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.912545Z",
            "modified": "2024-03-25T08:50:27.912545Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--8d9b6e81-305c-4e62-871a-56ff43be6a8e",
            "target_ref": "attack-pattern--ac28b3e1-1bd0-491b-a859-6d0100ead69d",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--99e356f1-72ca-4be0-9d9a-d985d25e4858",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.912609Z",
            "modified": "2024-03-25T08:50:27.912609Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--8964e259-5a76-496f-9187-b7d15c29a074",
            "target_ref": "attack-pattern--ac28b3e1-1bd0-491b-a859-6d0100ead69d",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--0dae5b00-d648-4a7e-ab1b-e1dffc89a1e5",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.912684Z",
            "modified": "2024-03-25T08:50:27.912684Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--b68df883-87a8-4bc8-a553-16bbff53c72a",
            "target_ref": "attack-pattern--ac28b3e1-1bd0-491b-a859-6d0100ead69d",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--33df35df-e2fd-4306-9714-5be660b562e0",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.912745Z",
            "modified": "2024-03-25T08:50:27.912745Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--845c16b9-fc4e-452b-872e-2d1815d392ad",
            "target_ref": "attack-pattern--0b072ae4-5fe4-4f70-8cd9-f1bf6abc8aba",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--04ae7330-75b2-417b-905d-ae8ed01226da",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.912806Z",
            "modified": "2024-03-25T08:50:27.912806Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--574aa812-8ea4-434b-b51a-fb67a4701c6b",
            "target_ref": "attack-pattern--0b072ae4-5fe4-4f70-8cd9-f1bf6abc8aba",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--a87ddbb3-6d1d-43c3-8038-dcec375086f2",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.912867Z",
            "modified": "2024-03-25T08:50:27.912867Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--29e152af-b515-46c0-8ee5-e4c53286cc4e",
            "target_ref": "attack-pattern--c979173f-9f72-4a6d-8eb7-c955a688544e",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--2e24ea6f-911a-4934-ac99-9eb134e5951c",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.912927Z",
            "modified": "2024-03-25T08:50:27.912927Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--65591b92-94da-41a4-9409-3f4b30fb37da",
            "target_ref": "attack-pattern--c979173f-9f72-4a6d-8eb7-c955a688544e",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--5d3b607c-b467-4363-80b8-87cdb4dc11c4",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.912996Z",
            "modified": "2024-03-25T08:50:27.912996Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--4e55dc6c-f0cd-4577-afb3-db973f1cfee4",
            "target_ref": "attack-pattern--c979173f-9f72-4a6d-8eb7-c955a688544e",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--1babad64-07d7-406b-ae70-b3114cb39e28",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.913055Z",
            "modified": "2024-03-25T08:50:27.913055Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--094f30e0-d90c-47ec-949d-097c470183a9",
            "target_ref": "attack-pattern--c979173f-9f72-4a6d-8eb7-c955a688544e",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--b31ff93b-fb3e-48b4-8e56-585e72f460e3",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.913112Z",
            "modified": "2024-03-25T08:50:27.913112Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--3aff39b8-2ccb-488f-8f87-9cb48c4256ca",
            "target_ref": "attack-pattern--c979173f-9f72-4a6d-8eb7-c955a688544e",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--ede2c56f-c09b-4f15-9958-585ffd1b9382",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.913176Z",
            "modified": "2024-03-25T08:50:27.913176Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--e543b6cd-c1c0-40df-99a5-3ab28690d06b",
            "target_ref": "attack-pattern--c979173f-9f72-4a6d-8eb7-c955a688544e",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--a904c1be-d409-4ff9-93bc-ae737dba9e93",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.913235Z",
            "modified": "2024-03-25T08:50:27.913235Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--be59a4c2-c00b-49ee-940e-ea26be61bafa",
            "target_ref": "attack-pattern--c979173f-9f72-4a6d-8eb7-c955a688544e",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--359476a1-9cef-459d-8541-0490c237e0ec",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.913296Z",
            "modified": "2024-03-25T08:50:27.913296Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--8586f122-4c0f-4571-88ac-c7b6cc2593cd",
            "target_ref": "attack-pattern--7bb9d8a8-3e9a-4551-ad1b-f3f7ee275bb0",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--37c0b97f-ce34-408b-9410-5a8253945774",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.913354Z",
            "modified": "2024-03-25T08:50:27.913354Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--eade80d2-e1ce-434f-827a-8324412c4ced",
            "target_ref": "attack-pattern--7bb9d8a8-3e9a-4551-ad1b-f3f7ee275bb0",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--7cf449a9-7e3d-49ce-813b-5721f162ee49",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.913412Z",
            "modified": "2024-03-25T08:50:27.913412Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--5f6ea055-96ca-4d3e-ba7a-eb7952a33b1f",
            "target_ref": "attack-pattern--7bb9d8a8-3e9a-4551-ad1b-f3f7ee275bb0",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--a6e9aa46-520f-4a3c-bd91-fa6f31a28035",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.913476Z",
            "modified": "2024-03-25T08:50:27.913476Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--24b45623-3ddc-496b-bafa-f32127dc83c8",
            "target_ref": "attack-pattern--7bb9d8a8-3e9a-4551-ad1b-f3f7ee275bb0",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--ef17129a-351d-42d4-97d8-cd6d03c5bef6",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.913533Z",
            "modified": "2024-03-25T08:50:27.913533Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--a97fb0c4-2ae4-4f50-b96c-8007f652ffd9",
            "target_ref": "attack-pattern--5c07480f-949b-4459-aba1-a272193b5b26",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--f7f1063f-59d4-4339-ac13-b96a59388fb3",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.913589Z",
            "modified": "2024-03-25T08:50:27.913589Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--2c98c491-2985-4991-b9db-a1c1e7615994",
            "target_ref": "attack-pattern--5c07480f-949b-4459-aba1-a272193b5b26",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--f7e1fb1d-da85-4635-b357-c0159b25d1cd",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.91365Z",
            "modified": "2024-03-25T08:50:27.91365Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--70f889b3-cd41-4177-8bff-d22691d4602e",
            "target_ref": "attack-pattern--5c07480f-949b-4459-aba1-a272193b5b26",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--18474824-7223-4320-94ec-9d864d3b0162",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.913706Z",
            "modified": "2024-03-25T08:50:27.913706Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--d9210297-1194-4292-8416-7ab94dcc9a11",
            "target_ref": "attack-pattern--5c07480f-949b-4459-aba1-a272193b5b26",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--6f22cf11-b3f6-423b-b143-e6376ed249ec",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.913766Z",
            "modified": "2024-03-25T08:50:27.913766Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--6155cdf2-448c-4dc9-a679-2b7118182723",
            "target_ref": "attack-pattern--b22a37d2-1268-4139-b012-ec10fc8ca488",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--98c2d2f4-96e0-4fcc-8aba-804cf0cef55d",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.913824Z",
            "modified": "2024-03-25T08:50:27.913824Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--3830bfda-b828-4504-b0d0-8d3e9f65faf6",
            "target_ref": "attack-pattern--30e8a996-aaa6-46f7-932c-4eda49090356",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--e9a622d9-8e35-43ee-837d-6f796efa7ee1",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.913881Z",
            "modified": "2024-03-25T08:50:27.913881Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--8ad532cc-30be-44cd-823f-7deaf726c503",
            "target_ref": "attack-pattern--30e8a996-aaa6-46f7-932c-4eda49090356",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--ba917694-51d7-4e70-a42b-6bc8381d2ed0",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.913937Z",
            "modified": "2024-03-25T08:50:27.913937Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--16c0a7fc-7252-4bf4-8ea6-7a60ea5cb966",
            "target_ref": "attack-pattern--30e8a996-aaa6-46f7-932c-4eda49090356",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--b43ebdc4-8060-4fde-8cbc-eff948ce289c",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.913996Z",
            "modified": "2024-03-25T08:50:27.913996Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--61edac02-d1fa-44dd-8334-3df64bb65426",
            "target_ref": "attack-pattern--b614e8d7-039e-4e99-a1a0-e3ef5ed0ca97",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--c058b2b0-7946-4d44-8a13-f4d2730b0572",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.914057Z",
            "modified": "2024-03-25T08:50:27.914057Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--2b1549dd-a09f-4a9b-88a4-2eff87268528",
            "target_ref": "attack-pattern--b614e8d7-039e-4e99-a1a0-e3ef5ed0ca97",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--1927b5ec-59fa-470c-b6a5-b902ee7ff983",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.914122Z",
            "modified": "2024-03-25T08:50:27.914122Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--e20e7837-0dd2-45b6-8265-6835e7079ff5",
            "target_ref": "attack-pattern--b614e8d7-039e-4e99-a1a0-e3ef5ed0ca97",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--b6ca5145-ce19-49cf-9af9-ed9d8fa678e0",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.91418Z",
            "modified": "2024-03-25T08:50:27.91418Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--0f01367c-ef9c-438a-b096-448148677c72",
            "target_ref": "attack-pattern--b614e8d7-039e-4e99-a1a0-e3ef5ed0ca97",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--05911268-8eef-4e2c-bdc3-7f2d3331f569",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.914237Z",
            "modified": "2024-03-25T08:50:27.914237Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--5c447245-3556-4c3d-913b-b7cd74e28039",
            "target_ref": "attack-pattern--772716f5-4852-475a-a631-ae42348b007f",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--bd4c6906-fcad-4ce2-b06b-67324948fe4b",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.914294Z",
            "modified": "2024-03-25T08:50:27.914294Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--0befda65-df42-4c80-a383-45c5d68ef9f0",
            "target_ref": "attack-pattern--6c2cf99e-01ee-478b-9aa8-060a8d1f9d52",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--5e51e9d6-cd13-4624-8959-5beeeb2ff62c",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.914351Z",
            "modified": "2024-03-25T08:50:27.914351Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--85398833-61eb-46d4-9c81-69ee89a3d136",
            "target_ref": "attack-pattern--6c2cf99e-01ee-478b-9aa8-060a8d1f9d52",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--01ac9de6-7db1-472a-b65d-1ecef7da0371",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.914407Z",
            "modified": "2024-03-25T08:50:27.914407Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--5137e13e-c99c-49cf-ad00-9eb9e3344b61",
            "target_ref": "attack-pattern--6c2cf99e-01ee-478b-9aa8-060a8d1f9d52",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--7f6b05ce-3274-4f78-93fb-e4196cc903bf",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.914479Z",
            "modified": "2024-03-25T08:50:27.914479Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--6cc30162-d68d-4bfc-81be-15ad3e5bdae9",
            "target_ref": "attack-pattern--b7670d70-f1c4-4963-8c51-ecf8d7a099a4",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--aa4d33d8-56ab-45a0-8093-89e64857c91d",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.914537Z",
            "modified": "2024-03-25T08:50:27.914537Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--e0cc35c1-b058-4544-8ee3-129fc24ade4e",
            "target_ref": "attack-pattern--b7670d70-f1c4-4963-8c51-ecf8d7a099a4",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--f4c2878f-c988-4246-aa5d-d3cfc701cb00",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.914597Z",
            "modified": "2024-03-25T08:50:27.914597Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--cb6ea575-bc20-4261-a36d-614d59735ced",
            "target_ref": "attack-pattern--b7670d70-f1c4-4963-8c51-ecf8d7a099a4",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--a11c1e52-76bd-4214-a92c-da3b2954e608",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.914655Z",
            "modified": "2024-03-25T08:50:27.914655Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--630791a3-d60e-4c4b-84a8-d9397166876f",
            "target_ref": "attack-pattern--b7670d70-f1c4-4963-8c51-ecf8d7a099a4",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--152ccf46-deb4-4b22-8a8a-ee1f7dada4a1",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.914712Z",
            "modified": "2024-03-25T08:50:27.914712Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--1c06e6d6-d8c6-4c57-8d66-a73c6bb62ac2",
            "target_ref": "attack-pattern--2fb9a8b8-3141-4de8-bff3-ee36d65be398",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--afdbd282-c7d1-40f8-bd4c-0027b78424be",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.914772Z",
            "modified": "2024-03-25T08:50:27.914772Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--aadb4d17-c65a-428b-beea-911c74a0593b",
            "target_ref": "attack-pattern--2fb9a8b8-3141-4de8-bff3-ee36d65be398",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--555e471c-9107-40a6-8220-16c5779cec53",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.914828Z",
            "modified": "2024-03-25T08:50:27.914828Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--0ce2adf9-4f8c-4aeb-85aa-db0496b8629c",
            "target_ref": "attack-pattern--2fb9a8b8-3141-4de8-bff3-ee36d65be398",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--dd591950-1d83-4e87-9ffa-046022923f21",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.914885Z",
            "modified": "2024-03-25T08:50:27.914885Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--b0844cbf-878c-4221-a7fc-70c276542fa5",
            "target_ref": "attack-pattern--09109128-664e-4eb5-b891-41935a01d5cf",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--19d8ce5b-1813-44a3-9565-6ee26598e9d0",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.914941Z",
            "modified": "2024-03-25T08:50:27.914941Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--a6c5dd02-1714-4fd1-8c7b-55b68eaab8fb",
            "target_ref": "attack-pattern--ff405e31-278c-42db-964c-b36eac195238",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--0e407f9f-a496-489a-8ae0-51f4e813894f",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.915005Z",
            "modified": "2024-03-25T08:50:27.915005Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--f99d7c5e-015e-4aec-809f-c62a392137d1",
            "target_ref": "attack-pattern--ff405e31-278c-42db-964c-b36eac195238",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--fe134f38-5772-4982-8ca0-3fa819589a7f",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.915069Z",
            "modified": "2024-03-25T08:50:27.915069Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--97dc0499-c809-46e0-8bdf-6e2991e9ee02",
            "target_ref": "attack-pattern--ff405e31-278c-42db-964c-b36eac195238",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--59e501a0-012e-4029-a77a-5c08502b03da",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.915126Z",
            "modified": "2024-03-25T08:50:27.915126Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--88a747d9-fa91-48ca-b7b5-829b13ed0884",
            "target_ref": "attack-pattern--dba23df3-b5ac-4bb1-b786-8a96d7ff5d61",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--6231f2f6-6262-46df-893b-7b6393711d6d",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.915186Z",
            "modified": "2024-03-25T08:50:27.915186Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--f2dff7cf-8146-4eb2-8875-d7a293b66b5b",
            "target_ref": "attack-pattern--dba23df3-b5ac-4bb1-b786-8a96d7ff5d61",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--34050712-ec46-4218-9e63-c2a2cec3cdd8",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.915243Z",
            "modified": "2024-03-25T08:50:27.915243Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--0d9f6aba-487c-4e0c-a483-97086bdec821",
            "target_ref": "attack-pattern--dba23df3-b5ac-4bb1-b786-8a96d7ff5d61",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--faee8d68-a556-4d0c-986d-fb112d1bedba",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.9153Z",
            "modified": "2024-03-25T08:50:27.9153Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--89a91ded-a372-4630-b5a8-3e14d91f8408",
            "target_ref": "attack-pattern--b5f240be-4747-498b-ad69-0be4d1d36f94",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--b77e88a1-644a-4add-9c03-1ac64eef7178",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.915356Z",
            "modified": "2024-03-25T08:50:27.915356Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--07a590ec-1c21-4b8c-87c7-79cf67c69612",
            "target_ref": "attack-pattern--2f0fb949-f307-45be-8989-a60da6f5ca06",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--f44c90a2-a87c-4da6-8b4a-0e57025d2ff7",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.915412Z",
            "modified": "2024-03-25T08:50:27.915412Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--bae42eab-b9f0-4f0e-8227-d4f619e8d679",
            "target_ref": "attack-pattern--2f0fb949-f307-45be-8989-a60da6f5ca06",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--3156e2fa-cb53-4bd6-80af-37858731a439",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.915479Z",
            "modified": "2024-03-25T08:50:27.915479Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--fb488db2-63ff-42d9-9495-5ae27fc5a6cd",
            "target_ref": "attack-pattern--2f0fb949-f307-45be-8989-a60da6f5ca06",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--04963686-e46e-4722-8d8a-3f9a3215009d",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.915536Z",
            "modified": "2024-03-25T08:50:27.915536Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--b4d2be4f-32c7-45a1-aa47-4292b4891355",
            "target_ref": "attack-pattern--2f0fb949-f307-45be-8989-a60da6f5ca06",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--21c23524-1b66-4875-b145-2e7e8c8d4029",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.915592Z",
            "modified": "2024-03-25T08:50:27.915592Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--32407871-8a18-4832-9239-922bcbfc2956",
            "target_ref": "attack-pattern--2f0fb949-f307-45be-8989-a60da6f5ca06",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--679acef4-bab3-4e1d-99e7-c4edac3f112b",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.915649Z",
            "modified": "2024-03-25T08:50:27.915649Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--89575dad-41e5-4c78-9fa1-0ef36d93177e",
            "target_ref": "attack-pattern--212ba8ed-7537-49bb-a562-865d29591ed4",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--1a405f19-04ac-4375-b777-8406935c2df3",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.91642Z",
            "modified": "2024-03-25T08:50:27.91642Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--4d4a170a-b5c6-47eb-9e5e-f4d844bdd18c",
            "target_ref": "attack-pattern--212ba8ed-7537-49bb-a562-865d29591ed4",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--0cdc6723-aa5e-4d1e-b3dc-34769606e832",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.916494Z",
            "modified": "2024-03-25T08:50:27.916494Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--c9fcb202-2596-419f-b4b0-a6f2d57579e5",
            "target_ref": "attack-pattern--e9628e70-223d-43a7-a12d-e294331a3bd4",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--7d17cd6d-80f6-40f4-9cb4-db262fef79e9",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.916558Z",
            "modified": "2024-03-25T08:50:27.916558Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--001b4b10-7f27-479c-a120-f23ca32d2612",
            "target_ref": "attack-pattern--e9628e70-223d-43a7-a12d-e294331a3bd4",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--db94f040-fcd7-4741-939e-c4d4f45bbe49",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.916619Z",
            "modified": "2024-03-25T08:50:27.916619Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--43f52b47-ed72-409a-b776-ff8bf53d5cde",
            "target_ref": "attack-pattern--e9628e70-223d-43a7-a12d-e294331a3bd4",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--2e309c48-1daf-4401-bbc5-6233c669248d",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.916678Z",
            "modified": "2024-03-25T08:50:27.916678Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--3df498cb-01bf-4cab-a912-bd1b515ba967",
            "target_ref": "attack-pattern--3a5a3838-b787-413d-9f8c-5cd9f09f2a51",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--d1d1c6db-faba-408d-a173-3ac4592672c0",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T08:50:27.916736Z",
            "modified": "2024-03-25T08:50:27.916736Z",
            "relationship_type": "subtechnique-of",
            "source_ref": "attack-pattern--2d63fbe3-1a4d-4698-bd86-a7a92f4222d0",
            "target_ref": "attack-pattern--4571e48e-28cd-4ca2-b034-24ccd5a89588",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "x-mitre-matrix",
            "spec_version": "2.1",
            "id": "x-mitre-matrix--b7a201c7-e967-4adc-b4ac-ea1fc58f8c54",
            "created_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-03-25T11:50:27.916Z",
            "modified": "2024-03-25T11:50:27.916Z",
            "name": "Azure Threat Research Matrix",
            "external_references": [
                {
                    "source_name": "atrm",
                    "url": "https://microsoft.github.io/Azure-Threat-Research-Matrix/",
                    "external_id": "atrm"
                }
            ],
            "description": "The purpose of the Azure Threat Research Matrix (ATRM) is to educate readers on the potential of Azure-based tactics, techniques, and procedures (TTPs). It is not to teach how to weaponize or specifically abuse them. For this reason, some specific commands will be obfuscated or parts will be omitted to prevent abuse.",
            "x_mitre_attack_spec_version": "2.1.0",
            "tactic_refs": [
                "x-mitre-tactic--72987607-3031-4e46-8352-255208c061c7",
                "x-mitre-tactic--5664197e-8e77-4145-b848-9dd68227eca1",
                "x-mitre-tactic--2b04afaa-b289-49aa-9a83-44978deb984c",
                "x-mitre-tactic--f2cee537-023e-433c-83b3-54128e17dc0e",
                "x-mitre-tactic--6caedcbe-eb96-4ba7-ba7e-3007688f12d1",
                "x-mitre-tactic--17719260-6270-4060-8d07-369d622a73d4",
                "x-mitre-tactic--170069f3-584a-4e42-b70b-70e18bcfab2f"
            ],
            "x_mitre_version": "0.1",
            "x_mitre_domains": [
                "atrm"
            ],
            "x_mitre_modified_by_ref": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e"
        },
        {
            "type": "identity",
            "spec_version": "2.1",
            "id": "identity--5dcf0a7a-875b-470b-8a01-7c6a84c5e68e",
            "created": "2024-02-05T14:00:00.188Z",
            "modified": "2024-02-05T14:00:00.188Z",
            "name": "aw350m33d (Security Experts Community)",
            "identity_class": "organization",
            "x_mitre_attack_spec_version": "2.1.0",
            "x_mitre_domains": [
                "enterprise-attack"
            ],
            "x_mitre_version": "0.1"
        }
    ]
}